##############################################################################################################################
#################################################### L'import planifier ######################################################
##### Version 1.12.11 ############################################################################################ Jdevs #####

26/05/2020 10:52:38 : -----> Fichier 0/13 : EDI_ORDERS.56012305.771422.BATIMEX.3025940001500.20200526.202005261018.RECU.IN.csv
26/05/2020 10:52:38 : Scan fichier...
26/05/2020 10:52:38 : Import Commande Manuel.
26/05/2020 10:52:42 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 10:52:45 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56012305'
26/05/2020 10:53:44 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
26/05/2020 10:53:50 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
26/05/2020 10:53:54 | existeFourniseur() : id '3779000001461'
26/05/2020 10:53:57 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 10:53:57 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 10:53:58 | get_adresse_livraison() : Called1
26/05/2020 10:54:01 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMSTJEAN'
26/05/2020 10:54:01 | getDevise() : Code ISO 'EUR'
26/05/2020 10:54:05 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 10:54:05 | getDevise() : Devise trouvé!
26/05/2020 10:54:06 : ORDHD1 trouvé.

26/05/2020 10:54:06 : ORDLIN trouvé.
26/05/2020 10:54:06 : ORDLIN line 1 / 5.
26/05/2020 10:54:06 : ORDLIN line 1 / 5.
26/05/2020 10:54:06 : ORDLIN line 1 / 5.
26/05/2020 10:54:06 | getArticle() : Code Article : 3760093543187
26/05/2020 10:54:06 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:54:06 | getArticle() : Article trouvé!
26/05/2020 10:54:06 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
26/05/2020 10:54:08 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
26/05/2020 10:54:08 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:54:09 : tab ===> line.article.Conditionnement
26/05/2020 10:54:09 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
26/05/2020 10:54:09 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
26/05/2020 10:54:09 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

26/05/2020 10:54:09 : ********************** Prix *********************
26/05/2020 10:54:09 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

26/05/2020 10:54:09 : ********************** Warning Prix *********************
26/05/2020 10:54:09 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
26/05/2020 10:54:09 : Utilise le prix de la base : 19,500000.

26/05/2020 10:54:09 : ORDLIN line 1 / 5.
26/05/2020 10:54:09 | getArticle() : Code Article : 3760093542906
26/05/2020 10:54:09 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:54:09 | getArticle() : Article trouvé!
26/05/2020 10:54:09 | getConditionnementArticle() : Code Article : BLACKBURN
26/05/2020 10:54:12 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
26/05/2020 10:54:12 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:54:13 : tab ===> line.article.Conditionnement
26/05/2020 10:54:13 | Calcule_conditionnement() : Qte '16,00', Qte conditionnement '4'
26/05/2020 10:54:13 | Calcule_conditionnement() : calcule... Valeur = 4, Reste = 0
26/05/2020 10:54:13 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 4

26/05/2020 10:54:13 : ********************** Prix *********************
26/05/2020 10:54:13 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

26/05/2020 10:54:13 : ********************** Warning Prix *********************
26/05/2020 10:54:13 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
26/05/2020 10:54:13 : Utilise le prix de la base : 21,900000.

26/05/2020 10:54:13 : ORDLIN line 1 / 5.
26/05/2020 10:54:13 | getStockId() : Called!
26/05/2020 10:54:16 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 10:54:16 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 10:54:16 | getNumLivraison() : Client Numéro => 01LMSTJEAN
26/05/2020 10:54:19 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMSTJEAN' and li_principal=1
26/05/2020 10:54:19 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 10:54:20 | insertOrder() : Récupére tous les tva
26/05/2020 10:54:20 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 10:54:20 | insertCommande() : Called!
26/05/2020 10:54:23 : insertCommande() | called!
26/05/2020 10:54:23 : insertCommande() | Requette pour Batimex.
26/05/2020 10:54:23 : insertCommande() | ODBC.
26/05/2020 10:54:23 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMSTJEAN',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202667','/56012305',21,2,1,'01LMSTJEAN',11,0,1,1,0,87,1,'3025940001500;3779000001461','56012305',20,0,0)
26/05/2020 10:54:23 : insertCommande() | called!
26/05/2020 10:54:23 : insertCommande() | Requette pour Batimex.
26/05/2020 10:54:23 : insertCommande() | ODBC.
26/05/2020 10:54:24 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
26/05/2020 10:54:24 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:54:24 | insertOrder() : List des TVA trouvé
26/05/2020 10:54:24 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:54:24 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:54:24 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:54:24 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:54:24 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:54:24 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:54:24 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:54:24 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
26/05/2020 10:54:24 | insertOrder() : Prix TTC créé


26/05/2020 10:54:24 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
26/05/2020 10:54:24 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
26/05/2020 10:54:24 | insertCommandeLine() : Called!
26/05/2020 10:54:24 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMSTJEAN',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202667',1,0,0,'', NULL,'56012305',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202667', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
26/05/2020 10:54:24 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:54:24 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:54:24 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

26/05/2020 10:54:24 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:54:24 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
26/05/2020 10:54:24 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
26/05/2020 10:54:24 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:54:24 | insertOrder() : List des TVA trouvé
26/05/2020 10:54:24 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:54:24 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:54:24 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:54:24 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:54:24 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:54:24 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:54:24 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:54:24 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
26/05/2020 10:54:24 | insertOrder() : Prix TTC créé


26/05/2020 10:54:24 | insertOrder() : DL_MontantHT : 350.4 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 16.00
26/05/2020 10:54:24 | insertOrder() : DL_MontantTTC : 421.07568 = DL_PUTTC : 26.31723 X DL_QteBC : 16.00
26/05/2020 10:54:24 | insertCommandeLine() : Called!
26/05/2020 10:54:24 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMSTJEAN',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,16.00,'Carton de 4',4,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202667',1,0,0,'', NULL,'56012305',28800000.00,28800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202667', '', 0.000000, 16.00, 16.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 350.4, 421.07568)
26/05/2020 10:54:24 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:54:24 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:54:24 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

26/05/2020 10:54:24 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:54:24 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
26/05/2020 10:54:24 | insertOrder() : Aucune reponse.

26/05/2020 10:54:24 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56012305
26/05/2020 10:54:24 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 41.4 WHERE DO_PIECE = 'BC202667' 


26/05/2020 10:54:25 : 2/2 ligne(s) enregistrée(s).


26/05/2020 10:54:25 : Le fichier 'E:\EDI\EDI_ORDERS.56012305.771422.BATIMEX.3025940001500.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020105425__56012305__EDI_ORDERS.56012305.771422.BATIMEX.3025940001500.20200526.202005261018.RECU.IN.csv



26/05/2020 10:54:25 : -----> Fichier 1/13 : EDI_ORDERS.56017704.771402.BATIMEX.3025940008000.20200526.202005261016.RECU.IN.csv
26/05/2020 10:54:25 : Scan fichier...
26/05/2020 10:54:25 : Import Commande Manuel.
26/05/2020 10:54:28 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 10:54:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56017704'
26/05/2020 10:55:31 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008000' and CT_Type=0
26/05/2020 10:55:37 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008000' and CT_Type=0
26/05/2020 10:55:40 | existeFourniseur() : id '3779000001461'
26/05/2020 10:55:44 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 10:55:44 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 10:55:44 | get_adresse_livraison() : Called1
26/05/2020 10:55:47 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMNIMES'
26/05/2020 10:55:48 | getDevise() : Code ISO 'EUR'
26/05/2020 10:55:51 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 10:55:51 | getDevise() : Devise trouvé!
26/05/2020 10:55:51 : ORDHD1 trouvé.

26/05/2020 10:55:51 : ORDLIN trouvé.
26/05/2020 10:55:51 : ORDLIN line 1 / 5.
26/05/2020 10:55:51 : ORDLIN line 1 / 5.
26/05/2020 10:55:51 : ORDLIN line 1 / 5.
26/05/2020 10:55:51 | getArticle() : Code Article : 3760119730683
26/05/2020 10:55:51 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730683' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:55:51 | getArticle() : Article trouvé!
26/05/2020 10:55:51 | getConditionnementArticle() : Code Article : SOPLAYMINI
26/05/2020 10:55:54 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='SOPLAYMINI'
26/05/2020 10:55:54 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:55:55 : tab ===> line.article.Conditionnement
26/05/2020 10:55:55 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '6'
26/05/2020 10:55:55 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 2
26/05/2020 10:55:55 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 1

26/05/2020 10:55:55 : ********************** Prix *********************
26/05/2020 10:55:55 : Prix trouvé dans le fichier EDI => 22,82 && Prix trouvé dans Sage => 22,650000

26/05/2020 10:55:55 : ********************** Warning Prix *********************
26/05/2020 10:55:55 : Prix de l'article SOPLAYMINI(3760119730683) dans la base est : 22,650000
Il est différent du prix envoyer par le client : 22,82.
26/05/2020 10:55:55 : Utilise le prix de la base : 22,650000.

26/05/2020 10:55:55 : ORDLIN line 1 / 5.
26/05/2020 10:55:55 | getArticle() : Code Article : 3760119730690
26/05/2020 10:55:55 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:55:55 | getArticle() : Article trouvé!
26/05/2020 10:55:55 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 10:55:58 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 10:55:58 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:55:58 : tab ===> line.article.Conditionnement
26/05/2020 10:55:58 | Calcule_conditionnement() : Qte '28,00', Qte conditionnement '4'
26/05/2020 10:55:58 | Calcule_conditionnement() : calcule... Valeur = 7, Reste = 0
26/05/2020 10:55:58 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 7

26/05/2020 10:55:58 : ********************** Prix *********************
26/05/2020 10:55:58 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 10:55:58 : ********************** Warning Prix *********************
26/05/2020 10:55:58 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 10:55:58 : Utilise le prix de la base : 36,900000.

26/05/2020 10:55:58 : ORDLIN line 1 / 5.
26/05/2020 10:55:58 | getStockId() : Called!
26/05/2020 10:56:01 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 10:56:02 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 10:56:02 | getNumLivraison() : Client Numéro => 01LMNIMES
26/05/2020 10:56:05 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMNIMES' and li_principal=1
26/05/2020 10:56:05 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 10:56:05 | insertOrder() : Récupére tous les tva
26/05/2020 10:56:05 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 10:56:05 | insertCommande() : Called!
26/05/2020 10:56:09 : insertCommande() | called!
26/05/2020 10:56:09 : insertCommande() | Requette pour Batimex.
26/05/2020 10:56:09 : insertCommande() | ODBC.
26/05/2020 10:56:09 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMNIMES',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202668','/56017704',21,2,1,'01LMNIMES',11,0,1,1,0,608,1,'3025940008000;3779000001461','56017704',20,0,0)
26/05/2020 10:56:09 : insertCommande() | called!
26/05/2020 10:56:09 : insertCommande() | Requette pour Batimex.
26/05/2020 10:56:09 : insertCommande() | ODBC.
26/05/2020 10:56:09 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article SOPLAYMINI
26/05/2020 10:56:09 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='SOPLAYMINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:56:09 | insertOrder() : List des TVA trouvé
26/05/2020 10:56:09 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:56:09 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:56:09 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:56:09 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:56:09 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:56:09 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:56:09 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:56:09 | insertOrder() : Prix HT => 22,65 | TVA => 20,17 % | Prix TTC => 27,218505
26/05/2020 10:56:09 | insertOrder() : Prix TTC créé


26/05/2020 10:56:09 | insertOrder() : DL_MontantHT : 181.2 = DL_PrixUnitaire : 22.650000 X DL_QteBC : 8.00
26/05/2020 10:56:09 | insertOrder() : DL_MontantTTC : 217.74804 = DL_PUTTC : 27.218505 X DL_QteBC : 8.00
26/05/2020 10:56:09 | insertCommandeLine() : Called!
26/05/2020 10:56:09 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','SOPLAYMINI','01LMNIMES',7, 'BALADEUSE MUSICALE MINI SO PLAY LUM',1,22.650000,8.00,'Carton de 6',2,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202668',1,0,0,'', NULL,'56017704',6400000.00,6400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,27.218505, 'BC202668', '', 0.000000, 8.00, 8.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 181.2, 217.74804)
26/05/2020 10:56:10 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:56:10 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:56:10 | insertOrder() : Additionner le total HT (22.650000) et TTC (27.218505)

26/05/2020 10:56:10 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:56:10 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'SOPLAYMINI' and DE_No = 1
26/05/2020 10:56:10 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article VINTY_LIGHT
26/05/2020 10:56:10 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:56:10 | insertOrder() : List des TVA trouvé
26/05/2020 10:56:10 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:56:10 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:56:10 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:56:10 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:56:10 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:56:10 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:56:10 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:56:10 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
26/05/2020 10:56:10 | insertOrder() : Prix TTC créé


26/05/2020 10:56:10 | insertOrder() : DL_MontantHT : 1033.2 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 28.00
26/05/2020 10:56:10 | insertOrder() : DL_MontantTTC : 1241.59644 = DL_PUTTC : 44.34273 X DL_QteBC : 28.00
26/05/2020 10:56:10 | insertCommandeLine() : Called!
26/05/2020 10:56:10 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMNIMES',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',2,36.900000,28.00,'Carton de 4',7,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202668',1,0,0,'', NULL,'56017704',89600000.00,89600000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202668', '', 0.000000, 28.00, 28.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 1033.2, 1241.59644)
26/05/2020 10:56:10 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:56:10 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:56:10 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

26/05/2020 10:56:10 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:56:10 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
26/05/2020 10:56:10 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (516,000000), AS_StockMontant (0,000000).

26/05/2020 10:56:10 | insertOrder() : new_AS_StockReel: 0
26/05/2020 10:56:10 | insertOrder() : new_AS_StockReserve: 544 = AS_StockReserve: 516 + Quantite: 28
26/05/2020 10:56:10 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
26/05/2020 10:56:10 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 10:56:10 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 10:56:10 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 544, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

26/05/2020 10:56:10 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56017704
26/05/2020 10:56:10 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 59.55 WHERE DO_PIECE = 'BC202668' 


26/05/2020 10:56:11 : 2/2 ligne(s) enregistrée(s).


26/05/2020 10:56:11 : Le fichier 'E:\EDI\EDI_ORDERS.56017704.771402.BATIMEX.3025940008000.20200526.202005261016.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020105611__56017704__EDI_ORDERS.56017704.771402.BATIMEX.3025940008000.20200526.202005261016.RECU.IN.csv



26/05/2020 10:56:11 : -----> Fichier 2/13 : EDI_ORDERS.56017818.771384.BATIMEX.3025940008100.20200526.202005261014.RECU.IN.csv
26/05/2020 10:56:11 : Scan fichier...
26/05/2020 10:56:11 : Import Commande Manuel.
26/05/2020 10:56:14 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 10:56:18 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56017818'
26/05/2020 10:57:15 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008100' and CT_Type=0
26/05/2020 10:57:22 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008100' and CT_Type=0
26/05/2020 10:57:25 | existeFourniseur() : id '3779000001461'
26/05/2020 10:57:28 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 10:57:28 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 10:57:29 | get_adresse_livraison() : Called1
26/05/2020 10:57:32 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMNIORT'
26/05/2020 10:57:32 | getDevise() : Code ISO 'EUR'
26/05/2020 10:57:36 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 10:57:36 | getDevise() : Devise trouvé!
26/05/2020 10:57:36 : ORDHD1 trouvé.

26/05/2020 10:57:36 : ORDLIN trouvé.
26/05/2020 10:57:36 : ORDLIN line 1 / 5.
26/05/2020 10:57:36 : ORDLIN line 1 / 5.
26/05/2020 10:57:36 : ORDLIN line 1 / 5.
26/05/2020 10:57:36 | getArticle() : Code Article : 3760093543187
26/05/2020 10:57:36 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:57:36 | getArticle() : Article trouvé!
26/05/2020 10:57:36 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
26/05/2020 10:57:39 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
26/05/2020 10:57:39 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:57:40 : tab ===> line.article.Conditionnement
26/05/2020 10:57:40 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
26/05/2020 10:57:40 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
26/05/2020 10:57:40 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

26/05/2020 10:57:40 : ********************** Prix *********************
26/05/2020 10:57:40 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

26/05/2020 10:57:40 : ********************** Warning Prix *********************
26/05/2020 10:57:40 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
26/05/2020 10:57:40 : Utilise le prix de la base : 19,500000.

26/05/2020 10:57:40 : ORDLIN line 1 / 5.
26/05/2020 10:57:40 | getArticle() : Code Article : 3760093543040
26/05/2020 10:57:40 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543040' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:57:40 | getArticle() : Article trouvé!
26/05/2020 10:57:40 | getConditionnementArticle() : Code Article : COOPER_WHITE
26/05/2020 10:57:43 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER_WHITE'
26/05/2020 10:57:43 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:57:43 : tab ===> line.article.Conditionnement
26/05/2020 10:57:43 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 10:57:43 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 10:57:43 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 10:57:43 : ********************** Prix *********************
26/05/2020 10:57:43 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

26/05/2020 10:57:43 : ********************** Warning Prix *********************
26/05/2020 10:57:43 : Prix de l'article COOPER_WHITE(3760093543040) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
26/05/2020 10:57:43 : Utilise le prix de la base : 15,900000.

26/05/2020 10:57:43 : ORDLIN line 1 / 5.
26/05/2020 10:57:43 | getStockId() : Called!
26/05/2020 10:57:46 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 10:57:46 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 10:57:47 | getNumLivraison() : Client Numéro => 01LMNIORT
26/05/2020 10:57:50 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMNIORT' and li_principal=1
26/05/2020 10:57:50 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 10:57:50 | insertOrder() : Récupére tous les tva
26/05/2020 10:57:50 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 10:57:50 | insertCommande() : Called!
26/05/2020 10:57:53 : insertCommande() | called!
26/05/2020 10:57:53 : insertCommande() | Requette pour Batimex.
26/05/2020 10:57:53 : insertCommande() | ODBC.
26/05/2020 10:57:53 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMNIORT',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202669','/56017818',21,2,1,'01LMNIORT',11,0,1,1,0,3171,1,'3025940008100;3779000001461','56017818',20,0,0)
26/05/2020 10:57:53 : insertCommande() | called!
26/05/2020 10:57:53 : insertCommande() | Requette pour Batimex.
26/05/2020 10:57:53 : insertCommande() | ODBC.
26/05/2020 10:57:55 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
26/05/2020 10:57:55 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:57:55 | insertOrder() : List des TVA trouvé
26/05/2020 10:57:55 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:57:55 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:57:55 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:57:55 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:57:55 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:57:55 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:57:55 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:57:55 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
26/05/2020 10:57:55 | insertOrder() : Prix TTC créé


26/05/2020 10:57:55 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
26/05/2020 10:57:55 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
26/05/2020 10:57:55 | insertCommandeLine() : Called!
26/05/2020 10:57:55 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMNIORT',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202669',1,0,0,'', NULL,'56017818',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202669', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
26/05/2020 10:57:55 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:57:55 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:57:55 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

26/05/2020 10:57:55 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:57:55 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
26/05/2020 10:57:55 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article COOPER_WHITE
26/05/2020 10:57:55 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER_WHITE' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:57:55 | insertOrder() : List des TVA trouvé
26/05/2020 10:57:55 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:57:55 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:57:55 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:57:55 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:57:55 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:57:55 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:57:55 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:57:55 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
26/05/2020 10:57:55 | insertOrder() : Prix TTC créé


26/05/2020 10:57:55 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
26/05/2020 10:57:55 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
26/05/2020 10:57:55 | insertCommandeLine() : Called!
26/05/2020 10:57:55 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER_WHITE','01LMNIORT',7, 'PROJ DET SOLAIRE 1000LM BLC PLS BAT',2,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202669',1,0,0,'', NULL,'56017818',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202669', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
26/05/2020 10:57:56 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:57:56 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:57:56 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

26/05/2020 10:57:56 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:57:56 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER_WHITE' and DE_No = 1
26/05/2020 10:57:56 | insertOrder() : Aucune reponse.

26/05/2020 10:57:56 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56017818
26/05/2020 10:57:56 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 35.4 WHERE DO_PIECE = 'BC202669' 


26/05/2020 10:57:56 : 2/2 ligne(s) enregistrée(s).


26/05/2020 10:57:56 : Le fichier 'E:\EDI\EDI_ORDERS.56017818.771384.BATIMEX.3025940008100.20200526.202005261014.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020105756__56017818__EDI_ORDERS.56017818.771384.BATIMEX.3025940008100.20200526.202005261014.RECU.IN.csv



26/05/2020 10:57:56 : -----> Fichier 3/13 : EDI_ORDERS.56018787.771366.BATIMEX.3025940011600.20200526.202005261013.RECU.IN.csv
26/05/2020 10:57:56 : Scan fichier...
26/05/2020 10:57:56 : Import Commande Manuel.
26/05/2020 10:57:59 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 10:58:03 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56018787'
26/05/2020 10:58:58 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011600' and CT_Type=0
26/05/2020 10:59:03 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011600' and CT_Type=0
26/05/2020 10:59:06 | existeFourniseur() : id '3779000001461'
26/05/2020 10:59:09 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 10:59:10 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 10:59:10 | get_adresse_livraison() : Called1
26/05/2020 10:59:13 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMCOLLEGIEN'
26/05/2020 10:59:14 | getDevise() : Code ISO 'EUR'
26/05/2020 10:59:17 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 10:59:17 | getDevise() : Devise trouvé!
26/05/2020 10:59:18 : ORDHD1 trouvé.

26/05/2020 10:59:18 : ORDLIN trouvé.
26/05/2020 10:59:18 : ORDLIN line 1 / 5.
26/05/2020 10:59:18 : ORDLIN line 1 / 5.
26/05/2020 10:59:18 : ORDLIN line 1 / 5.
26/05/2020 10:59:18 | getArticle() : Code Article : 3760093542883
26/05/2020 10:59:18 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:59:18 | getArticle() : Article trouvé!
26/05/2020 10:59:18 | getConditionnementArticle() : Code Article : COOPER
26/05/2020 10:59:21 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
26/05/2020 10:59:21 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:59:22 : tab ===> line.article.Conditionnement
26/05/2020 10:59:22 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 10:59:22 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 10:59:22 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 10:59:22 : ********************** Prix *********************
26/05/2020 10:59:22 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

26/05/2020 10:59:22 : ********************** Warning Prix *********************
26/05/2020 10:59:22 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
26/05/2020 10:59:22 : Utilise le prix de la base : 15,900000.

26/05/2020 10:59:22 : ORDLIN line 1 / 5.
26/05/2020 10:59:22 | getArticle() : Code Article : 3760093542906
26/05/2020 10:59:22 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 10:59:22 | getArticle() : Article trouvé!
26/05/2020 10:59:22 | getConditionnementArticle() : Code Article : BLACKBURN
26/05/2020 10:59:25 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
26/05/2020 10:59:25 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 10:59:25 : tab ===> line.article.Conditionnement
26/05/2020 10:59:25 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
26/05/2020 10:59:25 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
26/05/2020 10:59:25 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

26/05/2020 10:59:25 : ********************** Prix *********************
26/05/2020 10:59:25 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

26/05/2020 10:59:25 : ********************** Warning Prix *********************
26/05/2020 10:59:25 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
26/05/2020 10:59:25 : Utilise le prix de la base : 21,900000.

26/05/2020 10:59:25 : ORDLIN line 1 / 5.
26/05/2020 10:59:25 | getStockId() : Called!
26/05/2020 10:59:29 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 10:59:29 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 10:59:29 | getNumLivraison() : Client Numéro => 01LMCOLLEGIEN
26/05/2020 10:59:32 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMCOLLEGIEN' and li_principal=1
26/05/2020 10:59:32 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 10:59:33 | insertOrder() : Récupére tous les tva
26/05/2020 10:59:33 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 10:59:33 | insertCommande() : Called!
26/05/2020 10:59:37 : insertCommande() | called!
26/05/2020 10:59:37 : insertCommande() | Requette pour Batimex.
26/05/2020 10:59:37 : insertCommande() | ODBC.
26/05/2020 10:59:37 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMCOLLEGIEN',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202670','/56018787',21,2,1,'01LMCOLLEGIEN',11,0,1,1,0,602,1,'3025940011600;3779000001461','56018787',20,0,0)
26/05/2020 10:59:37 : insertCommande() | called!
26/05/2020 10:59:37 : insertCommande() | Requette pour Batimex.
26/05/2020 10:59:37 : insertCommande() | ODBC.
26/05/2020 10:59:38 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article COOPER
26/05/2020 10:59:38 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:59:38 | insertOrder() : List des TVA trouvé
26/05/2020 10:59:38 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:59:38 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:59:38 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:59:38 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:59:38 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:59:38 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:59:38 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:59:38 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
26/05/2020 10:59:38 | insertOrder() : Prix TTC créé


26/05/2020 10:59:38 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
26/05/2020 10:59:38 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
26/05/2020 10:59:38 | insertCommandeLine() : Called!
26/05/2020 10:59:38 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMCOLLEGIEN',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',1,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202670',1,0,0,'', NULL,'56018787',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202670', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
26/05/2020 10:59:39 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:59:39 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:59:39 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

26/05/2020 10:59:39 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:59:39 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
26/05/2020 10:59:39 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
26/05/2020 10:59:39 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 10:59:39 | insertOrder() : List des TVA trouvé
26/05/2020 10:59:39 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 10:59:39 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 10:59:39 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 10:59:39 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 10:59:39 | insertOrder() : TVA 1 => 20.000000
26/05/2020 10:59:39 | insertOrder() : TVA 2 => 0.170000
26/05/2020 10:59:39 | insertOrder() : TVA 3 => 0.000000
26/05/2020 10:59:39 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
26/05/2020 10:59:39 | insertOrder() : Prix TTC créé


26/05/2020 10:59:39 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
26/05/2020 10:59:39 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
26/05/2020 10:59:39 | insertCommandeLine() : Called!
26/05/2020 10:59:39 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMCOLLEGIEN',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202670',1,0,0,'', NULL,'56018787',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202670', '', 0.000000, 8.00, 8.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
26/05/2020 10:59:39 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 10:59:39 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 10:59:39 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

26/05/2020 10:59:39 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 10:59:39 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
26/05/2020 10:59:39 | insertOrder() : Aucune reponse.

26/05/2020 10:59:39 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56018787
26/05/2020 10:59:39 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 37.8 WHERE DO_PIECE = 'BC202670' 


26/05/2020 10:59:39 : 2/2 ligne(s) enregistrée(s).


26/05/2020 10:59:39 : Le fichier 'E:\EDI\EDI_ORDERS.56018787.771366.BATIMEX.3025940011600.20200526.202005261013.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020105939__56018787__EDI_ORDERS.56018787.771366.BATIMEX.3025940011600.20200526.202005261013.RECU.IN.csv



26/05/2020 10:59:39 : -----> Fichier 4/13 : EDI_ORDERS.56018890.771381.BATIMEX.3025940011700.20200526.202005261014.RECU.IN.csv
26/05/2020 10:59:39 : Scan fichier...
26/05/2020 10:59:39 : Import Commande Manuel.
26/05/2020 10:59:43 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 10:59:47 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56018890'
26/05/2020 11:00:35 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011700' and CT_Type=0
26/05/2020 11:00:42 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940014900' and CT_Type=0
26/05/2020 11:00:46 | getClient() : Erreur[40] - GLN destinataire  3025940014900 n'existe pas dans la base sage.
26/05/2020 11:00:47 : ********************** Erreur *********************
26/05/2020 11:00:47 : Acheteur trouvé est null, verifier le code Acheteur.
26/05/2020 11:00:47 : Import annulée

26/05/2020 11:00:47 : ********************** Fichier *********************
26/05/2020 11:00:47 : Import annulée
26/05/2020 11:00:47 : Le fichier 'E:\EDI\EDI_ORDERS.56018890.771381.BATIMEX.3025940011700.20200526.202005261014.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\26052020110047__56018890__EDI_ORDERS.56018890.771381.BATIMEX.3025940011700.20200526.202005261014.RECU.IN.csv

26/05/2020 11:00:47 : -----> Fichier 5/13 : EDI_ORDERS.56019021.771406.BATIMEX.3025940011900.20200526.202005261016.RECU.IN.csv
26/05/2020 11:00:47 : Scan fichier...
26/05/2020 11:00:47 : Import Commande Manuel.
26/05/2020 11:00:50 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:00:54 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56019021'
26/05/2020 11:01:46 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011900' and CT_Type=0
26/05/2020 11:01:52 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011900' and CT_Type=0
26/05/2020 11:01:55 | existeFourniseur() : id '3779000001461'
26/05/2020 11:01:58 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:01:58 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:01:59 | get_adresse_livraison() : Called1
26/05/2020 11:02:02 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMMARSEILLE'
26/05/2020 11:02:03 | getDevise() : Code ISO 'EUR'
26/05/2020 11:02:06 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:02:06 | getDevise() : Devise trouvé!
26/05/2020 11:02:06 : ORDHD1 trouvé.

26/05/2020 11:02:06 : ORDLIN trouvé.
26/05/2020 11:02:06 : ORDLIN line 1 / 5.
26/05/2020 11:02:06 : ORDLIN line 1 / 5.
26/05/2020 11:02:06 : ORDLIN line 1 / 5.
26/05/2020 11:02:06 | getArticle() : Code Article : 3760119730690
26/05/2020 11:02:06 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:02:06 | getArticle() : Article trouvé!
26/05/2020 11:02:06 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 11:02:09 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 11:02:09 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:02:10 : tab ===> line.article.Conditionnement
26/05/2020 11:02:10 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:02:10 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:02:10 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:02:10 : ********************** Prix *********************
26/05/2020 11:02:10 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 11:02:10 : ********************** Warning Prix *********************
26/05/2020 11:02:10 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 11:02:10 : Utilise le prix de la base : 36,900000.

26/05/2020 11:02:10 : ORDLIN line 1 / 5.
26/05/2020 11:02:10 | getArticle() : Code Article : 3760119734292
26/05/2020 11:02:10 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119734292' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:02:10 | getArticle() : Article trouvé!
26/05/2020 11:02:10 | getConditionnementArticle() : Code Article : PBB-1560
26/05/2020 11:02:13 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='PBB-1560'
26/05/2020 11:02:13 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:02:14 : tab ===> line.article.Conditionnement
26/05/2020 11:02:14 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:02:14 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:02:14 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:02:14 : ********************** Prix *********************
26/05/2020 11:02:14 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

26/05/2020 11:02:14 : ********************** Warning Prix *********************
26/05/2020 11:02:14 : Prix de l'article PBB-1560(3760119734292) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
26/05/2020 11:02:14 : Utilise le prix de la base : 19,500000.

26/05/2020 11:02:14 : ORDLIN line 1 / 5.
26/05/2020 11:02:14 | getStockId() : Called!
26/05/2020 11:02:17 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:02:17 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:02:18 | getNumLivraison() : Client Numéro => 01LMMARSEILLE
26/05/2020 11:02:21 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMMARSEILLE' and li_principal=1
26/05/2020 11:02:21 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:02:22 | insertOrder() : Récupére tous les tva
26/05/2020 11:02:22 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:02:22 | insertCommande() : Called!
26/05/2020 11:02:25 : insertCommande() | called!
26/05/2020 11:02:25 : insertCommande() | Requette pour Batimex.
26/05/2020 11:02:25 : insertCommande() | ODBC.
26/05/2020 11:02:25 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMMARSEILLE',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202671','/56019021',21,2,1,'01LMMARSEILLE',11,0,1,1,0,47,1,'3025940011900;3779000001461','56019021',20,0,0)
26/05/2020 11:02:25 : insertCommande() | called!
26/05/2020 11:02:25 : insertCommande() | Requette pour Batimex.
26/05/2020 11:02:25 : insertCommande() | ODBC.
26/05/2020 11:02:27 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
26/05/2020 11:02:27 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:02:27 | insertOrder() : List des TVA trouvé
26/05/2020 11:02:27 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:02:27 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:02:27 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:02:27 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:02:27 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:02:27 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:02:27 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:02:27 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
26/05/2020 11:02:27 | insertOrder() : Prix TTC créé


26/05/2020 11:02:27 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
26/05/2020 11:02:27 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
26/05/2020 11:02:27 | insertCommandeLine() : Called!
26/05/2020 11:02:27 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMMARSEILLE',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202671',1,0,0,'', NULL,'56019021',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202671', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
26/05/2020 11:02:27 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:02:27 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:02:27 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

26/05/2020 11:02:27 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:02:27 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
26/05/2020 11:02:27 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (544,000000), AS_StockMontant (0,000000).

26/05/2020 11:02:27 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:02:27 | insertOrder() : new_AS_StockReserve: 548 = AS_StockReserve: 544 + Quantite: 4
26/05/2020 11:02:27 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
26/05/2020 11:02:27 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:02:27 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:02:27 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 548, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

Récupérer les TVA des l'article PBB-1560
26/05/2020 11:02:27 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='PBB-1560' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:02:27 | insertOrder() : List des TVA trouvé
26/05/2020 11:02:27 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:02:27 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:02:27 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:02:27 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:02:27 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:02:27 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:02:27 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:02:27 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
26/05/2020 11:02:27 | insertOrder() : Prix TTC créé


26/05/2020 11:02:27 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
26/05/2020 11:02:27 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
26/05/2020 11:02:27 | insertCommandeLine() : Called!
26/05/2020 11:02:27 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','PBB-1560','01LMMARSEILLE',7, 'BALADEUSE MULTICOLOR LIBERTY LUMISK',2,19.500000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202671',1,0,0,'', NULL,'56019021',3000000.00,3000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202671', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
26/05/2020 11:02:27 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:02:27 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:02:27 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

26/05/2020 11:02:27 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:02:27 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'PBB-1560' and DE_No = 1
26/05/2020 11:02:27 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (72,000000), AS_StockMontant (0,000000).

26/05/2020 11:02:27 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:02:27 | insertOrder() : new_AS_StockReserve: 76 = AS_StockReserve: 72 + Quantite: 4
26/05/2020 11:02:27 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 19,5
26/05/2020 11:02:27 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:02:27 | insertOrder() : update article LIBERTY C25 BALADEUSE LUMINEUSE RECHARGEABLE (Ref:PBB-1560) stock in F_ARTSTOCK table in the database
26/05/2020 11:02:27 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 76, AS_MontSto = 0 WHERE AR_Ref = 'PBB-1560' and DE_No = 1

26/05/2020 11:02:27 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56019021
26/05/2020 11:02:27 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 56.4 WHERE DO_PIECE = 'BC202671' 


26/05/2020 11:02:28 : 2/2 ligne(s) enregistrée(s).


26/05/2020 11:02:28 : Le fichier 'E:\EDI\EDI_ORDERS.56019021.771406.BATIMEX.3025940011900.20200526.202005261016.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020110228__56019021__EDI_ORDERS.56019021.771406.BATIMEX.3025940011900.20200526.202005261016.RECU.IN.csv



26/05/2020 11:02:28 : -----> Fichier 6/13 : EDI_ORDERS.56023222.771427.BATIMEX.3025940017500.20200526.202005261018.RECU.IN.csv
26/05/2020 11:02:28 : Scan fichier...
26/05/2020 11:02:28 : Import Commande Manuel.
26/05/2020 11:02:31 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:02:35 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56023222'
26/05/2020 11:03:32 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017500' and CT_Type=0
26/05/2020 11:03:38 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017500' and CT_Type=0
26/05/2020 11:03:41 | existeFourniseur() : id '3779000001461'
26/05/2020 11:03:44 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:03:45 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:03:45 | get_adresse_livraison() : Called1
26/05/2020 11:03:49 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBRIVE'
26/05/2020 11:03:49 | getDevise() : Code ISO 'EUR'
26/05/2020 11:03:52 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:03:52 | getDevise() : Devise trouvé!
26/05/2020 11:03:53 : ORDHD1 trouvé.

26/05/2020 11:03:53 : ORDLIN trouvé.
26/05/2020 11:03:53 : ORDLIN line 1 / 5.
26/05/2020 11:03:53 : ORDLIN line 1 / 5.
26/05/2020 11:03:53 : ORDLIN line 1 / 5.
26/05/2020 11:03:53 | getArticle() : Code Article : 3760093543743
26/05/2020 11:03:53 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543743' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:03:53 | getArticle() : Article trouvé!
26/05/2020 11:03:53 | getConditionnementArticle() : Code Article : COCO
26/05/2020 11:03:57 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COCO'
26/05/2020 11:03:57 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:03:58 : tab ===> line.article.Conditionnement
26/05/2020 11:03:58 | Calcule_conditionnement() : Qte '6,00', Qte conditionnement '4'
26/05/2020 11:03:58 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 2
26/05/2020 11:03:58 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 1

26/05/2020 11:03:58 : ********************** Prix *********************
26/05/2020 11:03:58 : Prix trouvé dans le fichier EDI => 12,17 && Prix trouvé dans Sage => 0,000000

26/05/2020 11:03:58 : ORDLIN line 1 / 5.
26/05/2020 11:03:58 | getArticle() : Code Article : 3760093543804
26/05/2020 11:03:58 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543804' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:03:58 | getArticle() : Article trouvé!
26/05/2020 11:03:58 | getConditionnementArticle() : Code Article : RAINBOW
26/05/2020 11:04:01 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='RAINBOW'
26/05/2020 11:04:01 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:04:02 : tab ===> line.article.Conditionnement
26/05/2020 11:04:02 | Calcule_conditionnement() : Qte '6,00', Qte conditionnement '9'
26/05/2020 11:04:02 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 6
26/05/2020 11:04:02 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

26/05/2020 11:04:02 : ********************** Prix *********************
26/05/2020 11:04:02 : Prix trouvé dans le fichier EDI => 10,07 && Prix trouvé dans Sage => 0,000000

26/05/2020 11:04:02 : ORDLIN line 1 / 5.
26/05/2020 11:04:02 | getStockId() : Called!
26/05/2020 11:04:05 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:04:05 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:04:06 | getNumLivraison() : Client Numéro => 01LMBRIVE
26/05/2020 11:04:09 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBRIVE' and li_principal=1
26/05/2020 11:04:09 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:04:10 | insertOrder() : Récupére tous les tva
26/05/2020 11:04:10 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:04:10 | insertCommande() : Called!
26/05/2020 11:04:13 : insertCommande() | called!
26/05/2020 11:04:13 : insertCommande() | Requette pour Batimex.
26/05/2020 11:04:13 : insertCommande() | ODBC.
26/05/2020 11:04:13 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBRIVE',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202672','/56023222',21,2,1,'01LMBRIVE',11,0,1,1,0,1240,1,'3025940017500;3779000001461','56023222',20,0,0)
26/05/2020 11:04:13 : insertCommande() | called!
26/05/2020 11:04:13 : insertCommande() | Requette pour Batimex.
26/05/2020 11:04:13 : insertCommande() | ODBC.
26/05/2020 11:04:15 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article COCO
26/05/2020 11:04:15 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COCO' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:04:15 | insertOrder() : List des TVA trouvé
26/05/2020 11:04:15 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:04:15 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:04:15 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:04:15 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:04:15 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:04:15 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:04:15 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:04:15 | insertOrder() : Prix HT => 12,17 | TVA => 20,17 % | Prix TTC => 14,624689
26/05/2020 11:04:15 | insertOrder() : Prix TTC créé


26/05/2020 11:04:15 | insertOrder() : DL_MontantHT : 73.02 = DL_PrixUnitaire : 12.17 X DL_QteBC : 6.00
26/05/2020 11:04:15 | insertOrder() : DL_MontantTTC : 87.748134 = DL_PUTTC : 14.624689 X DL_QteBC : 6.00
26/05/2020 11:04:15 | insertCommandeLine() : Called!
26/05/2020 11:04:15 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COCO','01LMBRIVE',7, 'LANTERNE SOLAIRE COCO NOIR ETOR BAT',1,12.17,6.00,'Carton de 4',2,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202672',1,0,0,'', NULL,'56023222',4680000.00,4680000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,14.624689, 'BC202672', '', 0.000000, 6.00, 6.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 73.02, 87.748134)
26/05/2020 11:04:16 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:04:16 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:04:16 | insertOrder() : Additionner le total HT (12.17) et TTC (14.624689)

26/05/2020 11:04:16 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:04:16 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COCO' and DE_No = 1
26/05/2020 11:04:16 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article RAINBOW
26/05/2020 11:04:16 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='RAINBOW' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:04:16 | insertOrder() : List des TVA trouvé
26/05/2020 11:04:16 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:04:16 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:04:16 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:04:16 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:04:16 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:04:16 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:04:16 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:04:16 | insertOrder() : Prix HT => 10,07 | TVA => 20,17 % | Prix TTC => 12,101119
26/05/2020 11:04:16 | insertOrder() : Prix TTC créé


26/05/2020 11:04:16 | insertOrder() : DL_MontantHT : 60.42 = DL_PrixUnitaire : 10.07 X DL_QteBC : 6.00
26/05/2020 11:04:16 | insertOrder() : DL_MontantTTC : 72.606714 = DL_PUTTC : 12.101119 X DL_QteBC : 6.00
26/05/2020 11:04:16 | insertCommandeLine() : Called!
26/05/2020 11:04:16 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','RAINBOW','01LMBRIVE',7, 'LANTERNE SOLAIRE RAINBOW BLANC BATI',2,10.07,6.00,'Carton de 9',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202672',1,0,0,'', NULL,'56023222',4500000.00,4500000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,12.101119, 'BC202672', '', 0.000000, 6.00, 6.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 60.42, 72.606714)
26/05/2020 11:04:16 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:04:16 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:04:16 | insertOrder() : Additionner le total HT (10.07) et TTC (12.101119)

26/05/2020 11:04:16 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:04:16 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'RAINBOW' and DE_No = 1
26/05/2020 11:04:16 | insertOrder() : Aucune reponse.

26/05/2020 11:04:16 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56023222
26/05/2020 11:04:16 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 22.24 WHERE DO_PIECE = 'BC202672' 


26/05/2020 11:04:16 : 2/2 ligne(s) enregistrée(s).


26/05/2020 11:04:16 : Le fichier 'E:\EDI\EDI_ORDERS.56023222.771427.BATIMEX.3025940017500.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020110416__56023222__EDI_ORDERS.56023222.771427.BATIMEX.3025940017500.20200526.202005261018.RECU.IN.csv



26/05/2020 11:04:16 : -----> Fichier 7/13 : EDI_ORDERS.56024447.771363.BATIMEX.3025940018600.20200526.202005261013.RECU.IN.csv
26/05/2020 11:04:16 : Scan fichier...
26/05/2020 11:04:16 : Import Commande Manuel.
26/05/2020 11:04:19 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:04:23 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56024447'
26/05/2020 11:05:18 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018600' and CT_Type=0
26/05/2020 11:05:25 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018600' and CT_Type=0
26/05/2020 11:05:28 | existeFourniseur() : id '3779000001461'
26/05/2020 11:05:32 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:05:32 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:05:33 | get_adresse_livraison() : Called1
26/05/2020 11:05:36 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMREIMSCORMONTR'
26/05/2020 11:05:37 | getDevise() : Code ISO 'EUR'
26/05/2020 11:05:41 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:05:41 | getDevise() : Devise trouvé!
26/05/2020 11:05:42 : ORDHD1 trouvé.

26/05/2020 11:05:42 : ORDLIN trouvé.
26/05/2020 11:05:42 : ORDLIN line 1 / 5.
26/05/2020 11:05:42 : ORDLIN line 1 / 5.
26/05/2020 11:05:42 : ORDLIN line 1 / 5.
26/05/2020 11:05:42 | getArticle() : Code Article : 3760119739013
26/05/2020 11:05:42 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739013' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:05:42 | getArticle() : Article trouvé!
26/05/2020 11:05:42 | getConditionnementArticle() : Code Article : MAFY_LIGHT
26/05/2020 11:05:46 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY_LIGHT'
26/05/2020 11:05:46 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:05:46 : tab ===> line.article.Conditionnement
26/05/2020 11:05:46 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
26/05/2020 11:05:46 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
26/05/2020 11:05:46 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

26/05/2020 11:05:46 : ********************** Prix *********************
26/05/2020 11:05:46 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 25,900000

26/05/2020 11:05:46 : ********************** Warning Prix *********************
26/05/2020 11:05:46 : Prix de l'article MAFY_LIGHT(3760119739013) dans la base est : 25,900000
Il est différent du prix envoyer par le client : 26,07.
26/05/2020 11:05:46 : Utilise le prix de la base : 25,900000.

26/05/2020 11:05:46 : ORDLIN line 1 / 5.
26/05/2020 11:05:46 | getArticle() : Code Article : 3760093542906
26/05/2020 11:05:46 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:05:46 | getArticle() : Article trouvé!
26/05/2020 11:05:46 | getConditionnementArticle() : Code Article : BLACKBURN
26/05/2020 11:05:50 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
26/05/2020 11:05:50 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:05:50 : tab ===> line.article.Conditionnement
26/05/2020 11:05:50 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:05:50 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:05:50 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:05:50 : ********************** Prix *********************
26/05/2020 11:05:50 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

26/05/2020 11:05:50 : ********************** Warning Prix *********************
26/05/2020 11:05:50 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
26/05/2020 11:05:50 : Utilise le prix de la base : 21,900000.

26/05/2020 11:05:50 : ORDLIN line 1 / 5.
26/05/2020 11:05:50 | getStockId() : Called!
26/05/2020 11:05:54 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:05:54 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:05:55 | getNumLivraison() : Client Numéro => 01LMREIMSCORMONTR
26/05/2020 11:05:58 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMREIMSCORMONTR' and li_principal=1
26/05/2020 11:05:58 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:05:59 | insertOrder() : Récupére tous les tva
26/05/2020 11:05:59 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:05:59 | insertCommande() : Called!
26/05/2020 11:06:03 : insertCommande() | called!
26/05/2020 11:06:03 : insertCommande() | Requette pour Batimex.
26/05/2020 11:06:03 : insertCommande() | ODBC.
26/05/2020 11:06:03 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMREIMSCORMONTR',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202673','/56024447',21,2,1,'01LMREIMSCORMONTR',11,0,1,1,0,3027,1,'3025940018600;3779000001461','56024447',20,0,0)
26/05/2020 11:06:03 : insertCommande() | called!
26/05/2020 11:06:03 : insertCommande() | Requette pour Batimex.
26/05/2020 11:06:03 : insertCommande() | ODBC.
26/05/2020 11:06:04 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article MAFY_LIGHT
26/05/2020 11:06:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:06:04 | insertOrder() : List des TVA trouvé
26/05/2020 11:06:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:06:04 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:06:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:06:04 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:06:04 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:06:04 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:06:04 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:06:04 | insertOrder() : Prix HT => 25,9 | TVA => 20,17 % | Prix TTC => 31,12403
26/05/2020 11:06:04 | insertOrder() : Prix TTC créé


26/05/2020 11:06:04 | insertOrder() : DL_MontantHT : 207.2 = DL_PrixUnitaire : 25.900000 X DL_QteBC : 8.00
26/05/2020 11:06:04 | insertOrder() : DL_MontantTTC : 248.99224 = DL_PUTTC : 31.12403 X DL_QteBC : 8.00
26/05/2020 11:06:04 | insertCommandeLine() : Called!
26/05/2020 11:06:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY_LIGHT','01LMREIMSCORMONTR',7, 'GUIRLANDE EXT 6M MAFY LIGHT LUMISKY',1,25.900000,8.00,'Carton de 4',2,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202673',1,0,0,'', NULL,'56024447',13600000.00,13600000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.12403, 'BC202673', '', 0.000000, 8.00, 8.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 207.2, 248.99224)
26/05/2020 11:06:05 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:06:05 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:06:05 | insertOrder() : Additionner le total HT (25.900000) et TTC (31.12403)

26/05/2020 11:06:05 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:06:05 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1
26/05/2020 11:06:05 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (276,000000), AS_StockMontant (0,000000).

26/05/2020 11:06:05 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:06:05 | insertOrder() : new_AS_StockReserve: 284 = AS_StockReserve: 276 + Quantite: 8
26/05/2020 11:06:05 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 25,9
26/05/2020 11:06:05 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:06:05 | insertOrder() : update article MAFY LIGHT GUIRLANDE CABLE AVEC AMPOULES (Ref:MAFY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:06:05 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 284, AS_MontSto = 0 WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1

Récupérer les TVA des l'article BLACKBURN
26/05/2020 11:06:05 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:06:05 | insertOrder() : List des TVA trouvé
26/05/2020 11:06:05 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:06:05 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:06:05 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:06:05 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:06:05 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:06:05 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:06:05 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:06:05 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
26/05/2020 11:06:05 | insertOrder() : Prix TTC créé


26/05/2020 11:06:05 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
26/05/2020 11:06:05 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
26/05/2020 11:06:05 | insertCommandeLine() : Called!
26/05/2020 11:06:05 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMREIMSCORMONTR',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-04'},0,'BC202673',1,0,0,'', NULL,'56024447',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202673', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
26/05/2020 11:06:05 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:06:05 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:06:05 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

26/05/2020 11:06:05 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:06:05 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
26/05/2020 11:06:05 | insertOrder() : Aucune reponse.

26/05/2020 11:06:05 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56024447
26/05/2020 11:06:05 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 47.8 WHERE DO_PIECE = 'BC202673' 


26/05/2020 11:06:05 : 2/2 ligne(s) enregistrée(s).


26/05/2020 11:06:05 : Le fichier 'E:\EDI\EDI_ORDERS.56024447.771363.BATIMEX.3025940018600.20200526.202005261013.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020110605__56024447__EDI_ORDERS.56024447.771363.BATIMEX.3025940018600.20200526.202005261013.RECU.IN.csv



26/05/2020 11:06:05 : -----> Fichier 8/13 : EDI_ORDERS.80149894.771425.BATIMEX.3025940017300.20200526.202005261018.RECU.IN.csv
26/05/2020 11:06:05 : Scan fichier...
26/05/2020 11:06:05 : Import Commande Manuel.
26/05/2020 11:06:09 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:06:13 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80149894'
26/05/2020 11:07:06 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017300' and CT_Type=0
26/05/2020 11:07:13 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017300' and CT_Type=0
26/05/2020 11:07:16 | existeFourniseur() : id '3779000001461'
26/05/2020 11:07:20 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:07:21 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:07:21 | get_adresse_livraison() : Called1
26/05/2020 11:07:25 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBIGANOS'
26/05/2020 11:07:26 | getDevise() : Code ISO 'EUR'
26/05/2020 11:07:29 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:07:29 | getDevise() : Devise trouvé!
26/05/2020 11:07:30 : ORDHD1 trouvé.

26/05/2020 11:07:30 : ORDLIN trouvé.
26/05/2020 11:07:30 : ORDLIN line 1 / 4.
26/05/2020 11:07:30 : ORDLIN line 1 / 4.
26/05/2020 11:07:30 : ORDLIN line 1 / 4.
26/05/2020 11:07:30 | getArticle() : Code Article : 3760119730690
26/05/2020 11:07:30 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:07:30 | getArticle() : Article trouvé!
26/05/2020 11:07:30 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 11:07:33 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 11:07:33 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:07:34 : tab ===> line.article.Conditionnement
26/05/2020 11:07:34 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:07:34 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:07:34 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:07:34 : ********************** Prix *********************
26/05/2020 11:07:34 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 11:07:34 : ********************** Warning Prix *********************
26/05/2020 11:07:34 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 11:07:34 : Utilise le prix de la base : 36,900000.

26/05/2020 11:07:34 : ORDLIN line 1 / 4.
26/05/2020 11:07:34 | getStockId() : Called!
26/05/2020 11:07:38 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:07:38 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:07:39 | getNumLivraison() : Client Numéro => 01LMBIGANOS
26/05/2020 11:07:42 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBIGANOS' and li_principal=1
26/05/2020 11:07:42 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:07:43 | insertOrder() : Récupére tous les tva
26/05/2020 11:07:43 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:07:43 | insertCommande() : Called!
26/05/2020 11:07:47 : insertCommande() | called!
26/05/2020 11:07:47 : insertCommande() | Requette pour Batimex.
26/05/2020 11:07:47 : insertCommande() | ODBC.
26/05/2020 11:07:47 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBIGANOS',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202674','/80149894',21,2,1,'01LMBIGANOS',11,0,1,1,0,1103,1,'3025940017300;3779000001461','80149894',20,0,0)
26/05/2020 11:07:47 : insertCommande() | called!
26/05/2020 11:07:47 : insertCommande() | Requette pour Batimex.
26/05/2020 11:07:47 : insertCommande() | ODBC.
26/05/2020 11:07:48 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
26/05/2020 11:07:48 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:07:48 | insertOrder() : List des TVA trouvé
26/05/2020 11:07:48 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:07:48 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:07:48 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:07:48 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:07:48 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:07:48 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:07:48 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:07:48 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
26/05/2020 11:07:48 | insertOrder() : Prix TTC créé


26/05/2020 11:07:48 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
26/05/2020 11:07:48 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
26/05/2020 11:07:48 | insertCommandeLine() : Called!
26/05/2020 11:07:48 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMBIGANOS',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202674',1,0,0,'', NULL,'80149894',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202674', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
26/05/2020 11:07:49 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:07:49 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:07:49 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

26/05/2020 11:07:49 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:07:49 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
26/05/2020 11:07:49 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (548,000000), AS_StockMontant (0,000000).

26/05/2020 11:07:49 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:07:49 | insertOrder() : new_AS_StockReserve: 552 = AS_StockReserve: 548 + Quantite: 4
26/05/2020 11:07:49 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
26/05/2020 11:07:49 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:07:49 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:07:49 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 552, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

26/05/2020 11:07:49 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80149894
26/05/2020 11:07:49 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202674' 


26/05/2020 11:07:49 : 1/1 ligne(s) enregistrée(s).


26/05/2020 11:07:49 : Le fichier 'E:\EDI\EDI_ORDERS.80149894.771425.BATIMEX.3025940017300.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020110749__80149894__EDI_ORDERS.80149894.771425.BATIMEX.3025940017300.20200526.202005261018.RECU.IN.csv



26/05/2020 11:07:49 : -----> Fichier 9/13 : EDI_ORDERS.80162923.771426.BATIMEX.3025940013500.20200526.202005261018.RECU.IN.csv
26/05/2020 11:07:49 : Scan fichier...
26/05/2020 11:07:49 : Import Commande Manuel.
26/05/2020 11:07:53 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:07:57 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80162923'
26/05/2020 11:08:52 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940013500' and CT_Type=0
26/05/2020 11:08:59 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940013500' and CT_Type=0
26/05/2020 11:09:02 | existeFourniseur() : id '3779000001461'
26/05/2020 11:09:06 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:09:06 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:09:07 | get_adresse_livraison() : Called1
26/05/2020 11:09:11 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMMACON'
26/05/2020 11:09:11 | getDevise() : Code ISO 'EUR'
26/05/2020 11:09:15 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:09:15 | getDevise() : Devise trouvé!
26/05/2020 11:09:16 : ORDHD1 trouvé.

26/05/2020 11:09:16 : ORDLIN trouvé.
26/05/2020 11:09:16 : ORDLIN line 1 / 4.
26/05/2020 11:09:16 : ORDLIN line 1 / 4.
26/05/2020 11:09:16 : ORDLIN line 1 / 4.
26/05/2020 11:09:16 | getArticle() : Code Article : 3760119730690
26/05/2020 11:09:16 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:09:16 | getArticle() : Article trouvé!
26/05/2020 11:09:16 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 11:09:19 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 11:09:19 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:09:20 : tab ===> line.article.Conditionnement
26/05/2020 11:09:20 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:09:20 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:09:20 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:09:20 : ********************** Prix *********************
26/05/2020 11:09:20 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 11:09:20 : ********************** Warning Prix *********************
26/05/2020 11:09:20 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 11:09:20 : Utilise le prix de la base : 36,900000.

26/05/2020 11:09:20 : ORDLIN line 1 / 4.
26/05/2020 11:09:20 | getStockId() : Called!
26/05/2020 11:09:24 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:09:24 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:09:24 | getNumLivraison() : Client Numéro => 01LMMACON
26/05/2020 11:09:28 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMMACON' and li_principal=1
26/05/2020 11:09:29 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:09:29 | insertOrder() : Récupére tous les tva
26/05/2020 11:09:29 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:09:29 | insertCommande() : Called!
26/05/2020 11:09:33 : insertCommande() | called!
26/05/2020 11:09:33 : insertCommande() | Requette pour Batimex.
26/05/2020 11:09:33 : insertCommande() | ODBC.
26/05/2020 11:09:33 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMMACON',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202675','/80162923',21,2,1,'01LMMACON',11,0,1,1,0,1147,1,'3025940013500;3779000001461','80162923',20,0,0)
26/05/2020 11:09:33 : insertCommande() | called!
26/05/2020 11:09:33 : insertCommande() | Requette pour Batimex.
26/05/2020 11:09:33 : insertCommande() | ODBC.
26/05/2020 11:09:35 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
26/05/2020 11:09:35 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:09:35 | insertOrder() : List des TVA trouvé
26/05/2020 11:09:35 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:09:35 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:09:35 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:09:35 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:09:35 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:09:35 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:09:35 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:09:35 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
26/05/2020 11:09:35 | insertOrder() : Prix TTC créé


26/05/2020 11:09:35 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
26/05/2020 11:09:35 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
26/05/2020 11:09:35 | insertCommandeLine() : Called!
26/05/2020 11:09:35 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMMACON',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-08'},0,'BC202675',1,0,0,'', NULL,'80162923',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202675', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
26/05/2020 11:09:35 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:09:35 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:09:35 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

26/05/2020 11:09:35 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:09:35 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
26/05/2020 11:09:35 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (552,000000), AS_StockMontant (0,000000).

26/05/2020 11:09:35 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:09:35 | insertOrder() : new_AS_StockReserve: 556 = AS_StockReserve: 552 + Quantite: 4
26/05/2020 11:09:35 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
26/05/2020 11:09:35 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:09:35 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:09:35 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 556, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

26/05/2020 11:09:35 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80162923
26/05/2020 11:09:35 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202675' 


26/05/2020 11:09:35 : 1/1 ligne(s) enregistrée(s).


26/05/2020 11:09:35 : Le fichier 'E:\EDI\EDI_ORDERS.80162923.771426.BATIMEX.3025940013500.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020110935__80162923__EDI_ORDERS.80162923.771426.BATIMEX.3025940013500.20200526.202005261018.RECU.IN.csv



26/05/2020 11:09:36 : -----> Fichier 10/13 : EDI_ORDERS.80280664.771373.BATIMEX.3025940011000.20200526.202005261014.RECU.IN.csv
26/05/2020 11:09:36 : Scan fichier...
26/05/2020 11:09:36 : Import Commande Manuel.
26/05/2020 11:09:39 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:09:43 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80280664'
26/05/2020 11:10:38 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011000' and CT_Type=0
26/05/2020 11:10:45 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011000' and CT_Type=0
26/05/2020 11:10:48 | existeFourniseur() : id '3779000001461'
26/05/2020 11:10:52 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:10:52 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:10:53 | get_adresse_livraison() : Called1
26/05/2020 11:10:57 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBALMA'
26/05/2020 11:10:58 | getDevise() : Code ISO 'EUR'
26/05/2020 11:11:02 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:11:02 | getDevise() : Devise trouvé!
26/05/2020 11:11:03 : ORDHD1 trouvé.

26/05/2020 11:11:03 : ORDLIN trouvé.
26/05/2020 11:11:03 : ORDLIN line 1 / 4.
26/05/2020 11:11:03 : ORDLIN line 1 / 4.
26/05/2020 11:11:03 : ORDLIN line 1 / 4.
26/05/2020 11:11:03 | getArticle() : Code Article : 3760119739013
26/05/2020 11:11:03 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739013' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:11:03 | getArticle() : Article trouvé!
26/05/2020 11:11:03 | getConditionnementArticle() : Code Article : MAFY_LIGHT
26/05/2020 11:11:06 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY_LIGHT'
26/05/2020 11:11:06 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:11:07 : tab ===> line.article.Conditionnement
26/05/2020 11:11:07 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:11:07 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:11:07 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:11:07 : ********************** Prix *********************
26/05/2020 11:11:07 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 25,900000

26/05/2020 11:11:07 : ********************** Warning Prix *********************
26/05/2020 11:11:07 : Prix de l'article MAFY_LIGHT(3760119739013) dans la base est : 25,900000
Il est différent du prix envoyer par le client : 26,07.
26/05/2020 11:11:07 : Utilise le prix de la base : 25,900000.

26/05/2020 11:11:07 : ORDLIN line 1 / 4.
26/05/2020 11:11:07 | getStockId() : Called!
26/05/2020 11:11:11 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:11:11 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:11:12 | getNumLivraison() : Client Numéro => 01LMBALMA
26/05/2020 11:11:15 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBALMA' and li_principal=1
26/05/2020 11:11:15 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:11:16 | insertOrder() : Récupére tous les tva
26/05/2020 11:11:16 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:11:16 | insertCommande() : Called!
26/05/2020 11:11:20 : insertCommande() | called!
26/05/2020 11:11:20 : insertCommande() | Requette pour Batimex.
26/05/2020 11:11:20 : insertCommande() | ODBC.
26/05/2020 11:11:20 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBALMA',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202676','/80280664',21,2,1,'01LMBALMA',11,0,1,1,0,855,1,'3025940011000;3779000001461','80280664',20,0,0)
26/05/2020 11:11:20 : insertCommande() | called!
26/05/2020 11:11:20 : insertCommande() | Requette pour Batimex.
26/05/2020 11:11:20 : insertCommande() | ODBC.
26/05/2020 11:11:21 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article MAFY_LIGHT
26/05/2020 11:11:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:11:22 | insertOrder() : List des TVA trouvé
26/05/2020 11:11:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:11:22 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:11:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:11:22 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:11:22 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:11:22 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:11:22 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:11:22 | insertOrder() : Prix HT => 25,9 | TVA => 20,17 % | Prix TTC => 31,12403
26/05/2020 11:11:22 | insertOrder() : Prix TTC créé


26/05/2020 11:11:22 | insertOrder() : DL_MontantHT : 103.6 = DL_PrixUnitaire : 25.900000 X DL_QteBC : 4.00
26/05/2020 11:11:22 | insertOrder() : DL_MontantTTC : 124.49612 = DL_PUTTC : 31.12403 X DL_QteBC : 4.00
26/05/2020 11:11:22 | insertCommandeLine() : Called!
26/05/2020 11:11:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY_LIGHT','01LMBALMA',7, 'GUIRLANDE EXT 6M MAFY LIGHT LUMISKY',1,25.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202676',1,0,0,'', NULL,'80280664',6800000.00,6800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.12403, 'BC202676', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 103.6, 124.49612)
26/05/2020 11:11:22 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:11:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:11:22 | insertOrder() : Additionner le total HT (25.900000) et TTC (31.12403)

26/05/2020 11:11:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:11:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1
26/05/2020 11:11:22 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (284,000000), AS_StockMontant (0,000000).

26/05/2020 11:11:22 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:11:22 | insertOrder() : new_AS_StockReserve: 288 = AS_StockReserve: 284 + Quantite: 4
26/05/2020 11:11:22 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 25,9
26/05/2020 11:11:22 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:11:22 | insertOrder() : update article MAFY LIGHT GUIRLANDE CABLE AVEC AMPOULES (Ref:MAFY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:11:22 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 288, AS_MontSto = 0 WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1

26/05/2020 11:11:22 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80280664
26/05/2020 11:11:22 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 25.9 WHERE DO_PIECE = 'BC202676' 


26/05/2020 11:11:23 : 1/1 ligne(s) enregistrée(s).


26/05/2020 11:11:23 : Le fichier 'E:\EDI\EDI_ORDERS.80280664.771373.BATIMEX.3025940011000.20200526.202005261014.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020111123__80280664__EDI_ORDERS.80280664.771373.BATIMEX.3025940011000.20200526.202005261014.RECU.IN.csv



26/05/2020 11:11:23 : -----> Fichier 11/13 : EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv
26/05/2020 11:11:23 : Scan fichier...
26/05/2020 11:11:23 : Import Commande Manuel.
26/05/2020 11:11:27 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:11:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80339802'
26/05/2020 11:12:25 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940013000' and CT_Type=0
26/05/2020 11:12:32 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940013000' and CT_Type=0
26/05/2020 11:12:36 | existeFourniseur() : id '3779000001461'
26/05/2020 11:12:40 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:12:40 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:12:41 | get_adresse_livraison() : Called1
26/05/2020 11:12:45 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMHOUDEMONT'
26/05/2020 11:12:46 | getDevise() : Code ISO 'EUR'
26/05/2020 11:12:50 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:12:50 | getDevise() : Devise trouvé!
26/05/2020 11:12:50 : ORDHD1 trouvé.

26/05/2020 11:12:50 : ORDLIN trouvé.
26/05/2020 11:12:50 : ORDLIN line 1 / 4.
26/05/2020 11:12:50 : ORDLIN line 1 / 4.
26/05/2020 11:12:50 : ORDLIN line 1 / 4.
26/05/2020 11:12:50 | getArticle() : Code Article : 3760119730690
26/05/2020 11:12:50 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:12:50 | getArticle() : Article trouvé!
26/05/2020 11:12:50 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 11:12:54 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 11:12:54 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:12:55 : tab ===> line.article.Conditionnement
26/05/2020 11:12:55 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:12:55 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:12:55 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:12:55 : ********************** Prix *********************
26/05/2020 11:12:55 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 11:12:55 : ********************** Warning Prix *********************
26/05/2020 11:12:55 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 11:12:55 : Utilise le prix de la base : 36,900000.

26/05/2020 11:12:55 : ORDLIN line 1 / 4.
26/05/2020 11:12:55 | getStockId() : Called!
26/05/2020 11:12:59 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:12:59 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:13:00 | getNumLivraison() : Client Numéro => 01LMHOUDEMONT
26/05/2020 11:13:04 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMHOUDEMONT' and li_principal=1
26/05/2020 11:13:04 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:13:05 | insertOrder() : Récupére tous les tva
26/05/2020 11:13:05 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:13:05 | insertCommande() : Called!
26/05/2020 11:13:09 : insertCommande() | called!
26/05/2020 11:13:09 : insertCommande() | Requette pour Batimex.
26/05/2020 11:13:09 : insertCommande() | ODBC.
26/05/2020 11:13:09 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMHOUDEMONT',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202677','/80339802',21,2,1,'01LMHOUDEMONT',11,0,1,1,0,56,1,'3025940013000;3779000001461','80339802',20,0,0)
26/05/2020 11:13:09 : insertCommande() | called!
26/05/2020 11:13:09 : insertCommande() | Requette pour Batimex.
26/05/2020 11:13:09 : insertCommande() | ODBC.
26/05/2020 11:13:09 | insertCommande() : ERREUR[4] [HY000]   Ce numéro de pièce existe déjà dans un autre document.

26/05/2020 11:13:10 : ********************** Fichier *********************
26/05/2020 11:13:10 : Import annulée
26/05/2020 11:13:10 : Le fichier 'E:\EDI\EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\26052020111310__80339802__EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv

26/05/2020 11:13:10 : -----> Fichier 12/13 : EDI_ORDERS.86923228.771351.BATIMEX.3025940006400.20200526.202005261012.RECU.IN.csv
26/05/2020 11:13:10 : Scan fichier...
26/05/2020 11:13:10 : Import Commande Manuel.
26/05/2020 11:13:14 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
26/05/2020 11:13:19 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='86923228'
26/05/2020 11:14:14 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006400' and CT_Type=0
26/05/2020 11:14:21 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006400' and CT_Type=0
26/05/2020 11:14:26 | existeFourniseur() : id '3779000001461'
26/05/2020 11:14:30 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
26/05/2020 11:14:30 | existeFourniseur() : Fournisseur trouvé!
26/05/2020 11:14:31 | get_adresse_livraison() : Called1
26/05/2020 11:14:35 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMROUENTOURVILL'
26/05/2020 11:14:36 | getDevise() : Code ISO 'EUR'
26/05/2020 11:14:40 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
26/05/2020 11:14:40 | getDevise() : Devise trouvé!
26/05/2020 11:14:41 : ORDHD1 trouvé.

26/05/2020 11:14:41 : ORDLIN trouvé.
26/05/2020 11:14:41 : ORDLIN line 1 / 4.
26/05/2020 11:14:41 : ORDLIN line 1 / 4.
26/05/2020 11:14:41 : ORDLIN line 1 / 4.
26/05/2020 11:14:41 | getArticle() : Code Article : 3760119730690
26/05/2020 11:14:41 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
26/05/2020 11:14:41 | getArticle() : Article trouvé!
26/05/2020 11:14:41 | getConditionnementArticle() : Code Article : VINTY_LIGHT
26/05/2020 11:14:44 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
26/05/2020 11:14:44 | getConditionnementArticle() : Conditionnement trouvé! 
26/05/2020 11:14:45 : tab ===> line.article.Conditionnement
26/05/2020 11:14:45 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
26/05/2020 11:14:45 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
26/05/2020 11:14:45 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

26/05/2020 11:14:45 : ********************** Prix *********************
26/05/2020 11:14:45 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

26/05/2020 11:14:45 : ********************** Warning Prix *********************
26/05/2020 11:14:45 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
26/05/2020 11:14:45 : Utilise le prix de la base : 36,900000.

26/05/2020 11:14:45 : ORDLIN line 1 / 4.
26/05/2020 11:14:45 | getStockId() : Called!
26/05/2020 11:14:49 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
26/05/2020 11:14:50 | getStockId() : Stock trouvé,  ID => 7
26/05/2020 11:14:50 | getNumLivraison() : Client Numéro => 01LMROUENTOURVILL
26/05/2020 11:14:54 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMROUENTOURVILL' and li_principal=1
26/05/2020 11:14:54 | getNumLivraison() : Numero de livraison existe pour le client!

26/05/2020 11:14:54 | insertOrder() : Récupére tous les tva
26/05/2020 11:14:54 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
26/05/2020 11:14:54 | insertCommande() : Called!
26/05/2020 11:14:59 : insertCommande() | called!
26/05/2020 11:14:59 : insertCommande() | Requette pour Batimex.
26/05/2020 11:14:59 : insertCommande() | ODBC.
26/05/2020 11:14:59 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMROUENTOURVILL',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202678','/86923228',21,2,1,'01LMROUENTOURVILL',11,0,1,1,0,3033,1,'3025940006400;3779000001461','86923228',20,0,0)
26/05/2020 11:14:59 : insertCommande() | called!
26/05/2020 11:14:59 : insertCommande() | Requette pour Batimex.
26/05/2020 11:14:59 : insertCommande() | ODBC.
26/05/2020 11:15:01 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
26/05/2020 11:15:01 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


26/05/2020 11:15:01 | insertOrder() : List des TVA trouvé
26/05/2020 11:15:01 | insertOrder() : TVA 1 V20 trouvé "20,000000"
26/05/2020 11:15:01 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
26/05/2020 11:15:01 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

26/05/2020 11:15:01 | insertOrder() : ******************** Calcule TVA ******************** 
26/05/2020 11:15:01 | insertOrder() : TVA 1 => 20.000000
26/05/2020 11:15:01 | insertOrder() : TVA 2 => 0.170000
26/05/2020 11:15:01 | insertOrder() : TVA 3 => 0.000000
26/05/2020 11:15:01 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
26/05/2020 11:15:01 | insertOrder() : Prix TTC créé


26/05/2020 11:15:01 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
26/05/2020 11:15:01 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
26/05/2020 11:15:01 | insertCommandeLine() : Called!
26/05/2020 11:15:01 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMROUENTOURVILL',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202678',1,0,0,'', NULL,'86923228',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202678', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
26/05/2020 11:15:01 | insertCommandeLine() : Ligne enregistré!!! 

26/05/2020 11:15:01 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
26/05/2020 11:15:01 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

26/05/2020 11:15:01 | insertOrder() : get current stock in F_ARTSTOCK table in the database
26/05/2020 11:15:01 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
26/05/2020 11:15:01 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (556,000000), AS_StockMontant (0,000000).

26/05/2020 11:15:01 | insertOrder() : new_AS_StockReel: 0
26/05/2020 11:15:01 | insertOrder() : new_AS_StockReserve: 560 = AS_StockReserve: 556 + Quantite: 4
26/05/2020 11:15:01 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
26/05/2020 11:15:01 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

26/05/2020 11:15:01 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
26/05/2020 11:15:01 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 560, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

26/05/2020 11:15:01 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 86923228
26/05/2020 11:15:01 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202678' 


26/05/2020 11:15:02 : 1/1 ligne(s) enregistrée(s).


26/05/2020 11:15:02 : Le fichier 'E:\EDI\EDI_ORDERS.86923228.771351.BATIMEX.3025940006400.20200526.202005261012.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\26052020111502__86923228__EDI_ORDERS.86923228.771351.BATIMEX.3025940006400.20200526.202005261012.RECU.IN.csv



