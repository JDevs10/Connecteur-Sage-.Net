##############################################################################################################################
#################################################### L'import planifier ######################################################
##### Version 1.12.11 ############################################################################################ Jdevs #####

27/05/2020 11:45:25 : -----> Fichier 0/31 : EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv
27/05/2020 11:45:25 : Scan fichier...
27/05/2020 11:45:25 : Import Commande Manuel.
27/05/2020 11:45:29 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:45:32 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='014800661'
27/05/2020 11:45:33 : ********************** Erreur *********************
27/05/2020 11:45:33 : La commande N° 014800661 existe deja dans la base.
N° de pièce : BC202699.
27/05/2020 11:45:33 : Import annulée

27/05/2020 11:45:33 : ********************** Fichier *********************
27/05/2020 11:45:33 : Import annulée
27/05/2020 11:45:33 : Le fichier 'E:\EDI\EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020114533____EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv

27/05/2020 11:45:33 : -----> Fichier 1/31 : EDI_ORDERS.231233.773968.BATIMEX.3025940043300.20200526.202005270123.RECU.IN.csv
27/05/2020 11:45:33 : Scan fichier...
27/05/2020 11:45:33 : Import Commande Manuel.
27/05/2020 11:45:36 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:45:38 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='231233'
27/05/2020 11:46:36 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940043300' and CT_Type=0
27/05/2020 11:46:41 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940043300' and CT_Type=0
27/05/2020 11:46:44 | existeFourniseur() : id '3779000001461'
27/05/2020 11:46:46 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 11:46:47 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 11:46:47 | get_adresse_livraison() : Called1
27/05/2020 11:46:50 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMWEB'
27/05/2020 11:46:50 | getDevise() : Code ISO 'EUR'
27/05/2020 11:46:53 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 11:46:53 | getDevise() : Devise trouvé!
27/05/2020 11:46:53 : ORDHD1 trouvé.

27/05/2020 11:46:53 : ORDLIN trouvé.
27/05/2020 11:46:53 : ORDLIN line 1 / 9.
27/05/2020 11:46:53 : ORDLIN line 1 / 9.
27/05/2020 11:46:53 : ORDLIN line 1 / 9.
27/05/2020 11:46:53 | getArticle() : Code Article : 3760093542906
27/05/2020 11:46:53 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:46:53 | getArticle() : Article trouvé!
27/05/2020 11:46:53 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 11:46:56 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 11:46:56 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:46:56 : tab ===> line.article.Conditionnement
27/05/2020 11:46:56 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 11:46:56 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 11:46:56 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 11:46:56 : ********************** Prix *********************
27/05/2020 11:46:56 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 11:46:56 : ********************** Warning Prix *********************
27/05/2020 11:46:56 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 11:46:56 : Utilise le prix de la base : 21,900000.

27/05/2020 11:46:56 : ORDLIN line 1 / 9.
27/05/2020 11:46:56 | getArticle() : Code Article : 3760119731987
27/05/2020 11:46:56 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119731987' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:46:56 | getArticle() : Article trouvé!
27/05/2020 11:46:56 | getConditionnementArticle() : Code Article : STANDYMINI
27/05/2020 11:46:59 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='STANDYMINI'
27/05/2020 11:46:59 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:46:59 : tab ===> line.article.Conditionnement
27/05/2020 11:46:59 | Calcule_conditionnement() : Qte '60,00', Qte conditionnement '8'
27/05/2020 11:46:59 | Calcule_conditionnement() : calcule... Valeur = 7, Reste = 4
27/05/2020 11:46:59 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 7

27/05/2020 11:46:59 : ********************** Prix *********************
27/05/2020 11:46:59 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 18,900000

27/05/2020 11:46:59 : ********************** Warning Prix *********************
27/05/2020 11:46:59 : Prix de l'article STANDYMINI(3760119731987) dans la base est : 18,900000
Il est différent du prix envoyer par le client : 19,07.
27/05/2020 11:46:59 : Utilise le prix de la base : 18,900000.

27/05/2020 11:46:59 : ORDLIN line 1 / 9.
27/05/2020 11:46:59 | getArticle() : Code Article : 3760093541305
27/05/2020 11:46:59 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093541305' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:46:59 | getArticle() : Article trouvé!
27/05/2020 11:46:59 | getConditionnementArticle() : Code Article : STANDY_MINI__DARK
27/05/2020 11:47:02 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='STANDY_MINI__DARK'
27/05/2020 11:47:02 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:47:02 : tab ===> line.article.Conditionnement
27/05/2020 11:47:02 | Calcule_conditionnement() : Qte '6,00', Qte conditionnement '8'
27/05/2020 11:47:02 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 6
27/05/2020 11:47:02 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 11:47:02 : ********************** Prix *********************
27/05/2020 11:47:02 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:47:02 : ORDLIN line 1 / 9.
27/05/2020 11:47:02 | getArticle() : Code Article : 3760093541329
27/05/2020 11:47:02 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093541329' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:47:02 | getArticle() : Article trouvé!
27/05/2020 11:47:02 | getConditionnementArticle() : Code Article : STANDY_MINI__CREAM
27/05/2020 11:47:05 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='STANDY_MINI__CREAM'
27/05/2020 11:47:05 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:47:05 : tab ===> line.article.Conditionnement
27/05/2020 11:47:05 | Calcule_conditionnement() : Qte '6,00', Qte conditionnement '8'
27/05/2020 11:47:05 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 6
27/05/2020 11:47:05 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 11:47:05 : ********************** Prix *********************
27/05/2020 11:47:05 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:47:05 : ORDLIN line 1 / 9.
27/05/2020 11:47:05 | getArticle() : Code Article : 3760093540179
27/05/2020 11:47:05 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093540179' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:47:05 | getArticle() : Article trouvé!
27/05/2020 11:47:05 | getConditionnementArticle() : Code Article : STANDY_MINI_ROUGE
27/05/2020 11:47:08 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='STANDY_MINI_ROUGE'
27/05/2020 11:47:08 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:47:08 : tab ===> line.article.Conditionnement
27/05/2020 11:47:08 | Calcule_conditionnement() : Qte '6,00', Qte conditionnement '8'
27/05/2020 11:47:08 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 6
27/05/2020 11:47:08 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 11:47:08 : ********************** Prix *********************
27/05/2020 11:47:08 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:47:08 : ORDLIN line 1 / 9.
27/05/2020 11:47:08 | getArticle() : Code Article : 3760093544498
27/05/2020 11:47:08 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093544498' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:47:08 | getArticle() : Article trouvé!
27/05/2020 11:47:08 | getConditionnementArticle() : Code Article : CHILL
27/05/2020 11:47:11 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='CHILL'
27/05/2020 11:47:11 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:47:11 : tab ===> line.article.Conditionnement
27/05/2020 11:47:11 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '10'
27/05/2020 11:47:11 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 11:47:11 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 11:47:11 : ********************** Prix *********************
27/05/2020 11:47:11 : Prix trouvé dans le fichier EDI => 15,08 && Prix trouvé dans Sage => 15,000000

27/05/2020 11:47:11 : ********************** Warning Prix *********************
27/05/2020 11:47:11 : Prix de l'article CHILL(3760093544498) dans la base est : 15,000000
Il est différent du prix envoyer par le client : 15,08.
27/05/2020 11:47:11 : Utilise le prix de la base : 15,000000.

27/05/2020 11:47:11 : ORDLIN line 1 / 9.
27/05/2020 11:47:11 | getStockId() : Called!
27/05/2020 11:47:13 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 11:47:13 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 11:47:14 | getNumLivraison() : Client Numéro => 01LMWEB
27/05/2020 11:47:16 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMWEB' and li_principal=1
27/05/2020 11:47:16 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 11:47:17 | insertOrder() : Récupére tous les tva
27/05/2020 11:47:17 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 11:47:17 | insertCommande() : Called!
27/05/2020 11:47:19 : insertCommande() | called!
27/05/2020 11:47:19 : insertCommande() | Requette pour Batimex.
27/05/2020 11:47:19 : insertCommande() | ODBC.
27/05/2020 11:47:19 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMWEB',7,0,0,0,1,1, {d '2020-05-26'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202721','/231233',21,2,1,'01LMWEB',11,0,1,1,0,3037,1,'3025940043300;3779000001461','231233',20,0,0)
27/05/2020 11:47:19 : insertCommande() | called!
27/05/2020 11:47:19 : insertCommande() | Requette pour Batimex.
27/05/2020 11:47:19 : insertCommande() | ODBC.
27/05/2020 11:47:21 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 11:47:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:47:21 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:21 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:21 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:47:21 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:21 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:21 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:21 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:47:21 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:21 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 11:47:21 | insertOrder() : Prix TTC créé


27/05/2020 11:47:21 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 11:47:21 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 11:47:21 | insertCommandeLine() : Called!
27/05/2020 11:47:21 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMWEB',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202721', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article STANDYMINI
27/05/2020 11:47:22 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='STANDYMINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:47:22 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:22 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:47:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:22 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:22 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:22 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:47:22 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:22 | insertOrder() : Prix HT => 18,9 | TVA => 20,17 % | Prix TTC => 22,71213
27/05/2020 11:47:22 | insertOrder() : Prix TTC créé


27/05/2020 11:47:22 | insertOrder() : DL_MontantHT : 1134 = DL_PrixUnitaire : 18.900000 X DL_QteBC : 60.00
27/05/2020 11:47:22 | insertOrder() : DL_MontantTTC : 1362.7278 = DL_PUTTC : 22.71213 X DL_QteBC : 60.00
27/05/2020 11:47:22 | insertCommandeLine() : Called!
27/05/2020 11:47:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','STANDYMINI','01LMWEB',7, 'LAMPE EXT STANDY MINI ANTHRACITE RO',2,18.900000,60.00,'Carton de 8',8,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',0.00,48000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.71213, 'BC202721', '', 0.000000, 60.00, 60.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 1134, 1362.7278)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (18.900000) et TTC (22.71213)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'STANDYMINI' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article STANDY_MINI__DARK
27/05/2020 11:47:22 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='STANDY_MINI__DARK' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:47:22 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:22 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:47:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:22 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:22 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:22 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:47:22 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:22 | insertOrder() : Prix HT => 19,07 | TVA => 20,17 % | Prix TTC => 22,916419
27/05/2020 11:47:22 | insertOrder() : Prix TTC créé


27/05/2020 11:47:22 | insertOrder() : DL_MontantHT : 114.42 = DL_PrixUnitaire : 19.07 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertOrder() : DL_MontantTTC : 137.498514 = DL_PUTTC : 22.916419 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertCommandeLine() : Called!
27/05/2020 11:47:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','STANDY_MINI__DARK','01LMWEB',7, 'LAMPE EXTERIEURE STANDY MINI NOIR D',3,19.07,6.00,'Carton de 8',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',5160000.00,5160000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.916419, 'BC202721', '', 0.000000, 6.00, 6.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 114.42, 137.498514)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (19.07) et TTC (22.916419)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'STANDY_MINI__DARK' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article STANDY_MINI__CREAM
27/05/2020 11:47:22 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='STANDY_MINI__CREAM' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:47:22 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:22 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:47:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:22 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:22 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:22 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:47:22 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:22 | insertOrder() : Prix HT => 19,07 | TVA => 20,17 % | Prix TTC => 22,916419
27/05/2020 11:47:22 | insertOrder() : Prix TTC créé


27/05/2020 11:47:22 | insertOrder() : DL_MontantHT : 114.42 = DL_PrixUnitaire : 19.07 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertOrder() : DL_MontantTTC : 137.498514 = DL_PUTTC : 22.916419 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertCommandeLine() : Called!
27/05/2020 11:47:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','STANDY_MINI__CREAM','01LMWEB',7, 'LAMPE EXTERIEURE STANDY MINI BEIGE ',4,19.07,6.00,'Carton de 8',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',5160000.00,5160000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.916419, 'BC202721', '', 0.000000, 6.00, 6.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 114.42, 137.498514)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (19.07) et TTC (22.916419)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'STANDY_MINI__CREAM' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article STANDY_MINI_ROUGE
27/05/2020 11:47:22 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='STANDY_MINI_ROUGE' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:47:22 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:22 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:47:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:22 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:22 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:22 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:47:22 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:22 | insertOrder() : Prix HT => 19,07 | TVA => 20,17 % | Prix TTC => 22,916419
27/05/2020 11:47:22 | insertOrder() : Prix TTC créé


27/05/2020 11:47:22 | insertOrder() : DL_MontantHT : 114.42 = DL_PrixUnitaire : 19.07 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertOrder() : DL_MontantTTC : 137.498514 = DL_PUTTC : 22.916419 X DL_QteBC : 6.00
27/05/2020 11:47:22 | insertCommandeLine() : Called!
27/05/2020 11:47:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','STANDY_MINI_ROUGE','01LMWEB',7, 'LAMPE EXTERIEURE STANDY MINI ROUGE ',5,19.07,6.00,'Carton de 8',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',5160000.00,5160000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.916419, 'BC202721', '', 0.000000, 6.00, 6.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 114.42, 137.498514)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (19.07) et TTC (22.916419)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'STANDY_MINI_ROUGE' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article CHILL
27/05/2020 11:47:22 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='CHILL' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO08 || DL_CodeTaxe3 : 


27/05/2020 11:47:22 | insertOrder() : List des TVA trouvé
27/05/2020 11:47:22 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:47:22 | insertOrder() : TVA 2 ECO08 trouvé "0,080000"
27/05/2020 11:47:22 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:47:22 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:47:22 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:47:22 | insertOrder() : TVA 2 => 0.080000
27/05/2020 11:47:22 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:47:22 | insertOrder() : Prix HT => 15 | TVA => 20,08 % | Prix TTC => 18,012
27/05/2020 11:47:22 | insertOrder() : Prix TTC créé


27/05/2020 11:47:22 | insertOrder() : DL_MontantHT : 60 = DL_PrixUnitaire : 15.000000 X DL_QteBC : 4.00
27/05/2020 11:47:22 | insertOrder() : DL_MontantTTC : 72.048 = DL_PUTTC : 18.012 X DL_QteBC : 4.00
27/05/2020 11:47:22 | insertCommandeLine() : Called!
27/05/2020 11:47:22 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','CHILL','01LMWEB',7, 'GUIRLANDE SOLAIRE 3M 10LED CHILL NA',6,15.000000,4.00,'Carton de 10',1,1, {d '2020-05-26'}, {d '2020-06-05'},0,'BC202721',1,0,0,'', NULL,'231233',1960000.00,1800000.00,'V20', 20.000000,0,0, 'ECO08',0.080000,2,2,18.012, 'BC202721', '', 0.000000, 4.00, 4.00, {d '2020-05-26'}, {d '2020-05-26'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 60, 72.048)
27/05/2020 11:47:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:47:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:47:22 | insertOrder() : Additionner le total HT (15.000000) et TTC (18.012)

27/05/2020 11:47:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'CHILL' and DE_No = 1
27/05/2020 11:47:22 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (52,000000), AS_StockMontant (0,000000).

27/05/2020 11:47:22 | insertOrder() : new_AS_StockReel: 0
27/05/2020 11:47:22 | insertOrder() : new_AS_StockReserve: 56 = AS_StockReserve: 52 + Quantite: 4
27/05/2020 11:47:22 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 15
27/05/2020 11:47:22 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 11:47:22 | insertOrder() : update article Guirlande solaire avec abat jour bambou CHILL (Ref:CHILL) stock in F_ARTSTOCK table in the database
27/05/2020 11:47:22 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 56, AS_MontSto = 0 WHERE AR_Ref = 'CHILL' and DE_No = 1

27/05/2020 11:47:22 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 231233
27/05/2020 11:47:22 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 113.01 WHERE DO_PIECE = 'BC202721' 


27/05/2020 11:47:23 : 6/6 ligne(s) enregistrée(s).


27/05/2020 11:47:23 : Le fichier 'E:\EDI\EDI_ORDERS.231233.773968.BATIMEX.3025940043300.20200526.202005270123.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020114723__231233__EDI_ORDERS.231233.773968.BATIMEX.3025940043300.20200526.202005270123.RECU.IN.csv



27/05/2020 11:47:23 : -----> Fichier 2/31 : EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv
27/05/2020 11:47:23 : Scan fichier...
27/05/2020 11:47:23 : Import Commande Manuel.
27/05/2020 11:47:25 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:47:28 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56027059'
27/05/2020 11:48:30 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940000600' and CT_Type=0
27/05/2020 11:48:34 | getClient() : Erreur[41] - GLN émetteur  3025940000600 n'existe pas dans la base sage.
27/05/2020 11:48:34 : ********************** Erreur *********************
27/05/2020 11:48:34 : Client trouvé est null, verifier le code client.
27/05/2020 11:48:34 : Import annulée

27/05/2020 11:48:34 : ********************** Fichier *********************
27/05/2020 11:48:34 : Import annulée
27/05/2020 11:48:34 : Le fichier 'E:\EDI\EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020114834__56027059__EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv

27/05/2020 11:48:34 : -----> Fichier 3/31 : EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv
27/05/2020 11:48:34 : Scan fichier...
27/05/2020 11:48:34 : Import Commande Manuel.
27/05/2020 11:48:37 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:48:40 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56027571'
27/05/2020 11:48:41 : ********************** Erreur *********************
27/05/2020 11:48:41 : La commande N° 56027571 existe deja dans la base.
N° de pièce : BP202457.
27/05/2020 11:48:41 : Import annulée

27/05/2020 11:48:41 : ********************** Fichier *********************
27/05/2020 11:48:41 : Import annulée
27/05/2020 11:48:41 : Le fichier 'E:\EDI\EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020114841____EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv

27/05/2020 11:48:41 : -----> Fichier 4/31 : EDI_ORDERS.56028874.773963.BATIMEX.3025940003600.20200527.202005270123.RECU.IN.csv
27/05/2020 11:48:41 : Scan fichier...
27/05/2020 11:48:41 : Import Commande Manuel.
27/05/2020 11:48:44 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:48:47 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56028874'
27/05/2020 11:49:44 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940003600' and CT_Type=0
27/05/2020 11:49:50 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940003600' and CT_Type=0
27/05/2020 11:49:53 | existeFourniseur() : id '3779000001461'
27/05/2020 11:49:56 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 11:49:56 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 11:49:57 | get_adresse_livraison() : Called1
27/05/2020 11:49:59 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMCHARTRES'
27/05/2020 11:50:00 | getDevise() : Code ISO 'EUR'
27/05/2020 11:50:02 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 11:50:02 | getDevise() : Devise trouvé!
27/05/2020 11:50:03 : ORDHD1 trouvé.

27/05/2020 11:50:03 : ORDLIN trouvé.
27/05/2020 11:50:03 : ORDLIN line 1 / 4.
27/05/2020 11:50:03 : ORDLIN line 1 / 4.
27/05/2020 11:50:03 : ORDLIN line 1 / 4.
27/05/2020 11:50:03 | getArticle() : Code Article : 3760093542883
27/05/2020 11:50:03 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:50:03 | getArticle() : Article trouvé!
27/05/2020 11:50:03 | getConditionnementArticle() : Code Article : COOPER
27/05/2020 11:50:06 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
27/05/2020 11:50:06 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:50:07 : tab ===> line.article.Conditionnement
27/05/2020 11:50:07 | Calcule_conditionnement() : Qte '16,00', Qte conditionnement '4'
27/05/2020 11:50:07 | Calcule_conditionnement() : calcule... Valeur = 4, Reste = 0
27/05/2020 11:50:07 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 4

27/05/2020 11:50:07 : ********************** Prix *********************
27/05/2020 11:50:07 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 11:50:07 : ********************** Warning Prix *********************
27/05/2020 11:50:07 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 11:50:07 : Utilise le prix de la base : 15,900000.

27/05/2020 11:50:07 : ORDLIN line 1 / 4.
27/05/2020 11:50:07 | getStockId() : Called!
27/05/2020 11:50:10 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 11:50:10 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 11:50:10 | getNumLivraison() : Client Numéro => 01LMCHARTRES
27/05/2020 11:50:13 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMCHARTRES' and li_principal=1
27/05/2020 11:50:13 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 11:50:13 | insertOrder() : Récupére tous les tva
27/05/2020 11:50:13 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 11:50:13 | insertCommande() : Called!
27/05/2020 11:50:16 : insertCommande() | called!
27/05/2020 11:50:16 : insertCommande() | Requette pour Batimex.
27/05/2020 11:50:16 : insertCommande() | ODBC.
27/05/2020 11:50:16 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMCHARTRES',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202722','/56028874',21,2,1,'01LMCHARTRES',11,0,1,1,0,606,1,'3025940003600;3779000001461','56028874',20,0,0)
27/05/2020 11:50:16 : insertCommande() | called!
27/05/2020 11:50:16 : insertCommande() | Requette pour Batimex.
27/05/2020 11:50:16 : insertCommande() | ODBC.
27/05/2020 11:50:17 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article COOPER
27/05/2020 11:50:17 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:50:17 | insertOrder() : List des TVA trouvé
27/05/2020 11:50:17 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:50:17 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:50:17 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:50:17 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:50:17 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:50:17 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:50:17 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:50:17 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 11:50:17 | insertOrder() : Prix TTC créé


27/05/2020 11:50:17 | insertOrder() : DL_MontantHT : 254.4 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 16.00
27/05/2020 11:50:17 | insertOrder() : DL_MontantTTC : 305.71248 = DL_PUTTC : 19.10703 X DL_QteBC : 16.00
27/05/2020 11:50:17 | insertCommandeLine() : Called!
27/05/2020 11:50:17 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMCHARTRES',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',1,15.900000,16.00,'Carton de 4',4,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202722',1,0,0,'', NULL,'56028874',20800000.00,20800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202722', '', 0.000000, 16.00, 16.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 254.4, 305.71248)
27/05/2020 11:50:18 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:50:18 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:50:18 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 11:50:18 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:50:18 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
27/05/2020 11:50:18 | insertOrder() : Aucune reponse.

27/05/2020 11:50:18 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56028874
27/05/2020 11:50:18 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 15.9 WHERE DO_PIECE = 'BC202722' 


27/05/2020 11:50:18 : 1/1 ligne(s) enregistrée(s).


27/05/2020 11:50:18 : Le fichier 'E:\EDI\EDI_ORDERS.56028874.773963.BATIMEX.3025940003600.20200527.202005270123.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020115018__56028874__EDI_ORDERS.56028874.773963.BATIMEX.3025940003600.20200527.202005270123.RECU.IN.csv



27/05/2020 11:50:18 : -----> Fichier 5/31 : EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv
27/05/2020 11:50:18 : Scan fichier...
27/05/2020 11:50:18 : Import Commande Manuel.
27/05/2020 11:50:21 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:50:24 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56029584'
27/05/2020 11:50:25 : ********************** Erreur *********************
27/05/2020 11:50:25 : La commande N° 56029584 existe deja dans la base.
N° de pièce : BP202468.
27/05/2020 11:50:25 : Import annulée

27/05/2020 11:50:25 : ********************** Fichier *********************
27/05/2020 11:50:25 : Import annulée
27/05/2020 11:50:25 : Le fichier 'E:\EDI\EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115025____EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv

27/05/2020 11:50:25 : -----> Fichier 6/31 : EDI_ORDERS.56030330.773956.BATIMEX.3025940005500.20200527.202005270122.RECU.IN.csv
27/05/2020 11:50:25 : Scan fichier...
27/05/2020 11:50:25 : Import Commande Manuel.
27/05/2020 11:50:28 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:50:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56030330'
27/05/2020 11:51:27 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940005500' and CT_Type=0
27/05/2020 11:51:32 | getClient() : Erreur[41] - GLN émetteur  3025940005500 n'existe pas dans la base sage.
27/05/2020 11:51:32 : ********************** Erreur *********************
27/05/2020 11:51:32 : Client trouvé est null, verifier le code client.
27/05/2020 11:51:32 : Import annulée

27/05/2020 11:51:32 : ********************** Fichier *********************
27/05/2020 11:51:32 : Import annulée
27/05/2020 11:51:32 : Le fichier 'E:\EDI\EDI_ORDERS.56030330.773956.BATIMEX.3025940005500.20200527.202005270122.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115132__56030330__EDI_ORDERS.56030330.773956.BATIMEX.3025940005500.20200527.202005270122.RECU.IN.csv

27/05/2020 11:51:32 : -----> Fichier 7/31 : EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv
27/05/2020 11:51:32 : Scan fichier...
27/05/2020 11:51:32 : Import Commande Manuel.
27/05/2020 11:51:35 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:51:38 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56030562'
27/05/2020 11:51:39 : ********************** Erreur *********************
27/05/2020 11:51:39 : La commande N° 56030562 existe deja dans la base.
N° de pièce : BP202459.
27/05/2020 11:51:39 : Import annulée

27/05/2020 11:51:39 : ********************** Fichier *********************
27/05/2020 11:51:39 : Import annulée
27/05/2020 11:51:39 : Le fichier 'E:\EDI\EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115139____EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv

27/05/2020 11:51:39 : -----> Fichier 8/31 : EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv
27/05/2020 11:51:39 : Scan fichier...
27/05/2020 11:51:39 : Import Commande Manuel.
27/05/2020 11:51:42 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:51:45 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56031762'
27/05/2020 11:51:46 : ********************** Erreur *********************
27/05/2020 11:51:46 : La commande N° 56031762 existe deja dans la base.
N° de pièce : BP202456.
27/05/2020 11:51:46 : Import annulée

27/05/2020 11:51:46 : ********************** Fichier *********************
27/05/2020 11:51:46 : Import annulée
27/05/2020 11:51:46 : Le fichier 'E:\EDI\EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115146____EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv

27/05/2020 11:51:46 : -----> Fichier 9/31 : EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv
27/05/2020 11:51:46 : Scan fichier...
27/05/2020 11:51:46 : Import Commande Manuel.
27/05/2020 11:51:49 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:51:52 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56034954'
27/05/2020 11:51:53 : ********************** Erreur *********************
27/05/2020 11:51:53 : La commande N° 56034954 existe deja dans la base.
N° de pièce : BP202470.
27/05/2020 11:51:53 : Import annulée

27/05/2020 11:51:53 : ********************** Fichier *********************
27/05/2020 11:51:53 : Import annulée
27/05/2020 11:51:53 : Le fichier 'E:\EDI\EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115153____EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv

27/05/2020 11:51:53 : -----> Fichier 10/31 : EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv
27/05/2020 11:51:53 : Scan fichier...
27/05/2020 11:51:53 : Import Commande Manuel.
27/05/2020 11:51:56 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:51:59 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56035686'
27/05/2020 11:52:00 : ********************** Erreur *********************
27/05/2020 11:52:00 : La commande N° 56035686 existe deja dans la base.
N° de pièce : BP202462.
27/05/2020 11:52:00 : Import annulée

27/05/2020 11:52:00 : ********************** Fichier *********************
27/05/2020 11:52:00 : Import annulée
27/05/2020 11:52:00 : Le fichier 'E:\EDI\EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115200____EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv

27/05/2020 11:52:00 : -----> Fichier 11/31 : EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv
27/05/2020 11:52:00 : Scan fichier...
27/05/2020 11:52:00 : Import Commande Manuel.
27/05/2020 11:52:03 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:52:07 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56036369'
27/05/2020 11:52:08 : ********************** Erreur *********************
27/05/2020 11:52:08 : La commande N° 56036369 existe deja dans la base.
N° de pièce : BP202458.
27/05/2020 11:52:08 : Import annulée

27/05/2020 11:52:08 : ********************** Fichier *********************
27/05/2020 11:52:08 : Import annulée
27/05/2020 11:52:08 : Le fichier 'E:\EDI\EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115208____EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv

27/05/2020 11:52:08 : -----> Fichier 12/31 : EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv
27/05/2020 11:52:08 : Scan fichier...
27/05/2020 11:52:08 : Import Commande Manuel.
27/05/2020 11:52:11 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:52:14 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56036597'
27/05/2020 11:52:15 : ********************** Erreur *********************
27/05/2020 11:52:15 : La commande N° 56036597 existe deja dans la base.
N° de pièce : BP202469.
27/05/2020 11:52:15 : Import annulée

27/05/2020 11:52:15 : ********************** Fichier *********************
27/05/2020 11:52:15 : Import annulée
27/05/2020 11:52:15 : Le fichier 'E:\EDI\EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115215____EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv

27/05/2020 11:52:15 : -----> Fichier 13/31 : EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv
27/05/2020 11:52:15 : Scan fichier...
27/05/2020 11:52:15 : Import Commande Manuel.
27/05/2020 11:52:19 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:52:23 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56037802'
27/05/2020 11:52:24 : ********************** Erreur *********************
27/05/2020 11:52:24 : La commande N° 56037802 existe deja dans la base.
N° de pièce : BP202465.
27/05/2020 11:52:24 : Import annulée

27/05/2020 11:52:24 : ********************** Fichier *********************
27/05/2020 11:52:24 : Import annulée
27/05/2020 11:52:24 : Le fichier 'E:\EDI\EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115224____EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv

27/05/2020 11:52:24 : -----> Fichier 14/31 : EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv
27/05/2020 11:52:24 : Scan fichier...
27/05/2020 11:52:24 : Import Commande Manuel.
27/05/2020 11:52:27 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:52:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56038243'
27/05/2020 11:53:32 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018500' and CT_Type=0
27/05/2020 11:53:37 | getClient() : Erreur[41] - GLN émetteur  3025940018500 n'existe pas dans la base sage.
27/05/2020 11:53:37 : ********************** Erreur *********************
27/05/2020 11:53:37 : Client trouvé est null, verifier le code client.
27/05/2020 11:53:37 : Import annulée

27/05/2020 11:53:37 : ********************** Fichier *********************
27/05/2020 11:53:37 : Import annulée
27/05/2020 11:53:37 : Le fichier 'E:\EDI\EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115337__56038243__EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv

27/05/2020 11:53:37 : -----> Fichier 15/31 : EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv
27/05/2020 11:53:37 : Scan fichier...
27/05/2020 11:53:37 : Import Commande Manuel.
27/05/2020 11:53:40 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:53:44 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039047'
27/05/2020 11:53:45 : ********************** Erreur *********************
27/05/2020 11:53:45 : La commande N° 56039047 existe deja dans la base.
N° de pièce : BP202467.
27/05/2020 11:53:45 : Import annulée

27/05/2020 11:53:45 : ********************** Fichier *********************
27/05/2020 11:53:45 : Import annulée
27/05/2020 11:53:45 : Le fichier 'E:\EDI\EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115345____EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv

27/05/2020 11:53:45 : -----> Fichier 16/31 : EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv
27/05/2020 11:53:45 : Scan fichier...
27/05/2020 11:53:45 : Import Commande Manuel.
27/05/2020 11:53:48 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:53:52 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039250'
27/05/2020 11:53:53 : ********************** Erreur *********************
27/05/2020 11:53:53 : La commande N° 56039250 existe deja dans la base.
N° de pièce : BP202460.
27/05/2020 11:53:53 : Import annulée

27/05/2020 11:53:53 : ********************** Fichier *********************
27/05/2020 11:53:53 : Import annulée
27/05/2020 11:53:53 : Le fichier 'E:\EDI\EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115353____EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv

27/05/2020 11:53:53 : -----> Fichier 17/31 : EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv
27/05/2020 11:53:53 : Scan fichier...
27/05/2020 11:53:53 : Import Commande Manuel.
27/05/2020 11:53:56 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:53:59 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039693'
27/05/2020 11:54:00 : ********************** Erreur *********************
27/05/2020 11:54:00 : La commande N° 56039693 existe deja dans la base.
N° de pièce : BP202471.
27/05/2020 11:54:00 : Import annulée

27/05/2020 11:54:00 : ********************** Fichier *********************
27/05/2020 11:54:00 : Import annulée
27/05/2020 11:54:00 : Le fichier 'E:\EDI\EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115400____EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv

27/05/2020 11:54:00 : -----> Fichier 18/31 : EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv
27/05/2020 11:54:00 : Scan fichier...
27/05/2020 11:54:00 : Import Commande Manuel.
27/05/2020 11:54:04 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:54:07 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56040285'
27/05/2020 11:54:08 : ********************** Erreur *********************
27/05/2020 11:54:08 : La commande N° 56040285 existe deja dans la base.
N° de pièce : BP202461.
27/05/2020 11:54:08 : Import annulée

27/05/2020 11:54:08 : ********************** Fichier *********************
27/05/2020 11:54:08 : Import annulée
27/05/2020 11:54:08 : Le fichier 'E:\EDI\EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115408____EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv

27/05/2020 11:54:08 : -----> Fichier 19/31 : EDI_ORDERS.80017062.773969.BATIMEX.3025940008800.20200527.202005270123.RECU.IN.csv
27/05/2020 11:54:08 : Scan fichier...
27/05/2020 11:54:08 : Import Commande Manuel.
27/05/2020 11:54:11 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:54:15 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80017062'
27/05/2020 11:55:09 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008800' and CT_Type=0
27/05/2020 11:55:15 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940008800' and CT_Type=0
27/05/2020 11:55:18 | existeFourniseur() : id '3779000001461'
27/05/2020 11:55:21 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 11:55:22 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 11:55:22 | get_adresse_livraison() : Called1
27/05/2020 11:55:25 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMALBI'
27/05/2020 11:55:26 | getDevise() : Code ISO 'EUR'
27/05/2020 11:55:29 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 11:55:29 | getDevise() : Devise trouvé!
27/05/2020 11:55:29 : ORDHD1 trouvé.

27/05/2020 11:55:29 : ORDLIN trouvé.
27/05/2020 11:55:29 : ORDLIN line 1 / 4.
27/05/2020 11:55:29 : ORDLIN line 1 / 4.
27/05/2020 11:55:29 : ORDLIN line 1 / 4.
27/05/2020 11:55:29 | getArticle() : Code Article : 3760119730690
27/05/2020 11:55:29 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:55:29 | getArticle() : Article trouvé!
27/05/2020 11:55:29 | getConditionnementArticle() : Code Article : VINTY_LIGHT
27/05/2020 11:55:32 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
27/05/2020 11:55:32 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:55:33 : tab ===> line.article.Conditionnement
27/05/2020 11:55:33 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 11:55:33 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 11:55:33 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 11:55:33 : ********************** Prix *********************
27/05/2020 11:55:33 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

27/05/2020 11:55:33 : ********************** Warning Prix *********************
27/05/2020 11:55:33 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
27/05/2020 11:55:33 : Utilise le prix de la base : 36,900000.

27/05/2020 11:55:33 : ORDLIN line 1 / 4.
27/05/2020 11:55:33 | getStockId() : Called!
27/05/2020 11:55:37 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 11:55:37 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 11:55:37 | getNumLivraison() : Client Numéro => 01LMALBI
27/05/2020 11:55:40 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMALBI' and li_principal=1
27/05/2020 11:55:40 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 11:55:41 | insertOrder() : Récupére tous les tva
27/05/2020 11:55:41 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 11:55:41 | insertCommande() : Called!
27/05/2020 11:55:44 : insertCommande() | called!
27/05/2020 11:55:44 : insertCommande() | Requette pour Batimex.
27/05/2020 11:55:44 : insertCommande() | ODBC.
27/05/2020 11:55:44 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMALBI',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-09'},0,0,1,0,1,1,'BC202723','/80017062',21,2,1,'01LMALBI',11,0,1,1,0,3370,1,'3025940008800;3779000001461','80017062',20,0,0)
27/05/2020 11:55:44 : insertCommande() | called!
27/05/2020 11:55:44 : insertCommande() | Requette pour Batimex.
27/05/2020 11:55:44 : insertCommande() | ODBC.
27/05/2020 11:55:45 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
27/05/2020 11:55:45 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:55:45 | insertOrder() : List des TVA trouvé
27/05/2020 11:55:45 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:55:45 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:55:45 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:55:45 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:55:45 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:55:45 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:55:45 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:55:45 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
27/05/2020 11:55:45 | insertOrder() : Prix TTC créé


27/05/2020 11:55:45 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
27/05/2020 11:55:45 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
27/05/2020 11:55:45 | insertCommandeLine() : Called!
27/05/2020 11:55:45 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMALBI',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-09'},0,'BC202723',1,0,0,'', NULL,'80017062',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202723', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
27/05/2020 11:55:46 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:55:46 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:55:46 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

27/05/2020 11:55:46 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:55:46 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
27/05/2020 11:55:46 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (576,000000), AS_StockMontant (0,000000).

27/05/2020 11:55:46 | insertOrder() : new_AS_StockReel: 0
27/05/2020 11:55:46 | insertOrder() : new_AS_StockReserve: 580 = AS_StockReserve: 576 + Quantite: 4
27/05/2020 11:55:46 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
27/05/2020 11:55:46 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 11:55:46 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 11:55:46 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 580, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

27/05/2020 11:55:46 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80017062
27/05/2020 11:55:46 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202723' 


27/05/2020 11:55:46 : 1/1 ligne(s) enregistrée(s).


27/05/2020 11:55:46 : Le fichier 'E:\EDI\EDI_ORDERS.80017062.773969.BATIMEX.3025940008800.20200527.202005270123.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020115546__80017062__EDI_ORDERS.80017062.773969.BATIMEX.3025940008800.20200527.202005270123.RECU.IN.csv



27/05/2020 11:55:46 : -----> Fichier 20/31 : EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv
27/05/2020 11:55:46 : Scan fichier...
27/05/2020 11:55:46 : Import Commande Manuel.
27/05/2020 11:55:49 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:55:53 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80026619'
27/05/2020 11:55:54 : ********************** Erreur *********************
27/05/2020 11:55:54 : La commande N° 80026619 existe deja dans la base.
N° de pièce : BP202466.
27/05/2020 11:55:54 : Import annulée

27/05/2020 11:55:54 : ********************** Fichier *********************
27/05/2020 11:55:54 : Import annulée
27/05/2020 11:55:54 : Le fichier 'E:\EDI\EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115554____EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv

27/05/2020 11:55:54 : -----> Fichier 21/31 : EDI_ORDERS.80271475.773953.BATIMEX.3025940011900.20200527.202005270122.RECU.IN.csv
27/05/2020 11:55:54 : Scan fichier...
27/05/2020 11:55:54 : Import Commande Manuel.
27/05/2020 11:55:57 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:56:01 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80271475'
27/05/2020 11:57:06 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011900' and CT_Type=0
27/05/2020 11:57:13 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011900' and CT_Type=0
27/05/2020 11:57:16 | existeFourniseur() : id '3779000001461'
27/05/2020 11:57:19 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 11:57:19 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 11:57:20 | get_adresse_livraison() : Called1
27/05/2020 11:57:23 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMMARSEILLE'
27/05/2020 11:57:24 | getDevise() : Code ISO 'EUR'
27/05/2020 11:57:27 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 11:57:27 | getDevise() : Devise trouvé!
27/05/2020 11:57:27 : ORDHD1 trouvé.

27/05/2020 11:57:27 : ORDLIN trouvé.
27/05/2020 11:57:27 : ORDLIN line 1 / 9.
27/05/2020 11:57:27 : ORDLIN line 1 / 9.
27/05/2020 11:57:27 : ORDLIN line 1 / 9.
27/05/2020 11:57:27 | getArticle() : Code Article : 3760119739013
27/05/2020 11:57:27 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739013' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:27 | getArticle() : Article trouvé!
27/05/2020 11:57:27 | getConditionnementArticle() : Code Article : MAFY_LIGHT
27/05/2020 11:57:30 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY_LIGHT'
27/05/2020 11:57:30 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:31 : tab ===> line.article.Conditionnement
27/05/2020 11:57:31 | Calcule_conditionnement() : Qte '60,00', Qte conditionnement '4'
27/05/2020 11:57:31 | Calcule_conditionnement() : calcule... Valeur = 15, Reste = 0
27/05/2020 11:57:31 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 15

27/05/2020 11:57:31 : ********************** Prix *********************
27/05/2020 11:57:31 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 25,900000

27/05/2020 11:57:31 : ********************** Warning Prix *********************
27/05/2020 11:57:31 : Prix de l'article MAFY_LIGHT(3760119739013) dans la base est : 25,900000
Il est différent du prix envoyer par le client : 26,07.
27/05/2020 11:57:31 : Utilise le prix de la base : 25,900000.

27/05/2020 11:57:31 : ORDLIN line 1 / 9.
27/05/2020 11:57:31 | getArticle() : Code Article : 3760119730690
27/05/2020 11:57:31 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:31 | getArticle() : Article trouvé!
27/05/2020 11:57:31 | getConditionnementArticle() : Code Article : VINTY_LIGHT
27/05/2020 11:57:34 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
27/05/2020 11:57:34 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:34 : tab ===> line.article.Conditionnement
27/05/2020 11:57:34 | Calcule_conditionnement() : Qte '20,00', Qte conditionnement '4'
27/05/2020 11:57:34 | Calcule_conditionnement() : calcule... Valeur = 5, Reste = 0
27/05/2020 11:57:34 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 5

27/05/2020 11:57:34 : ********************** Prix *********************
27/05/2020 11:57:34 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

27/05/2020 11:57:34 : ********************** Warning Prix *********************
27/05/2020 11:57:34 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
27/05/2020 11:57:34 : Utilise le prix de la base : 36,900000.

27/05/2020 11:57:34 : ORDLIN line 1 / 9.
27/05/2020 11:57:34 | getArticle() : Code Article : 3760119739020
27/05/2020 11:57:34 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739020' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:34 | getArticle() : Article trouvé!
27/05/2020 11:57:34 | getConditionnementArticle() : Code Article : MAFY
27/05/2020 11:57:38 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY'
27/05/2020 11:57:38 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:38 : tab ===> line.article.Conditionnement
27/05/2020 11:57:38 | Calcule_conditionnement() : Qte '20,00', Qte conditionnement '4'
27/05/2020 11:57:38 | Calcule_conditionnement() : calcule... Valeur = 5, Reste = 0
27/05/2020 11:57:38 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 5

27/05/2020 11:57:38 : ********************** Prix *********************
27/05/2020 11:57:38 : Prix trouvé dans le fichier EDI => 14,90 && Prix trouvé dans Sage => 14,900000

27/05/2020 11:57:38 : ORDLIN line 1 / 9.
27/05/2020 11:57:38 | getArticle() : Code Article : 3760093543309
27/05/2020 11:57:38 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543309' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:38 | getArticle() : Article trouvé!
27/05/2020 11:57:38 | getConditionnementArticle() : Code Article : HAWAI_LIGHT
27/05/2020 11:57:41 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='HAWAI_LIGHT'
27/05/2020 11:57:41 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:42 : tab ===> line.article.Conditionnement
27/05/2020 11:57:42 | Calcule_conditionnement() : Qte '20,00', Qte conditionnement '4'
27/05/2020 11:57:42 | Calcule_conditionnement() : calcule... Valeur = 5, Reste = 0
27/05/2020 11:57:42 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 5

27/05/2020 11:57:42 : ********************** Prix *********************
27/05/2020 11:57:42 : Prix trouvé dans le fichier EDI => 40,07 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:57:42 : ORDLIN line 1 / 9.
27/05/2020 11:57:42 | getArticle() : Code Article : 3760093540230
27/05/2020 11:57:42 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093540230' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:42 | getArticle() : Article trouvé!
27/05/2020 11:57:42 | getConditionnementArticle() : Code Article : LINKY_LIGHT_
27/05/2020 11:57:45 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='LINKY_LIGHT_'
27/05/2020 11:57:45 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:46 : tab ===> line.article.Conditionnement
27/05/2020 11:57:46 | Calcule_conditionnement() : Qte '20,00', Qte conditionnement '4'
27/05/2020 11:57:46 | Calcule_conditionnement() : calcule... Valeur = 5, Reste = 0
27/05/2020 11:57:46 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 5

27/05/2020 11:57:46 : ********************** Prix *********************
27/05/2020 11:57:46 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:57:46 : ORDLIN line 1 / 9.
27/05/2020 11:57:46 | getArticle() : Code Article : 3760093542746
27/05/2020 11:57:46 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542746' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:57:46 | getArticle() : Article trouvé!
27/05/2020 11:57:46 | getConditionnementArticle() : Code Article : CHIC_CAGE_LIGHT
27/05/2020 11:57:50 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='CHIC_CAGE_LIGHT'
27/05/2020 11:57:50 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:57:50 : tab ===> line.article.Conditionnement
27/05/2020 11:57:50 | Calcule_conditionnement() : Qte '20,00', Qte conditionnement '4'
27/05/2020 11:57:50 | Calcule_conditionnement() : calcule... Valeur = 5, Reste = 0
27/05/2020 11:57:50 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 5

27/05/2020 11:57:50 : ********************** Prix *********************
27/05/2020 11:57:50 : Prix trouvé dans le fichier EDI => 35,67 && Prix trouvé dans Sage => 0,000000

27/05/2020 11:57:50 : ORDLIN line 1 / 9.
27/05/2020 11:57:50 | getStockId() : Called!
27/05/2020 11:57:54 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 11:57:54 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 11:57:54 | getNumLivraison() : Client Numéro => 01LMMARSEILLE
27/05/2020 11:57:57 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMMARSEILLE' and li_principal=1
27/05/2020 11:57:57 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 11:57:58 | insertOrder() : Récupére tous les tva
27/05/2020 11:57:58 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 11:57:58 | insertCommande() : Called!
27/05/2020 11:58:01 : insertCommande() | called!
27/05/2020 11:58:01 : insertCommande() | Requette pour Batimex.
27/05/2020 11:58:01 : insertCommande() | ODBC.
27/05/2020 11:58:01 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMMARSEILLE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-04'},0,0,1,0,1,1,'BC202724','/80271475',21,2,1,'01LMMARSEILLE',11,0,1,1,0,47,1,'3025940011900;3779000001461','80271475',20,0,0)
27/05/2020 11:58:01 : insertCommande() | called!
27/05/2020 11:58:01 : insertCommande() | Requette pour Batimex.
27/05/2020 11:58:01 : insertCommande() | ODBC.
27/05/2020 11:58:03 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article MAFY_LIGHT
27/05/2020 11:58:03 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:58:03 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:03 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:03 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:58:03 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:03 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:03 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:03 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:58:03 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:03 | insertOrder() : Prix HT => 25,9 | TVA => 20,17 % | Prix TTC => 31,12403
27/05/2020 11:58:03 | insertOrder() : Prix TTC créé


27/05/2020 11:58:03 | insertOrder() : DL_MontantHT : 1554 = DL_PrixUnitaire : 25.900000 X DL_QteBC : 60.00
27/05/2020 11:58:03 | insertOrder() : DL_MontantTTC : 1867.4418 = DL_PUTTC : 31.12403 X DL_QteBC : 60.00
27/05/2020 11:58:03 | insertCommandeLine() : Called!
27/05/2020 11:58:03 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY_LIGHT','01LMMARSEILLE',7, 'GUIRLANDE EXT 6M MAFY LIGHT LUMISKY',1,25.900000,60.00,'Carton de 4',15,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',102000000.00,102000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.12403, 'BC202724', '', 0.000000, 60.00, 60.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 1554, 1867.4418)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (25.900000) et TTC (31.12403)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (296,000000), AS_StockMontant (0,000000).

27/05/2020 11:58:04 | insertOrder() : new_AS_StockReel: 0
27/05/2020 11:58:04 | insertOrder() : new_AS_StockReserve: 356 = AS_StockReserve: 296 + Quantite: 60
27/05/2020 11:58:04 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 25,9
27/05/2020 11:58:04 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 11:58:04 | insertOrder() : update article MAFY LIGHT GUIRLANDE CABLE AVEC AMPOULES (Ref:MAFY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 356, AS_MontSto = 0 WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1

Récupérer les TVA des l'article VINTY_LIGHT
27/05/2020 11:58:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:58:04 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:04 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:58:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:04 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:04 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:04 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:58:04 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:04 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
27/05/2020 11:58:04 | insertOrder() : Prix TTC créé


27/05/2020 11:58:04 | insertOrder() : DL_MontantHT : 738 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertOrder() : DL_MontantTTC : 886.8546 = DL_PUTTC : 44.34273 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertCommandeLine() : Called!
27/05/2020 11:58:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMMARSEILLE',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',2,36.900000,20.00,'Carton de 4',5,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',64000000.00,64000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202724', '', 0.000000, 20.00, 20.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 738, 886.8546)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (580,000000), AS_StockMontant (0,000000).

27/05/2020 11:58:04 | insertOrder() : new_AS_StockReel: 0
27/05/2020 11:58:04 | insertOrder() : new_AS_StockReserve: 600 = AS_StockReserve: 580 + Quantite: 20
27/05/2020 11:58:04 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
27/05/2020 11:58:04 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 11:58:04 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 600, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

Récupérer les TVA des l'article MAFY
27/05/2020 11:58:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 :  || DL_CodeTaxe3 : 


27/05/2020 11:58:04 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:04 | insertOrder() : TVA 2 VIDE trouvé, alors TVA mis à 0
27/05/2020 11:58:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:04 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:04 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:04 | insertOrder() : TVA 2 => 0.000000
27/05/2020 11:58:04 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:04 | insertOrder() : Prix HT => 14,9 | TVA => 20 % | Prix TTC => 17,88
27/05/2020 11:58:04 | insertOrder() : Prix TTC créé


27/05/2020 11:58:04 | insertOrder() : DL_MontantHT : 298 = DL_PrixUnitaire : 14.90 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertOrder() : DL_MontantTTC : 357.6 = DL_PUTTC : 17.88 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertCommandeLine() : Called!
27/05/2020 11:58:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY','01LMMARSEILLE',7, 'GUIRLANDE EXT MAFY E27 6M LUMISKY',3,14.90,20.00,'Carton de 4',5,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',24800000.00,24800000.00,'V20', 20.000000,0,0, 'C00',0.000000,2,2,17.88, 'BC202724', '', 0.000000, 20.00, 20.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 298, 357.6)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (14.90) et TTC (17.88)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (48,000000), AS_StockMontant (0,000000).

27/05/2020 11:58:04 | insertOrder() : new_AS_StockReel: 0
27/05/2020 11:58:04 | insertOrder() : new_AS_StockReserve: 68 = AS_StockReserve: 48 + Quantite: 20
27/05/2020 11:58:04 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 14,9
27/05/2020 11:58:04 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 11:58:04 | insertOrder() : update article MAFY GUIRLANDE CABLE SANS AMPOULE (Ref:MAFY) stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 68, AS_MontSto = 0 WHERE AR_Ref = 'MAFY' and DE_No = 1

Récupérer les TVA des l'article HAWAI_LIGHT
27/05/2020 11:58:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='HAWAI_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:58:04 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:04 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:58:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:04 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:04 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:04 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:58:04 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:04 | insertOrder() : Prix HT => 40,07 | TVA => 20,17 % | Prix TTC => 48,152119
27/05/2020 11:58:04 | insertOrder() : Prix TTC créé


27/05/2020 11:58:04 | insertOrder() : DL_MontantHT : 801.4 = DL_PrixUnitaire : 40.07 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertOrder() : DL_MontantTTC : 963.04238 = DL_PUTTC : 48.152119 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertCommandeLine() : Called!
27/05/2020 11:58:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','HAWAI_LIGHT','01LMMARSEILLE',7, 'GUIRLANDE EXT 6M 10LED ROTIN HAWAI',4,40.07,20.00,'Carton de 4',5,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',0.00,0.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,48.152119, 'BC202724', '', 0.000000, 20.00, 20.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 801.4, 963.04238)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (40.07) et TTC (48.152119)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'HAWAI_LIGHT' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article LINKY_LIGHT_
27/05/2020 11:58:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='LINKY_LIGHT_' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:58:04 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:04 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:58:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:04 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:04 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:04 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:58:04 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:04 | insertOrder() : Prix HT => 26,07 | TVA => 20,17 % | Prix TTC => 31,328319
27/05/2020 11:58:04 | insertOrder() : Prix TTC créé


27/05/2020 11:58:04 | insertOrder() : DL_MontantHT : 521.4 = DL_PrixUnitaire : 26.07 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertOrder() : DL_MontantTTC : 626.56638 = DL_PUTTC : 31.328319 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertCommandeLine() : Called!
27/05/2020 11:58:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','LINKY_LIGHT_','01LMMARSEILLE',7, 'GUIRLANDE EXT RACCORDABLE 10LED 6M ',5,26.07,20.00,'Carton de 4',5,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',36000000.00,36000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.328319, 'BC202724', '', 0.000000, 20.00, 20.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 521.4, 626.56638)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (26.07) et TTC (31.328319)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'LINKY_LIGHT_' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article CHIC_CAGE_LIGHT
27/05/2020 11:58:04 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='CHIC_CAGE_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:58:04 | insertOrder() : List des TVA trouvé
27/05/2020 11:58:04 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:58:04 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:58:04 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:58:04 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:58:04 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:58:04 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:58:04 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:58:04 | insertOrder() : Prix HT => 35,67 | TVA => 20,17 % | Prix TTC => 42,864639
27/05/2020 11:58:04 | insertOrder() : Prix TTC créé


27/05/2020 11:58:04 | insertOrder() : DL_MontantHT : 713.4 = DL_PrixUnitaire : 35.67 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertOrder() : DL_MontantTTC : 857.29278 = DL_PUTTC : 42.864639 X DL_QteBC : 20.00
27/05/2020 11:58:04 | insertCommandeLine() : Called!
27/05/2020 11:58:04 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','CHIC_CAGE_LIGHT','01LMMARSEILLE',7, 'GUIRLANDE EXT CHIC LIGHT 10LED FIL ',6,35.67,20.00,'Carton de 4',5,1, {d '2020-05-27'}, {d '2020-06-04'},0,'BC202724',1,0,0,'', NULL,'80271475',60000000.00,60000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,42.864639, 'BC202724', '', 0.000000, 20.00, 20.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 713.4, 857.29278)
27/05/2020 11:58:04 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:58:04 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:58:04 | insertOrder() : Additionner le total HT (35.67) et TTC (42.864639)

27/05/2020 11:58:04 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:58:04 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'CHIC_CAGE_LIGHT' and DE_No = 1
27/05/2020 11:58:04 | insertOrder() : Aucune reponse.

27/05/2020 11:58:04 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80271475
27/05/2020 11:58:04 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 179.51 WHERE DO_PIECE = 'BC202724' 


27/05/2020 11:58:05 : 6/6 ligne(s) enregistrée(s).


27/05/2020 11:58:05 : Le fichier 'E:\EDI\EDI_ORDERS.80271475.773953.BATIMEX.3025940011900.20200527.202005270122.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020115805__80271475__EDI_ORDERS.80271475.773953.BATIMEX.3025940011900.20200527.202005270122.RECU.IN.csv



27/05/2020 11:58:05 : -----> Fichier 22/31 : EDI_ORDERS.80280752.773950.BATIMEX.3025940011000.20200527.202005270122.RECU.IN.csv
27/05/2020 11:58:05 : Scan fichier...
27/05/2020 11:58:05 : Import Commande Manuel.
27/05/2020 11:58:08 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:58:12 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80280752'
27/05/2020 11:59:07 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011000' and CT_Type=0
27/05/2020 11:59:14 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940011000' and CT_Type=0
27/05/2020 11:59:17 | existeFourniseur() : id '3779000001461'
27/05/2020 11:59:21 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 11:59:21 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 11:59:22 | get_adresse_livraison() : Called1
27/05/2020 11:59:25 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBALMA'
27/05/2020 11:59:26 | getDevise() : Code ISO 'EUR'
27/05/2020 11:59:29 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 11:59:29 | getDevise() : Devise trouvé!
27/05/2020 11:59:29 : ORDHD1 trouvé.

27/05/2020 11:59:29 : ORDLIN trouvé.
27/05/2020 11:59:29 : ORDLIN line 1 / 4.
27/05/2020 11:59:29 : ORDLIN line 1 / 4.
27/05/2020 11:59:29 : ORDLIN line 1 / 4.
27/05/2020 11:59:29 | getArticle() : Code Article : 3760093543958
27/05/2020 11:59:29 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543958' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 11:59:30 | getArticle() : Article trouvé!
27/05/2020 11:59:30 | getConditionnementArticle() : Code Article : WILLY_TALL
27/05/2020 11:59:33 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='WILLY_TALL'
27/05/2020 11:59:33 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 11:59:33 : tab ===> line.article.Conditionnement
27/05/2020 11:59:33 | Calcule_conditionnement() : Qte '2,00', Qte conditionnement '4'
27/05/2020 11:59:33 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 2
27/05/2020 11:59:33 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 11:59:33 : ********************** Prix *********************
27/05/2020 11:59:33 : Prix trouvé dans le fichier EDI => 25,97 && Prix trouvé dans Sage => 25,800000

27/05/2020 11:59:33 : ********************** Warning Prix *********************
27/05/2020 11:59:33 : Prix de l'article WILLY_TALL(3760093543958) dans la base est : 25,800000
Il est différent du prix envoyer par le client : 25,97.
27/05/2020 11:59:33 : Utilise le prix de la base : 25,800000.

27/05/2020 11:59:33 : ORDLIN line 1 / 4.
27/05/2020 11:59:33 | getStockId() : Called!
27/05/2020 11:59:37 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 11:59:37 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 11:59:37 | getNumLivraison() : Client Numéro => 01LMBALMA
27/05/2020 11:59:40 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBALMA' and li_principal=1
27/05/2020 11:59:40 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 11:59:41 | insertOrder() : Récupére tous les tva
27/05/2020 11:59:41 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 11:59:41 | insertCommande() : Called!
27/05/2020 11:59:44 : insertCommande() | called!
27/05/2020 11:59:44 : insertCommande() | Requette pour Batimex.
27/05/2020 11:59:44 : insertCommande() | ODBC.
27/05/2020 11:59:44 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBALMA',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202725','/80280752',21,2,1,'01LMBALMA',11,0,1,1,0,855,1,'3025940011000;3779000001461','80280752',20,0,0)
27/05/2020 11:59:44 : insertCommande() | called!
27/05/2020 11:59:44 : insertCommande() | Requette pour Batimex.
27/05/2020 11:59:44 : insertCommande() | ODBC.
27/05/2020 11:59:46 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article WILLY_TALL
27/05/2020 11:59:46 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='WILLY_TALL' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 11:59:46 | insertOrder() : List des TVA trouvé
27/05/2020 11:59:46 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 11:59:46 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 11:59:46 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 11:59:46 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 11:59:46 | insertOrder() : TVA 1 => 20.000000
27/05/2020 11:59:46 | insertOrder() : TVA 2 => 0.170000
27/05/2020 11:59:46 | insertOrder() : TVA 3 => 0.000000
27/05/2020 11:59:46 | insertOrder() : Prix HT => 25,8 | TVA => 20,17 % | Prix TTC => 31,00386
27/05/2020 11:59:46 | insertOrder() : Prix TTC créé


27/05/2020 11:59:46 | insertOrder() : DL_MontantHT : 51.6 = DL_PrixUnitaire : 25.800000 X DL_QteBC : 2.00
27/05/2020 11:59:46 | insertOrder() : DL_MontantTTC : 62.00772 = DL_PUTTC : 31.00386 X DL_QteBC : 2.00
27/05/2020 11:59:46 | insertCommandeLine() : Called!
27/05/2020 11:59:46 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','WILLY_TALL','01LMBALMA',7, 'LLY TALL NOIR BATIMEX',1,25.800000,2.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202725',1,0,0,'', NULL,'80280752',3600000.00,3600000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.00386, 'BC202725', '', 0.000000, 2.00, 2.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 51.6, 62.00772)
27/05/2020 11:59:46 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 11:59:46 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 11:59:46 | insertOrder() : Additionner le total HT (25.800000) et TTC (31.00386)

27/05/2020 11:59:46 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 11:59:46 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'WILLY_TALL' and DE_No = 1
27/05/2020 11:59:46 | insertOrder() : Aucune reponse.

27/05/2020 11:59:46 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80280752
27/05/2020 11:59:46 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 25.8 WHERE DO_PIECE = 'BC202725' 


27/05/2020 11:59:47 : 1/1 ligne(s) enregistrée(s).


27/05/2020 11:59:47 : Le fichier 'E:\EDI\EDI_ORDERS.80280752.773950.BATIMEX.3025940011000.20200527.202005270122.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020115947__80280752__EDI_ORDERS.80280752.773950.BATIMEX.3025940011000.20200527.202005270122.RECU.IN.csv



27/05/2020 11:59:47 : -----> Fichier 23/31 : EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv
27/05/2020 11:59:47 : Scan fichier...
27/05/2020 11:59:47 : Import Commande Manuel.
27/05/2020 11:59:50 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 11:59:54 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80339802'
27/05/2020 11:59:55 : ********************** Erreur *********************
27/05/2020 11:59:55 : La commande N° 80339802 existe deja dans la base.
N° de pièce : BL012935.
27/05/2020 11:59:55 : Import annulée

27/05/2020 11:59:55 : ********************** Fichier *********************
27/05/2020 11:59:55 : Import annulée
27/05/2020 11:59:55 : Le fichier 'E:\EDI\EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020115955____EDI_ORDERS.80339802.771420.BATIMEX.3025940013000.20200526.202005261018.RECU.IN.csv

27/05/2020 11:59:55 : -----> Fichier 24/31 : EDI_ORDERS.81021138.773946.BATIMEX.3025940000500.20200527.202005270122.RECU.IN.csv
27/05/2020 11:59:55 : Scan fichier...
27/05/2020 11:59:55 : Import Commande Manuel.
27/05/2020 11:59:59 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:00:03 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='81021138'
27/05/2020 12:01:07 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940000500' and CT_Type=0
27/05/2020 12:01:13 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940000500' and CT_Type=0
27/05/2020 12:01:16 | existeFourniseur() : id '3779000001461'
27/05/2020 12:01:20 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 12:01:20 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 12:01:21 | get_adresse_livraison() : Called1
27/05/2020 12:01:24 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMCHANTEPIE'
27/05/2020 12:01:25 | getDevise() : Code ISO 'EUR'
27/05/2020 12:01:28 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 12:01:28 | getDevise() : Devise trouvé!
27/05/2020 12:01:29 : ORDHD1 trouvé.

27/05/2020 12:01:29 : ORDLIN trouvé.
27/05/2020 12:01:29 : ORDLIN line 1 / 4.
27/05/2020 12:01:29 : ORDLIN line 1 / 4.
27/05/2020 12:01:29 : ORDLIN line 1 / 4.
27/05/2020 12:01:29 | getArticle() : Code Article : 3760119734292
27/05/2020 12:01:29 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119734292' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 12:01:29 | getArticle() : Article trouvé!
27/05/2020 12:01:29 | getConditionnementArticle() : Code Article : PBB-1560
27/05/2020 12:01:32 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='PBB-1560'
27/05/2020 12:01:32 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 12:01:33 : tab ===> line.article.Conditionnement
27/05/2020 12:01:33 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 12:01:33 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 12:01:33 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 12:01:33 : ********************** Prix *********************
27/05/2020 12:01:33 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 12:01:33 : ********************** Warning Prix *********************
27/05/2020 12:01:33 : Prix de l'article PBB-1560(3760119734292) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 12:01:33 : Utilise le prix de la base : 19,500000.

27/05/2020 12:01:33 : ORDLIN line 1 / 4.
27/05/2020 12:01:33 | getStockId() : Called!
27/05/2020 12:01:36 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 12:01:36 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 12:01:37 | getNumLivraison() : Client Numéro => 01LMCHANTEPIE
27/05/2020 12:01:40 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMCHANTEPIE' and li_principal=1
27/05/2020 12:01:40 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 12:01:41 | insertOrder() : Récupére tous les tva
27/05/2020 12:01:41 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 12:01:41 | insertCommande() : Called!
27/05/2020 12:01:44 : insertCommande() | called!
27/05/2020 12:01:44 : insertCommande() | Requette pour Batimex.
27/05/2020 12:01:44 : insertCommande() | ODBC.
27/05/2020 12:01:44 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMCHANTEPIE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-10'},0,0,1,0,1,1,'BC202726','/81021138',21,2,1,'01LMCHANTEPIE',11,0,1,1,0,400,1,'3025940000500;3779000001461','81021138',20,0,0)
27/05/2020 12:01:44 : insertCommande() | called!
27/05/2020 12:01:44 : insertCommande() | Requette pour Batimex.
27/05/2020 12:01:44 : insertCommande() | ODBC.
27/05/2020 12:01:46 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article PBB-1560
27/05/2020 12:01:46 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='PBB-1560' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 12:01:46 | insertOrder() : List des TVA trouvé
27/05/2020 12:01:46 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 12:01:46 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 12:01:46 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 12:01:46 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 12:01:46 | insertOrder() : TVA 1 => 20.000000
27/05/2020 12:01:46 | insertOrder() : TVA 2 => 0.170000
27/05/2020 12:01:46 | insertOrder() : TVA 3 => 0.000000
27/05/2020 12:01:46 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 12:01:46 | insertOrder() : Prix TTC créé


27/05/2020 12:01:46 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 12:01:46 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 12:01:46 | insertCommandeLine() : Called!
27/05/2020 12:01:46 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','PBB-1560','01LMCHANTEPIE',7, 'BALADEUSE MULTICOLOR LIBERTY LUMISK',1,19.500000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-10'},0,'BC202726',1,0,0,'', NULL,'81021138',3000000.00,3000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202726', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 12:01:47 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 12:01:47 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 12:01:47 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 12:01:47 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 12:01:47 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'PBB-1560' and DE_No = 1
27/05/2020 12:01:47 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (80,000000), AS_StockMontant (0,000000).

27/05/2020 12:01:47 | insertOrder() : new_AS_StockReel: 0
27/05/2020 12:01:47 | insertOrder() : new_AS_StockReserve: 84 = AS_StockReserve: 80 + Quantite: 4
27/05/2020 12:01:47 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 19,5
27/05/2020 12:01:47 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 12:01:47 | insertOrder() : update article LIBERTY C25 BALADEUSE LUMINEUSE RECHARGEABLE (Ref:PBB-1560) stock in F_ARTSTOCK table in the database
27/05/2020 12:01:47 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 84, AS_MontSto = 0 WHERE AR_Ref = 'PBB-1560' and DE_No = 1

27/05/2020 12:01:47 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 81021138
27/05/2020 12:01:47 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 19.5 WHERE DO_PIECE = 'BC202726' 


27/05/2020 12:01:47 : 1/1 ligne(s) enregistrée(s).


27/05/2020 12:01:47 : Le fichier 'E:\EDI\EDI_ORDERS.81021138.773946.BATIMEX.3025940000500.20200527.202005270122.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020120147__81021138__EDI_ORDERS.81021138.773946.BATIMEX.3025940000500.20200527.202005270122.RECU.IN.csv



27/05/2020 12:01:47 : -----> Fichier 25/31 : EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv
27/05/2020 12:01:47 : Scan fichier...
27/05/2020 12:01:47 : Import Commande Manuel.
27/05/2020 12:01:51 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:01:55 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='81877187'
27/05/2020 12:01:56 : ********************** Erreur *********************
27/05/2020 12:01:56 : La commande N° 81877187 existe deja dans la base.
N° de pièce : BP202464.
27/05/2020 12:01:56 : Import annulée

27/05/2020 12:01:56 : ********************** Fichier *********************
27/05/2020 12:01:56 : Import annulée
27/05/2020 12:01:56 : Le fichier 'E:\EDI\EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020120156____EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv

27/05/2020 12:01:56 : -----> Fichier 26/31 : EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv
27/05/2020 12:01:56 : Scan fichier...
27/05/2020 12:01:56 : Import Commande Manuel.
27/05/2020 12:02:00 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:02:04 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='81877191'
27/05/2020 12:02:05 : ********************** Erreur *********************
27/05/2020 12:02:05 : La commande N° 81877191 existe deja dans la base.
N° de pièce : BP202463.
27/05/2020 12:02:05 : Import annulée

27/05/2020 12:02:05 : ********************** Fichier *********************
27/05/2020 12:02:05 : Import annulée
27/05/2020 12:02:05 : Le fichier 'E:\EDI\EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020120205____EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv

27/05/2020 12:02:05 : -----> Fichier 27/31 : EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv
27/05/2020 12:02:05 : Scan fichier...
27/05/2020 12:02:05 : Import Commande Manuel.
27/05/2020 12:02:09 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:02:13 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='83953968'
27/05/2020 12:02:15 : ********************** Erreur *********************
27/05/2020 12:02:15 : La commande N° 83953968 existe deja dans la base.
N° de pièce : BP202455.
27/05/2020 12:02:15 : Import annulée

27/05/2020 12:02:15 : ********************** Fichier *********************
27/05/2020 12:02:15 : Import annulée
27/05/2020 12:02:15 : Le fichier 'E:\EDI\EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020120215____EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv

27/05/2020 12:02:15 : -----> Fichier 28/31 : EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv
27/05/2020 12:02:15 : Scan fichier...
27/05/2020 12:02:15 : Import Commande Manuel.
27/05/2020 12:02:18 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:02:22 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='86923464'
27/05/2020 12:02:24 : ********************** Erreur *********************
27/05/2020 12:02:24 : La commande N° 86923464 existe deja dans la base.
N° de pièce : BP202454.
27/05/2020 12:02:24 : Import annulée

27/05/2020 12:02:24 : ********************** Fichier *********************
27/05/2020 12:02:24 : Import annulée
27/05/2020 12:02:24 : Le fichier 'E:\EDI\EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020120224____EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv

27/05/2020 12:02:24 : -----> Fichier 29/31 : EDI_ORDERS.87197168.773966.BATIMEX.3025940006900.20200527.202005270123.RECU.IN.csv
27/05/2020 12:02:24 : Scan fichier...
27/05/2020 12:02:24 : Import Commande Manuel.
27/05/2020 12:02:27 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:02:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='87197168'
27/05/2020 12:03:32 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006900' and CT_Type=0
27/05/2020 12:03:39 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006900' and CT_Type=0
27/05/2020 12:03:42 | existeFourniseur() : id '3779000001461'
27/05/2020 12:03:45 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 12:03:46 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 12:03:46 | get_adresse_livraison() : Called1
27/05/2020 12:03:50 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMAMIENS'
27/05/2020 12:03:51 | getDevise() : Code ISO 'EUR'
27/05/2020 12:03:54 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 12:03:54 | getDevise() : Devise trouvé!
27/05/2020 12:03:55 : ORDHD1 trouvé.

27/05/2020 12:03:55 : ORDLIN trouvé.
27/05/2020 12:03:55 : ORDLIN line 1 / 4.
27/05/2020 12:03:55 : ORDLIN line 1 / 4.
27/05/2020 12:03:55 : ORDLIN line 1 / 4.
27/05/2020 12:03:55 | getArticle() : Code Article : 3760093542906
27/05/2020 12:03:55 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 12:03:55 | getArticle() : Article trouvé!
27/05/2020 12:03:55 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 12:03:59 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 12:03:59 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 12:03:59 : tab ===> line.article.Conditionnement
27/05/2020 12:03:59 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 12:03:59 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 12:03:59 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 12:03:59 : ********************** Prix *********************
27/05/2020 12:03:59 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 12:03:59 : ********************** Warning Prix *********************
27/05/2020 12:03:59 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 12:03:59 : Utilise le prix de la base : 21,900000.

27/05/2020 12:03:59 : ORDLIN line 1 / 4.
27/05/2020 12:03:59 | getStockId() : Called!
27/05/2020 12:04:03 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 12:04:03 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 12:04:03 | getNumLivraison() : Client Numéro => 01LMAMIENS
27/05/2020 12:04:07 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMAMIENS' and li_principal=1
27/05/2020 12:04:07 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 12:04:08 | insertOrder() : Récupére tous les tva
27/05/2020 12:04:08 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 12:04:08 | insertCommande() : Called!
27/05/2020 12:04:11 : insertCommande() | called!
27/05/2020 12:04:11 : insertCommande() | Requette pour Batimex.
27/05/2020 12:04:11 : insertCommande() | ODBC.
27/05/2020 12:04:11 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMAMIENS',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-09'},0,0,1,0,1,1,'BC202727','/87197168',21,2,1,'01LMAMIENS',11,0,1,1,0,213,1,'3025940006900;3779000001461','87197168',20,0,0)
27/05/2020 12:04:11 : insertCommande() | called!
27/05/2020 12:04:11 : insertCommande() | Requette pour Batimex.
27/05/2020 12:04:11 : insertCommande() | ODBC.
27/05/2020 12:04:13 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 12:04:13 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 12:04:13 | insertOrder() : List des TVA trouvé
27/05/2020 12:04:13 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 12:04:13 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 12:04:13 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 12:04:13 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 12:04:13 | insertOrder() : TVA 1 => 20.000000
27/05/2020 12:04:13 | insertOrder() : TVA 2 => 0.170000
27/05/2020 12:04:13 | insertOrder() : TVA 3 => 0.000000
27/05/2020 12:04:13 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 12:04:13 | insertOrder() : Prix TTC créé


27/05/2020 12:04:13 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 12:04:13 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 12:04:13 | insertCommandeLine() : Called!
27/05/2020 12:04:13 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMAMIENS',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-09'},0,'BC202727',1,0,0,'', NULL,'87197168',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202727', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 12:04:14 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 12:04:14 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 12:04:14 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 12:04:14 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 12:04:14 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 12:04:14 | insertOrder() : Aucune reponse.

27/05/2020 12:04:14 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 87197168
27/05/2020 12:04:14 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 21.9 WHERE DO_PIECE = 'BC202727' 


27/05/2020 12:04:14 : 1/1 ligne(s) enregistrée(s).


27/05/2020 12:04:14 : Le fichier 'E:\EDI\EDI_ORDERS.87197168.773966.BATIMEX.3025940006900.20200527.202005270123.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020120414__87197168__EDI_ORDERS.87197168.773966.BATIMEX.3025940006900.20200527.202005270123.RECU.IN.csv



27/05/2020 12:04:14 : -----> Fichier 30/31 : EDI_ORDERS.87616004.773967.BATIMEX.3025940007100.20200527.202005270123.RECU.IN.csv
27/05/2020 12:04:14 : Scan fichier...
27/05/2020 12:04:14 : Import Commande Manuel.
27/05/2020 12:04:18 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 12:04:23 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='87616004'
27/05/2020 12:05:20 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940007100' and CT_Type=0
27/05/2020 12:05:28 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940007100' and CT_Type=0
27/05/2020 12:05:31 | existeFourniseur() : id '3779000001461'
27/05/2020 12:05:35 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 12:05:35 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 12:05:36 | get_adresse_livraison() : Called1
27/05/2020 12:05:39 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBAYONNE'
27/05/2020 12:05:40 | getDevise() : Code ISO 'EUR'
27/05/2020 12:05:44 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 12:05:44 | getDevise() : Devise trouvé!
27/05/2020 12:05:44 : ORDHD1 trouvé.

27/05/2020 12:05:44 : ORDLIN trouvé.
27/05/2020 12:05:44 : ORDLIN line 1 / 4.
27/05/2020 12:05:44 : ORDLIN line 1 / 4.
27/05/2020 12:05:44 : ORDLIN line 1 / 4.
27/05/2020 12:05:44 | getArticle() : Code Article : 3760093542906
27/05/2020 12:05:44 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 12:05:44 | getArticle() : Article trouvé!
27/05/2020 12:05:44 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 12:05:48 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 12:05:48 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 12:05:49 : tab ===> line.article.Conditionnement
27/05/2020 12:05:49 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 12:05:49 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 12:05:49 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 12:05:49 : ********************** Prix *********************
27/05/2020 12:05:49 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 12:05:49 : ********************** Warning Prix *********************
27/05/2020 12:05:49 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 12:05:49 : Utilise le prix de la base : 21,900000.

27/05/2020 12:05:49 : ORDLIN line 1 / 4.
27/05/2020 12:05:49 | getStockId() : Called!
27/05/2020 12:05:52 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 12:05:52 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 12:05:53 | getNumLivraison() : Client Numéro => 01LMBAYONNE
27/05/2020 12:05:57 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBAYONNE' and li_principal=1
27/05/2020 12:05:57 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 12:05:57 | insertOrder() : Récupére tous les tva
27/05/2020 12:05:57 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 12:05:57 | insertCommande() : Called!
27/05/2020 12:06:01 : insertCommande() | called!
27/05/2020 12:06:01 : insertCommande() | Requette pour Batimex.
27/05/2020 12:06:01 : insertCommande() | ODBC.
27/05/2020 12:06:01 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBAYONNE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202728','/87616004',21,2,1,'01LMBAYONNE',11,0,1,1,0,67,1,'3025940007100;3779000001461','87616004',20,0,0)
27/05/2020 12:06:01 : insertCommande() | called!
27/05/2020 12:06:01 : insertCommande() | Requette pour Batimex.
27/05/2020 12:06:01 : insertCommande() | ODBC.
27/05/2020 12:06:03 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 12:06:03 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 12:06:03 | insertOrder() : List des TVA trouvé
27/05/2020 12:06:03 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 12:06:03 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 12:06:03 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 12:06:03 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 12:06:03 | insertOrder() : TVA 1 => 20.000000
27/05/2020 12:06:03 | insertOrder() : TVA 2 => 0.170000
27/05/2020 12:06:03 | insertOrder() : TVA 3 => 0.000000
27/05/2020 12:06:03 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 12:06:03 | insertOrder() : Prix TTC créé


27/05/2020 12:06:03 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 12:06:03 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 12:06:03 | insertCommandeLine() : Called!
27/05/2020 12:06:03 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMBAYONNE',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202728',1,0,0,'', NULL,'87616004',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202728', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 12:06:03 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 12:06:03 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 12:06:03 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 12:06:03 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 12:06:03 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 12:06:03 | insertOrder() : Aucune reponse.

27/05/2020 12:06:03 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 87616004
27/05/2020 12:06:03 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 21.9 WHERE DO_PIECE = 'BC202728' 


27/05/2020 12:06:04 : 1/1 ligne(s) enregistrée(s).


27/05/2020 12:06:04 : Le fichier 'E:\EDI\EDI_ORDERS.87616004.773967.BATIMEX.3025940007100.20200527.202005270123.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020120604__87616004__EDI_ORDERS.87616004.773967.BATIMEX.3025940007100.20200527.202005270123.RECU.IN.csv



