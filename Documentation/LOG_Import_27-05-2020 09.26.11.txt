##############################################################################################################################
#################################################### L'import planifier ######################################################
##### Version 1.12.11 ############################################################################################ Jdevs #####

27/05/2020 09:26:11 : -----> Fichier 0/21 : EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv
27/05/2020 09:26:11 : Scan fichier...
27/05/2020 09:26:11 : Import Commande Manuel.
27/05/2020 09:26:15 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 09:26:17 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='014800661'
27/05/2020 09:26:17 : ********************** Erreur *********************
27/05/2020 09:26:17 : La commande N° 014800661 existe deja dans la base.
N° de pièce : BC202699.
27/05/2020 09:26:17 : Import annulée

27/05/2020 09:26:17 : ********************** Fichier *********************
27/05/2020 09:26:17 : Import annulée
27/05/2020 09:26:17 : Le fichier 'E:\EDI\EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020092617____EDI_ORDERS.014800661.774906.BATIMEX.3025570003401.20200527.202005270846.RECU.IN.csv

27/05/2020 09:26:17 : -----> Fichier 1/21 : EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv
27/05/2020 09:26:17 : Scan fichier...
27/05/2020 09:26:17 : Import Commande Manuel.
27/05/2020 09:26:19 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 09:26:21 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56027059'
27/05/2020 09:27:17 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940000600' and CT_Type=0
27/05/2020 09:27:22 | getClient() : Erreur[41] - GLN émetteur  3025940000600 n'existe pas dans la base sage.
27/05/2020 09:27:22 : ********************** Erreur *********************
27/05/2020 09:27:22 : Client trouvé est null, verifier le code client.
27/05/2020 09:27:22 : Import annulée

27/05/2020 09:27:22 : ********************** Fichier *********************
27/05/2020 09:27:22 : Import annulée
27/05/2020 09:27:22 : Le fichier 'E:\EDI\EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020092722__56027059__EDI_ORDERS.56027059.774011.BATIMEX.3025940000600.20200527.202005270126.RECU.IN.csv

27/05/2020 09:27:22 : -----> Fichier 2/21 : EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv
27/05/2020 09:27:22 : Scan fichier...
27/05/2020 09:27:22 : Import Commande Manuel.
27/05/2020 09:27:24 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 09:27:26 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56027571'
27/05/2020 09:28:27 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001400' and CT_Type=0
27/05/2020 09:28:32 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001400' and CT_Type=0
27/05/2020 09:28:34 | existeFourniseur() : id '3779000001461'
27/05/2020 09:28:36 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 09:28:37 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 09:28:37 | get_adresse_livraison() : Called1
27/05/2020 09:28:39 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMSENTINELLE'
27/05/2020 09:28:39 | getDevise() : Code ISO 'EUR'
27/05/2020 09:28:41 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 09:28:41 | getDevise() : Devise trouvé!
27/05/2020 09:28:41 : ORDHD1 trouvé.

27/05/2020 09:28:41 : ORDLIN trouvé.
27/05/2020 09:28:41 : ORDLIN line 1 / 7.
27/05/2020 09:28:41 : ORDLIN line 1 / 7.
27/05/2020 09:28:41 : ORDLIN line 1 / 7.
27/05/2020 09:28:41 | getArticle() : Code Article : 3760119730485
27/05/2020 09:28:41 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730485' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:28:41 | getArticle() : Article trouvé!
27/05/2020 09:28:41 | getConditionnementArticle() : Code Article : G22/10
27/05/2020 09:28:43 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='G22/10'
27/05/2020 09:28:43 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:28:43 : tab ===> line.article.Conditionnement
27/05/2020 09:28:43 | Calcule_conditionnement() : Qte '2,00', Qte conditionnement '2'
27/05/2020 09:28:43 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 09:28:43 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 09:28:43 : ********************** Prix *********************
27/05/2020 09:28:43 : Prix trouvé dans le fichier EDI => 60,28 && Prix trouvé dans Sage => 59,900000

27/05/2020 09:28:43 : ********************** Warning Prix *********************
27/05/2020 09:28:43 : Prix de l'article G22/10(3760119730485) dans la base est : 59,900000
Il est différent du prix envoyer par le client : 60,28.
27/05/2020 09:28:43 : Utilise le prix de la base : 59,900000.

27/05/2020 09:28:43 : ORDLIN line 1 / 7.
27/05/2020 09:28:43 | getArticle() : Code Article : 3760119739556
27/05/2020 09:28:43 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739556' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:28:43 | getArticle() : Article trouvé!
27/05/2020 09:28:43 | getConditionnementArticle() : Code Article : MINI_MAY_PLAY
27/05/2020 09:28:46 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MINI_MAY_PLAY'
27/05/2020 09:28:46 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:28:46 : tab ===> line.article.Conditionnement
27/05/2020 09:28:46 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '6'
27/05/2020 09:28:46 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 2
27/05/2020 09:28:46 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 1

27/05/2020 09:28:46 : ********************** Prix *********************
27/05/2020 09:28:46 : Prix trouvé dans le fichier EDI => 23,67 && Prix trouvé dans Sage => 23,500000

27/05/2020 09:28:46 : ********************** Warning Prix *********************
27/05/2020 09:28:46 : Prix de l'article MINI_MAY_PLAY(3760119739556) dans la base est : 23,500000
Il est différent du prix envoyer par le client : 23,67.
27/05/2020 09:28:46 : Utilise le prix de la base : 23,500000.

27/05/2020 09:28:46 : ORDLIN line 1 / 7.
27/05/2020 09:28:46 | getArticle() : Code Article : 3760093542883
27/05/2020 09:28:46 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:28:46 | getArticle() : Article trouvé!
27/05/2020 09:28:46 | getConditionnementArticle() : Code Article : COOPER
27/05/2020 09:28:48 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
27/05/2020 09:28:48 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:28:48 : tab ===> line.article.Conditionnement
27/05/2020 09:28:48 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 09:28:48 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 09:28:48 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 09:28:48 : ********************** Prix *********************
27/05/2020 09:28:48 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 09:28:48 : ********************** Warning Prix *********************
27/05/2020 09:28:48 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 09:28:48 : Utilise le prix de la base : 15,900000.

27/05/2020 09:28:48 : ORDLIN line 1 / 7.
27/05/2020 09:28:48 | getArticle() : Code Article : 3760093542906
27/05/2020 09:28:48 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:28:48 | getArticle() : Article trouvé!
27/05/2020 09:28:48 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 09:28:50 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 09:28:50 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:28:50 : tab ===> line.article.Conditionnement
27/05/2020 09:28:50 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 09:28:50 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 09:28:50 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 09:28:50 : ********************** Prix *********************
27/05/2020 09:28:50 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 09:28:50 : ********************** Warning Prix *********************
27/05/2020 09:28:50 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 09:28:50 : Utilise le prix de la base : 21,900000.

27/05/2020 09:28:50 : ORDLIN line 1 / 7.
27/05/2020 09:28:50 | getStockId() : Called!
27/05/2020 09:28:52 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 09:28:52 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 09:28:52 | getNumLivraison() : Client Numéro => 01LMSENTINELLE
27/05/2020 09:28:54 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMSENTINELLE' and li_principal=1
27/05/2020 09:28:54 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 09:28:54 | insertOrder() : Récupére tous les tva
27/05/2020 09:28:54 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 09:28:54 | insertCommande() : Called!
27/05/2020 09:28:57 : insertCommande() | called!
27/05/2020 09:28:57 : insertCommande() | Requette pour Batimex.
27/05/2020 09:28:57 : insertCommande() | ODBC.
27/05/2020 09:28:57 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMSENTINELLE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202701','/56027571',21,2,1,'01LMSENTINELLE',11,0,1,1,0,50,1,'3025940001400;3779000001461','56027571',20,0,0)
27/05/2020 09:28:57 : insertCommande() | called!
27/05/2020 09:28:57 : insertCommande() | Requette pour Batimex.
27/05/2020 09:28:57 : insertCommande() | ODBC.
27/05/2020 09:28:57 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article G22/10
27/05/2020 09:28:57 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='G22/10' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO38 || DL_CodeTaxe3 : 


27/05/2020 09:28:57 | insertOrder() : List des TVA trouvé
27/05/2020 09:28:57 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 09:28:57 | insertOrder() : TVA 2 ECO38 trouvé "0,380000"
27/05/2020 09:28:57 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 09:28:57 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 09:28:57 | insertOrder() : TVA 1 => 20.000000
27/05/2020 09:28:57 | insertOrder() : TVA 2 => 0.380000
27/05/2020 09:28:57 | insertOrder() : TVA 3 => 0.000000
27/05/2020 09:28:57 | insertOrder() : Prix HT => 59,9 | TVA => 20,38 % | Prix TTC => 72,10762
27/05/2020 09:28:57 | insertOrder() : Prix TTC créé


27/05/2020 09:28:57 | insertOrder() : DL_MontantHT : 119.8 = DL_PrixUnitaire : 59.900000 X DL_QteBC : 2.00
27/05/2020 09:28:57 | insertOrder() : DL_MontantTTC : 144.21524 = DL_PUTTC : 72.10762 X DL_QteBC : 2.00
27/05/2020 09:28:57 | insertCommandeLine() : Called!
27/05/2020 09:28:57 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','G22/10','01LMSENTINELLE',7, 'GUIRLANDE EXT 10M CHERRY LIGHT LUMI',1,59.900000,2.00,'Carton de 2',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202701',1,0,0,'', NULL,'56027571',8800000.00,8800000.00,'V20', 20.000000,0,0, 'ECO38',0.380000,2,2,72.10762, 'BC202701', '', 0.000000, 2.00, 2.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 119.8, 144.21524)
27/05/2020 09:28:58 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 09:28:58 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 09:28:58 | insertOrder() : Additionner le total HT (59.900000) et TTC (72.10762)

27/05/2020 09:28:58 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 09:28:58 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'G22/10' and DE_No = 1
27/05/2020 09:28:58 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (0,000000), AS_StockMontant (-2735,190000).

27/05/2020 09:28:58 | insertOrder() : new_AS_StockReel: 0
27/05/2020 09:28:58 | insertOrder() : new_AS_StockReserve: 2 = AS_StockReserve: 0 + Quantite: 2
27/05/2020 09:28:58 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 59,9
27/05/2020 09:28:58 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 09:28:58 | insertOrder() : update article CHERRY W10 GUIRLANDE BLANCHE SECTEUR 10 M (Ref:G22/10) stock in F_ARTSTOCK table in the database
27/05/2020 09:28:58 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 2, AS_MontSto = 0 WHERE AR_Ref = 'G22/10' and DE_No = 1

Récupérer les TVA des l'article MINI_MAY_PLAY
27/05/2020 09:28:58 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MINI_MAY_PLAY' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 09:28:58 | insertOrder() : List des TVA trouvé
27/05/2020 09:28:58 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 09:28:58 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 09:28:58 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 09:28:58 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 09:28:58 | insertOrder() : TVA 1 => 20.000000
27/05/2020 09:28:58 | insertOrder() : TVA 2 => 0.170000
27/05/2020 09:28:58 | insertOrder() : TVA 3 => 0.000000
27/05/2020 09:28:58 | insertOrder() : Prix HT => 23,5 | TVA => 20,17 % | Prix TTC => 28,23995
27/05/2020 09:28:58 | insertOrder() : Prix TTC créé


27/05/2020 09:28:58 | insertOrder() : DL_MontantHT : 188 = DL_PrixUnitaire : 23.500000 X DL_QteBC : 8.00
27/05/2020 09:28:58 | insertOrder() : DL_MontantTTC : 225.9196 = DL_PUTTC : 28.23995 X DL_QteBC : 8.00
27/05/2020 09:28:58 | insertCommandeLine() : Called!
27/05/2020 09:28:58 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MINI_MAY_PLAY','01LMSENTINELLE',7, 'BALADEUSE MUSICALE MINI MAY PLAY LU',2,23.500000,8.00,'Carton de 6',2,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202701',1,0,0,'', NULL,'56027571',6400000.00,6400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,28.23995, 'BC202701', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 188, 225.9196)
27/05/2020 09:28:58 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 09:28:58 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 09:28:58 | insertOrder() : Additionner le total HT (23.500000) et TTC (28.23995)

27/05/2020 09:28:58 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 09:28:58 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MINI_MAY_PLAY' and DE_No = 1
27/05/2020 09:28:58 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article COOPER
27/05/2020 09:28:58 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 09:28:58 | insertOrder() : List des TVA trouvé
27/05/2020 09:28:58 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 09:28:58 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 09:28:58 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 09:28:58 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 09:28:58 | insertOrder() : TVA 1 => 20.000000
27/05/2020 09:28:58 | insertOrder() : TVA 2 => 0.170000
27/05/2020 09:28:58 | insertOrder() : TVA 3 => 0.000000
27/05/2020 09:28:58 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 09:28:58 | insertOrder() : Prix TTC créé


27/05/2020 09:28:58 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
27/05/2020 09:28:58 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
27/05/2020 09:28:58 | insertCommandeLine() : Called!
27/05/2020 09:28:58 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMSENTINELLE',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',3,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202701',1,0,0,'', NULL,'56027571',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202701', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
27/05/2020 09:28:58 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 09:28:58 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 09:28:58 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 09:28:58 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 09:28:58 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
27/05/2020 09:28:58 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
27/05/2020 09:28:58 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 09:28:58 | insertOrder() : List des TVA trouvé
27/05/2020 09:28:58 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 09:28:58 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 09:28:58 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 09:28:58 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 09:28:58 | insertOrder() : TVA 1 => 20.000000
27/05/2020 09:28:58 | insertOrder() : TVA 2 => 0.170000
27/05/2020 09:28:58 | insertOrder() : TVA 3 => 0.000000
27/05/2020 09:28:58 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 09:28:58 | insertOrder() : Prix TTC créé


27/05/2020 09:28:58 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 09:28:58 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 09:28:58 | insertCommandeLine() : Called!
27/05/2020 09:28:58 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMSENTINELLE',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',4,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202701',1,0,0,'', NULL,'56027571',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202701', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 09:28:58 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 09:28:58 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 09:28:58 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 09:28:58 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 09:28:58 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 09:28:58 | insertOrder() : Aucune reponse.

27/05/2020 09:28:58 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56027571
27/05/2020 09:28:58 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 121.2 WHERE DO_PIECE = 'BC202701' 


27/05/2020 09:28:58 : 4/4 ligne(s) enregistrée(s).


27/05/2020 09:28:58 : Le fichier 'E:\EDI\EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020092858__56027571__EDI_ORDERS.56027571.774017.BATIMEX.3025940001400.20200527.202005270126.RECU.IN.csv



27/05/2020 09:28:58 : -----> Fichier 3/21 : EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv
27/05/2020 09:28:58 : Scan fichier...
27/05/2020 09:28:58 : Import Commande Manuel.
27/05/2020 09:29:01 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 09:29:03 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56029584'
27/05/2020 09:29:51 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940004600' and CT_Type=0
27/05/2020 09:29:56 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940004600' and CT_Type=0
27/05/2020 09:29:59 | existeFourniseur() : id '3779000001461'
27/05/2020 09:30:01 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 09:30:01 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 09:30:01 | get_adresse_livraison() : Called1
27/05/2020 09:30:03 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMLANGUEUX'
27/05/2020 09:30:04 | getDevise() : Code ISO 'EUR'
27/05/2020 09:30:06 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 09:30:06 | getDevise() : Devise trouvé!
27/05/2020 09:30:06 : ORDHD1 trouvé.

27/05/2020 09:30:06 : ORDLIN trouvé.
27/05/2020 09:30:06 : ORDLIN line 1 / 4.
27/05/2020 09:30:06 : ORDLIN line 1 / 4.
27/05/2020 09:30:06 : ORDLIN line 1 / 4.
27/05/2020 09:30:06 | getArticle() : Code Article : 3760093542906
27/05/2020 09:30:06 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:30:06 | getArticle() : Article trouvé!
27/05/2020 09:30:06 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 09:30:08 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 09:30:08 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:30:08 : tab ===> line.article.Conditionnement
27/05/2020 09:30:08 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 09:30:08 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 09:30:08 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 09:30:08 : ********************** Prix *********************
27/05/2020 09:30:08 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 09:30:08 : ********************** Warning Prix *********************
27/05/2020 09:30:08 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 09:30:08 : Utilise le prix de la base : 21,900000.

27/05/2020 09:30:08 : ORDLIN line 1 / 4.
27/05/2020 09:30:08 | getStockId() : Called!
27/05/2020 09:30:11 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 09:30:11 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 09:30:11 | getNumLivraison() : Client Numéro => 01LMLANGUEUX
27/05/2020 09:30:13 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMLANGUEUX' and li_principal=1
27/05/2020 09:30:13 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 09:30:13 | insertOrder() : Récupére tous les tva
27/05/2020 09:30:13 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 09:30:13 | insertCommande() : Called!
27/05/2020 09:30:15 : insertCommande() | called!
27/05/2020 09:30:15 : insertCommande() | Requette pour Batimex.
27/05/2020 09:30:15 : insertCommande() | ODBC.
27/05/2020 09:30:15 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMLANGUEUX',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202702','/56029584',21,2,1,'01LMLANGUEUX',11,0,1,1,0,610,1,'3025940004600;3779000001461','56029584',20,0,0)
27/05/2020 09:30:15 : insertCommande() | called!
27/05/2020 09:30:15 : insertCommande() | Requette pour Batimex.
27/05/2020 09:30:15 : insertCommande() | ODBC.
27/05/2020 09:30:16 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 09:30:16 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 09:30:16 | insertOrder() : List des TVA trouvé
27/05/2020 09:30:16 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 09:30:16 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 09:30:16 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 09:30:16 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 09:30:16 | insertOrder() : TVA 1 => 20.000000
27/05/2020 09:30:16 | insertOrder() : TVA 2 => 0.170000
27/05/2020 09:30:16 | insertOrder() : TVA 3 => 0.000000
27/05/2020 09:30:16 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 09:30:16 | insertOrder() : Prix TTC créé


27/05/2020 09:30:16 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 09:30:16 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 09:30:16 | insertCommandeLine() : Called!
27/05/2020 09:30:16 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMLANGUEUX',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202702',1,0,0,'', NULL,'56029584',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202702', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 09:30:16 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 09:30:16 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 09:30:16 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 09:30:16 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 09:30:16 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 09:30:16 | insertOrder() : Aucune reponse.

27/05/2020 09:30:16 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56029584
27/05/2020 09:30:16 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 21.9 WHERE DO_PIECE = 'BC202702' 


27/05/2020 09:30:16 : 1/1 ligne(s) enregistrée(s).


27/05/2020 09:30:16 : Le fichier 'E:\EDI\EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020093016__56029584__EDI_ORDERS.56029584.773987.BATIMEX.3025940004600.20200527.202005270124.RECU.IN.csv



27/05/2020 09:30:16 : -----> Fichier 4/21 : EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv
27/05/2020 09:30:16 : Scan fichier...
27/05/2020 09:30:16 : Import Commande Manuel.
27/05/2020 09:30:18 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 09:30:21 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56030562'
27/05/2020 09:31:10 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940005900' and CT_Type=0
27/05/2020 09:31:16 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940005900' and CT_Type=0
27/05/2020 09:31:19 | existeFourniseur() : id '3779000001461'
27/05/2020 09:31:21 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 09:31:21 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 09:31:21 | get_adresse_livraison() : Called1
27/05/2020 09:31:24 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMTOURS'
27/05/2020 09:31:24 | getDevise() : Code ISO 'EUR'
27/05/2020 09:31:26 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 09:31:26 | getDevise() : Devise trouvé!
27/05/2020 09:31:27 : ORDHD1 trouvé.

27/05/2020 09:31:27 : ORDLIN trouvé.
27/05/2020 09:31:27 : ORDLIN line 1 / 6.
27/05/2020 09:31:27 : ORDLIN line 1 / 6.
27/05/2020 09:31:27 : ORDLIN line 1 / 6.
27/05/2020 09:31:27 | getArticle() : Code Article : 3760093543187
27/05/2020 09:31:27 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 09:31:27 | getArticle() : Article trouvé!
27/05/2020 09:31:27 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
27/05/2020 09:31:29 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
27/05/2020 09:31:29 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 09:31:29 : tab ===> line.article.Conditionnement
27/05/2020 09:31:29 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '8'
27/05/2020 09:31:29 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 09:31:29 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 09:31:29 : ********************** Prix *********************
27/05/2020 09:31:29 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:07:19 : ********************** Warning Prix *********************
27/05/2020 10:07:19 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:07:19 : Utilise le prix de la base : 19,500000.

27/05/2020 10:07:19 : ORDLIN line 1 / 6.
27/05/2020 10:07:19 | getArticle() : Code Article : 3760093544504
27/05/2020 10:07:19 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093544504' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:07:19 | getArticle() : Article trouvé!
27/05/2020 10:07:19 | getConditionnementArticle() : Code Article : IBIZA_STANDY_MINI
27/05/2020 10:07:23 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='IBIZA_STANDY_MINI'
27/05/2020 10:07:23 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:07:23 : tab ===> line.article.Conditionnement
27/05/2020 10:07:23 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:07:23 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:07:23 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:07:23 : ********************** Prix *********************
27/05/2020 10:07:23 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 18,900000

27/05/2020 10:07:23 : ********************** Warning Prix *********************
27/05/2020 10:07:23 : Prix de l'article IBIZA_STANDY_MINI(3760093544504) dans la base est : 18,900000
Il est différent du prix envoyer par le client : 19,07.
27/05/2020 10:07:23 : Utilise le prix de la base : 18,900000.

27/05/2020 10:07:23 : ORDLIN line 1 / 6.
27/05/2020 10:07:23 | getArticle() : Code Article : 3760119731987
27/05/2020 10:07:23 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119731987' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:07:23 | getArticle() : Article trouvé!
27/05/2020 10:07:23 | getConditionnementArticle() : Code Article : STANDYMINI
27/05/2020 10:07:25 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='STANDYMINI'
27/05/2020 10:07:25 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:07:25 : tab ===> line.article.Conditionnement
27/05/2020 10:07:25 | Calcule_conditionnement() : Qte '12,00', Qte conditionnement '8'
27/05/2020 10:07:25 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 4
27/05/2020 10:07:25 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 1

27/05/2020 10:07:25 : ********************** Prix *********************
27/05/2020 10:07:25 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 18,900000

27/05/2020 10:07:25 : ********************** Warning Prix *********************
27/05/2020 10:07:25 : Prix de l'article STANDYMINI(3760119731987) dans la base est : 18,900000
Il est différent du prix envoyer par le client : 19,07.
27/05/2020 10:07:25 : Utilise le prix de la base : 18,900000.

27/05/2020 10:07:25 : ORDLIN line 1 / 6.
27/05/2020 10:07:25 | getStockId() : Called!
27/05/2020 10:07:27 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:07:27 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:07:27 | getNumLivraison() : Client Numéro => 01LMTOURS
27/05/2020 10:07:29 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMTOURS' and li_principal=1
27/05/2020 10:07:29 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:07:29 | insertOrder() : Récupére tous les tva
27/05/2020 10:07:29 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:07:29 | insertCommande() : Called!
27/05/2020 10:07:31 : insertCommande() | called!
27/05/2020 10:07:31 : insertCommande() | Requette pour Batimex.
27/05/2020 10:07:31 : insertCommande() | ODBC.
27/05/2020 10:07:31 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMTOURS',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202703','/56030562',21,2,1,'01LMTOURS',11,0,1,1,0,926,1,'3025940005900;3779000001461','56030562',20,0,0)
27/05/2020 10:07:31 : insertCommande() | called!
27/05/2020 10:07:31 : insertCommande() | Requette pour Batimex.
27/05/2020 10:07:31 : insertCommande() | ODBC.
27/05/2020 10:07:32 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
27/05/2020 10:07:32 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:07:32 | insertOrder() : List des TVA trouvé
27/05/2020 10:07:32 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:07:32 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:07:32 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:07:32 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:07:32 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:07:32 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:07:32 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:07:32 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:07:32 | insertOrder() : Prix TTC créé


27/05/2020 10:07:32 | insertOrder() : DL_MontantHT : 156 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 8.00
27/05/2020 10:07:32 | insertOrder() : DL_MontantTTC : 187.4652 = DL_PUTTC : 23.43315 X DL_QteBC : 8.00
27/05/2020 10:07:32 | insertCommandeLine() : Called!
27/05/2020 10:07:32 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMTOURS',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,8.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202703',1,0,0,'', NULL,'56030562',6880000.00,6880000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202703', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 156, 187.4652)
27/05/2020 10:07:33 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:07:33 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:07:33 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:07:33 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:07:33 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
27/05/2020 10:07:33 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article IBIZA_STANDY_MINI
27/05/2020 10:07:33 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='IBIZA_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:07:33 | insertOrder() : List des TVA trouvé
27/05/2020 10:07:33 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:07:33 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:07:33 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:07:33 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:07:33 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:07:33 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:07:33 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:07:33 | insertOrder() : Prix HT => 18,9 | TVA => 20,17 % | Prix TTC => 22,71213
27/05/2020 10:07:33 | insertOrder() : Prix TTC créé


27/05/2020 10:07:33 | insertOrder() : DL_MontantHT : 75.6 = DL_PrixUnitaire : 18.900000 X DL_QteBC : 4.00
27/05/2020 10:07:33 | insertOrder() : DL_MontantTTC : 90.84852 = DL_PUTTC : 22.71213 X DL_QteBC : 4.00
27/05/2020 10:07:33 | insertCommandeLine() : Called!
27/05/2020 10:07:33 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','IBIZA_STANDY_MINI','01LMTOURS',7, 'LAMPE EXTERIEURE IBIZA LUMISKY',2,18.900000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202703',1,0,0,'', NULL,'56030562',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.71213, 'BC202703', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 75.6, 90.84852)
27/05/2020 10:07:33 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:07:33 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:07:33 | insertOrder() : Additionner le total HT (18.900000) et TTC (22.71213)

27/05/2020 10:07:33 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:07:33 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'IBIZA_STANDY_MINI' and DE_No = 1
27/05/2020 10:07:33 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article STANDYMINI
27/05/2020 10:07:33 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='STANDYMINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:07:33 | insertOrder() : List des TVA trouvé
27/05/2020 10:07:33 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:07:33 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:07:33 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:07:33 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:07:33 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:07:33 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:07:33 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:07:33 | insertOrder() : Prix HT => 18,9 | TVA => 20,17 % | Prix TTC => 22,71213
27/05/2020 10:07:33 | insertOrder() : Prix TTC créé


27/05/2020 10:07:33 | insertOrder() : DL_MontantHT : 226.8 = DL_PrixUnitaire : 18.900000 X DL_QteBC : 12.00
27/05/2020 10:07:33 | insertOrder() : DL_MontantTTC : 272.54556 = DL_PUTTC : 22.71213 X DL_QteBC : 12.00
27/05/2020 10:07:33 | insertCommandeLine() : Called!
27/05/2020 10:07:33 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','STANDYMINI','01LMTOURS',7, 'LAMPE EXT STANDY MINI ANTHRACITE RO',3,18.900000,12.00,'Carton de 8',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202703',1,0,0,'', NULL,'56030562',0.00,9600000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.71213, 'BC202703', '', 0.000000, 12.00, 12.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 226.8, 272.54556)
27/05/2020 10:07:33 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:07:33 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:07:33 | insertOrder() : Additionner le total HT (18.900000) et TTC (22.71213)

27/05/2020 10:07:33 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:07:33 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'STANDYMINI' and DE_No = 1
27/05/2020 10:07:33 | insertOrder() : Aucune reponse.

27/05/2020 10:07:33 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56030562
27/05/2020 10:07:33 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 57.3 WHERE DO_PIECE = 'BC202703' 


27/05/2020 10:07:33 : 3/3 ligne(s) enregistrée(s).


27/05/2020 10:07:33 : Le fichier 'E:\EDI\EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020100733__56030562__EDI_ORDERS.56030562.774038.BATIMEX.3025940005900.20200527.202005270129.RECU.IN.csv



27/05/2020 10:07:33 : -----> Fichier 5/21 : EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv
27/05/2020 10:07:33 : Scan fichier...
27/05/2020 10:07:33 : Import Commande Manuel.
27/05/2020 10:07:36 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:07:39 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56031762'
27/05/2020 10:08:44 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940007600' and CT_Type=0
27/05/2020 10:08:48 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940007600' and CT_Type=0
27/05/2020 10:08:51 | existeFourniseur() : id '3779000001461'
27/05/2020 10:08:53 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:08:54 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:08:54 | get_adresse_livraison() : Called1
27/05/2020 10:08:56 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMMARGDLITTORAL'
27/05/2020 10:08:56 | getDevise() : Code ISO 'EUR'
27/05/2020 10:08:58 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:08:58 | getDevise() : Devise trouvé!
27/05/2020 10:08:58 : ORDHD1 trouvé.

27/05/2020 10:08:58 : ORDLIN trouvé.
27/05/2020 10:08:58 : ORDLIN line 1 / 4.
27/05/2020 10:08:58 : ORDLIN line 1 / 4.
27/05/2020 10:08:58 : ORDLIN line 1 / 4.
27/05/2020 10:08:58 | getArticle() : Code Article : 3760093542906
27/05/2020 10:08:58 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:08:58 | getArticle() : Article trouvé!
27/05/2020 10:08:58 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:09:00 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:09:00 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:09:00 : tab ===> line.article.Conditionnement
27/05/2020 10:09:00 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:09:00 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:09:00 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:09:00 : ********************** Prix *********************
27/05/2020 10:09:00 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:09:00 : ********************** Warning Prix *********************
27/05/2020 10:09:00 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:09:00 : Utilise le prix de la base : 21,900000.

27/05/2020 10:09:00 : ORDLIN line 1 / 4.
27/05/2020 10:09:00 | getStockId() : Called!
27/05/2020 10:09:02 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:09:02 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:09:02 | getNumLivraison() : Client Numéro => 01LMMARGDLITTORAL
27/05/2020 10:09:04 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMMARGDLITTORAL' and li_principal=1
27/05/2020 10:09:04 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:09:05 | insertOrder() : Récupére tous les tva
27/05/2020 10:09:05 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:09:05 | insertCommande() : Called!
27/05/2020 10:09:07 : insertCommande() | called!
27/05/2020 10:09:07 : insertCommande() | Requette pour Batimex.
27/05/2020 10:09:07 : insertCommande() | ODBC.
27/05/2020 10:09:07 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMMARGDLITTORAL',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202704','/56031762',21,2,1,'01LMMARGDLITTORAL',11,0,1,1,0,1083,1,'3025940007600;3779000001461','56031762',20,0,0)
27/05/2020 10:09:07 : insertCommande() | called!
27/05/2020 10:09:07 : insertCommande() | Requette pour Batimex.
27/05/2020 10:09:07 : insertCommande() | ODBC.
27/05/2020 10:09:07 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:09:07 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:09:07 | insertOrder() : List des TVA trouvé
27/05/2020 10:09:07 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:09:07 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:09:07 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:09:07 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:09:07 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:09:07 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:09:07 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:09:07 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:09:07 | insertOrder() : Prix TTC créé


27/05/2020 10:09:07 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 10:09:07 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 10:09:07 | insertCommandeLine() : Called!
27/05/2020 10:09:07 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMMARGDLITTORAL',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202704',1,0,0,'', NULL,'56031762',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202704', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 10:09:08 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:09:08 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:09:08 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:09:08 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:09:08 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:09:08 | insertOrder() : Aucune reponse.

27/05/2020 10:09:08 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56031762
27/05/2020 10:09:08 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 21.9 WHERE DO_PIECE = 'BC202704' 


27/05/2020 10:09:08 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:09:08 : Le fichier 'E:\EDI\EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020100908__56031762__EDI_ORDERS.56031762.774010.BATIMEX.3025940007600.20200527.202005270126.RECU.IN.csv



27/05/2020 10:09:08 : -----> Fichier 6/21 : EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv
27/05/2020 10:09:08 : Scan fichier...
27/05/2020 10:09:08 : Import Commande Manuel.
27/05/2020 10:09:10 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:09:12 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56034954'
27/05/2020 10:10:11 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940015400' and CT_Type=0
27/05/2020 10:10:16 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940015400' and CT_Type=0
27/05/2020 10:10:19 | existeFourniseur() : id '3779000001461'
27/05/2020 10:10:21 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:10:21 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:10:22 | get_adresse_livraison() : Called1
27/05/2020 10:10:23 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMVILLELAGRAND'
27/05/2020 10:10:23 | getDevise() : Code ISO 'EUR'
27/05/2020 10:10:26 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:10:26 | getDevise() : Devise trouvé!
27/05/2020 10:10:26 : ORDHD1 trouvé.

27/05/2020 10:10:26 : ORDLIN trouvé.
27/05/2020 10:10:26 : ORDLIN line 1 / 5.
27/05/2020 10:10:26 : ORDLIN line 1 / 5.
27/05/2020 10:10:26 : ORDLIN line 1 / 5.
27/05/2020 10:10:26 | getArticle() : Code Article : 3760119734292
27/05/2020 10:10:26 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119734292' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:10:26 | getArticle() : Article trouvé!
27/05/2020 10:10:26 | getConditionnementArticle() : Code Article : PBB-1560
27/05/2020 10:10:28 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='PBB-1560'
27/05/2020 10:10:28 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:10:28 : tab ===> line.article.Conditionnement
27/05/2020 10:10:28 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:10:28 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:10:28 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:10:28 : ********************** Prix *********************
27/05/2020 10:10:28 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:10:28 : ********************** Warning Prix *********************
27/05/2020 10:10:28 : Prix de l'article PBB-1560(3760119734292) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:10:28 : Utilise le prix de la base : 19,500000.

27/05/2020 10:10:28 : ORDLIN line 1 / 5.
27/05/2020 10:10:28 | getArticle() : Code Article : 3760093542906
27/05/2020 10:10:28 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:10:28 | getArticle() : Article trouvé!
27/05/2020 10:10:28 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:10:30 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:10:30 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:10:30 : tab ===> line.article.Conditionnement
27/05/2020 10:10:30 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:10:30 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:10:30 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:10:30 : ********************** Prix *********************
27/05/2020 10:10:30 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:10:30 : ********************** Warning Prix *********************
27/05/2020 10:10:30 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:10:30 : Utilise le prix de la base : 21,900000.

27/05/2020 10:10:30 : ORDLIN line 1 / 5.
27/05/2020 10:10:30 | getStockId() : Called!
27/05/2020 10:10:33 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:10:33 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:10:33 | getNumLivraison() : Client Numéro => 01LMVILLELAGRAND
27/05/2020 10:10:35 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMVILLELAGRAND' and li_principal=1
27/05/2020 10:10:35 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:10:35 | insertOrder() : Récupére tous les tva
27/05/2020 10:10:35 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:10:35 | insertCommande() : Called!
27/05/2020 10:10:37 : insertCommande() | called!
27/05/2020 10:10:37 : insertCommande() | Requette pour Batimex.
27/05/2020 10:10:37 : insertCommande() | ODBC.
27/05/2020 10:10:37 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMVILLELAGRAND',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202705','/56034954',21,2,1,'01LMVILLELAGRAND',11,0,1,1,0,407,1,'3025940015400;3779000001461','56034954',20,0,0)
27/05/2020 10:10:37 : insertCommande() | called!
27/05/2020 10:10:37 : insertCommande() | Requette pour Batimex.
27/05/2020 10:10:37 : insertCommande() | ODBC.
27/05/2020 10:10:38 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article PBB-1560
27/05/2020 10:10:38 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='PBB-1560' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:10:38 | insertOrder() : List des TVA trouvé
27/05/2020 10:10:38 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:10:38 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:10:38 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:10:38 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:10:38 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:10:38 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:10:38 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:10:38 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:10:38 | insertOrder() : Prix TTC créé


27/05/2020 10:10:38 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 10:10:38 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 10:10:38 | insertCommandeLine() : Called!
27/05/2020 10:10:38 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','PBB-1560','01LMVILLELAGRAND',7, 'BALADEUSE MULTICOLOR LIBERTY LUMISK',1,19.500000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202705',1,0,0,'', NULL,'56034954',3000000.00,3000000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202705', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 10:10:39 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:10:39 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:10:39 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:10:39 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:10:39 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'PBB-1560' and DE_No = 1
27/05/2020 10:10:39 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (76,000000), AS_StockMontant (0,000000).

27/05/2020 10:10:39 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:10:39 | insertOrder() : new_AS_StockReserve: 80 = AS_StockReserve: 76 + Quantite: 4
27/05/2020 10:10:39 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 19,5
27/05/2020 10:10:39 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:10:39 | insertOrder() : update article LIBERTY C25 BALADEUSE LUMINEUSE RECHARGEABLE (Ref:PBB-1560) stock in F_ARTSTOCK table in the database
27/05/2020 10:10:39 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 80, AS_MontSto = 0 WHERE AR_Ref = 'PBB-1560' and DE_No = 1

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:10:39 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:10:39 | insertOrder() : List des TVA trouvé
27/05/2020 10:10:39 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:10:39 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:10:39 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:10:39 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:10:39 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:10:39 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:10:39 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:10:39 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:10:39 | insertOrder() : Prix TTC créé


27/05/2020 10:10:39 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 10:10:39 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 10:10:39 | insertCommandeLine() : Called!
27/05/2020 10:10:39 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMVILLELAGRAND',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202705',1,0,0,'', NULL,'56034954',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202705', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 10:10:39 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:10:39 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:10:39 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:10:39 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:10:39 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:10:39 | insertOrder() : Aucune reponse.

27/05/2020 10:10:39 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56034954
27/05/2020 10:10:39 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 41.4 WHERE DO_PIECE = 'BC202705' 


27/05/2020 10:10:39 : 2/2 ligne(s) enregistrée(s).


27/05/2020 10:10:39 : Le fichier 'E:\EDI\EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101039__56034954__EDI_ORDERS.56034954.773986.BATIMEX.3025940015400.20200527.202005270124.RECU.IN.csv



27/05/2020 10:10:39 : -----> Fichier 7/21 : EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv
27/05/2020 10:10:39 : Scan fichier...
27/05/2020 10:10:39 : Import Commande Manuel.
27/05/2020 10:10:41 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:10:45 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56035686'
27/05/2020 10:11:49 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940016200' and CT_Type=0
27/05/2020 10:11:54 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940016200' and CT_Type=0
27/05/2020 10:11:57 | existeFourniseur() : id '3779000001461'
27/05/2020 10:11:59 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:12:00 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:12:00 | get_adresse_livraison() : Called1
27/05/2020 10:12:02 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBESANCON'
27/05/2020 10:12:02 | getDevise() : Code ISO 'EUR'
27/05/2020 10:12:04 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:12:04 | getDevise() : Devise trouvé!
27/05/2020 10:12:04 : ORDHD1 trouvé.

27/05/2020 10:12:04 : ORDLIN trouvé.
27/05/2020 10:12:04 : ORDLIN line 1 / 6.
27/05/2020 10:12:04 : ORDLIN line 1 / 6.
27/05/2020 10:12:04 : ORDLIN line 1 / 6.
27/05/2020 10:12:04 | getArticle() : Code Article : 3760093543187
27/05/2020 10:12:04 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:12:04 | getArticle() : Article trouvé!
27/05/2020 10:12:04 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
27/05/2020 10:12:07 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
27/05/2020 10:12:07 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:12:07 : tab ===> line.article.Conditionnement
27/05/2020 10:12:07 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:12:07 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:12:07 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:12:07 : ********************** Prix *********************
27/05/2020 10:12:07 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:12:07 : ********************** Warning Prix *********************
27/05/2020 10:12:07 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:12:07 : Utilise le prix de la base : 19,500000.

27/05/2020 10:12:07 : ORDLIN line 1 / 6.
27/05/2020 10:12:07 | getArticle() : Code Article : 3760093542906
27/05/2020 10:12:07 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:12:07 | getArticle() : Article trouvé!
27/05/2020 10:12:07 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:12:09 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:12:09 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:12:09 : tab ===> line.article.Conditionnement
27/05/2020 10:12:09 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:12:09 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:12:09 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:12:09 : ********************** Prix *********************
27/05/2020 10:12:09 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:12:09 : ********************** Warning Prix *********************
27/05/2020 10:12:09 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:12:09 : Utilise le prix de la base : 21,900000.

27/05/2020 10:12:09 : ORDLIN line 1 / 6.
27/05/2020 10:12:09 | getArticle() : Code Article : 3760093543040
27/05/2020 10:12:09 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543040' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:12:09 | getArticle() : Article trouvé!
27/05/2020 10:12:09 | getConditionnementArticle() : Code Article : COOPER_WHITE
27/05/2020 10:12:12 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER_WHITE'
27/05/2020 10:12:12 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:12:12 : tab ===> line.article.Conditionnement
27/05/2020 10:12:12 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:12:12 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:12:12 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:12:12 : ********************** Prix *********************
27/05/2020 10:12:12 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:12:12 : ********************** Warning Prix *********************
27/05/2020 10:12:12 : Prix de l'article COOPER_WHITE(3760093543040) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:12:12 : Utilise le prix de la base : 15,900000.

27/05/2020 10:12:12 : ORDLIN line 1 / 6.
27/05/2020 10:12:12 | getStockId() : Called!
27/05/2020 10:12:14 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:12:14 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:12:14 | getNumLivraison() : Client Numéro => 01LMBESANCON
27/05/2020 10:12:17 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBESANCON' and li_principal=1
27/05/2020 10:12:17 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:12:17 | insertOrder() : Récupére tous les tva
27/05/2020 10:12:17 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:12:17 | insertCommande() : Called!
27/05/2020 10:12:19 : insertCommande() | called!
27/05/2020 10:12:19 : insertCommande() | Requette pour Batimex.
27/05/2020 10:12:19 : insertCommande() | ODBC.
27/05/2020 10:12:19 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBESANCON',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202706','/56035686',21,2,1,'01LMBESANCON',11,0,1,1,0,397,1,'3025940016200;3779000001461','56035686',20,0,0)
27/05/2020 10:12:19 : insertCommande() | called!
27/05/2020 10:12:19 : insertCommande() | Requette pour Batimex.
27/05/2020 10:12:19 : insertCommande() | ODBC.
27/05/2020 10:12:20 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
27/05/2020 10:12:20 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:12:20 | insertOrder() : List des TVA trouvé
27/05/2020 10:12:20 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:12:20 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:12:20 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:12:20 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:12:20 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:12:20 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:12:20 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:12:20 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:12:20 | insertOrder() : Prix TTC créé


27/05/2020 10:12:20 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 10:12:20 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 10:12:20 | insertCommandeLine() : Called!
27/05/2020 10:12:20 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMBESANCON',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202706',1,0,0,'', NULL,'56035686',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202706', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 10:12:21 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:12:21 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:12:21 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:12:21 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:12:21 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
27/05/2020 10:12:21 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:12:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:12:21 | insertOrder() : List des TVA trouvé
27/05/2020 10:12:21 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:12:21 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:12:21 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:12:21 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:12:21 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:12:21 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:12:21 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:12:21 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:12:21 | insertOrder() : Prix TTC créé


27/05/2020 10:12:21 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 10:12:21 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 10:12:21 | insertCommandeLine() : Called!
27/05/2020 10:12:21 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMBESANCON',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202706',1,0,0,'', NULL,'56035686',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202706', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 10:12:21 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:12:21 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:12:21 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:12:21 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:12:21 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:12:21 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article COOPER_WHITE
27/05/2020 10:12:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER_WHITE' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:12:21 | insertOrder() : List des TVA trouvé
27/05/2020 10:12:21 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:12:21 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:12:21 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:12:21 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:12:21 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:12:21 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:12:21 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:12:21 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:12:21 | insertOrder() : Prix TTC créé


27/05/2020 10:12:21 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
27/05/2020 10:12:21 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
27/05/2020 10:12:21 | insertCommandeLine() : Called!
27/05/2020 10:12:21 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER_WHITE','01LMBESANCON',7, 'PROJ DET SOLAIRE 1000LM BLC PLS BAT',3,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202706',1,0,0,'', NULL,'56035686',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202706', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
27/05/2020 10:12:21 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:12:21 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:12:21 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:12:21 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:12:21 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER_WHITE' and DE_No = 1
27/05/2020 10:12:21 | insertOrder() : Aucune reponse.

27/05/2020 10:12:21 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56035686
27/05/2020 10:12:21 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 57.3 WHERE DO_PIECE = 'BC202706' 


27/05/2020 10:12:21 : 3/3 ligne(s) enregistrée(s).


27/05/2020 10:12:21 : Le fichier 'E:\EDI\EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101221__56035686__EDI_ORDERS.56035686.773989.BATIMEX.3025940016200.20200527.202005270125.RECU.IN.csv



27/05/2020 10:12:21 : -----> Fichier 8/21 : EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv
27/05/2020 10:12:21 : Scan fichier...
27/05/2020 10:12:21 : Import Commande Manuel.
27/05/2020 10:12:24 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:12:26 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56036369'
27/05/2020 10:13:27 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940016800' and CT_Type=0
27/05/2020 10:13:33 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940016800' and CT_Type=0
27/05/2020 10:13:36 | existeFourniseur() : id '3779000001461'
27/05/2020 10:13:38 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:13:38 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:13:39 | get_adresse_livraison() : Called1
27/05/2020 10:13:41 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMSTETIENNE'
27/05/2020 10:13:42 | getDevise() : Code ISO 'EUR'
27/05/2020 10:13:44 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:13:44 | getDevise() : Devise trouvé!
27/05/2020 10:13:45 : ORDHD1 trouvé.

27/05/2020 10:13:45 : ORDLIN trouvé.
27/05/2020 10:13:45 : ORDLIN line 1 / 6.
27/05/2020 10:13:45 : ORDLIN line 1 / 6.
27/05/2020 10:13:45 : ORDLIN line 1 / 6.
27/05/2020 10:13:45 | getArticle() : Code Article : 3760093542883
27/05/2020 10:13:45 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:13:45 | getArticle() : Article trouvé!
27/05/2020 10:13:45 | getConditionnementArticle() : Code Article : COOPER
27/05/2020 10:13:47 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
27/05/2020 10:13:47 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:13:47 : tab ===> line.article.Conditionnement
27/05/2020 10:13:47 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:13:47 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:13:47 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:13:47 : ********************** Prix *********************
27/05/2020 10:13:47 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:13:47 : ********************** Warning Prix *********************
27/05/2020 10:13:47 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:13:47 : Utilise le prix de la base : 15,900000.

27/05/2020 10:13:47 : ORDLIN line 1 / 6.
27/05/2020 10:13:47 | getArticle() : Code Article : 3760093542906
27/05/2020 10:13:47 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:13:47 | getArticle() : Article trouvé!
27/05/2020 10:13:47 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:13:50 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:13:50 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:13:50 : tab ===> line.article.Conditionnement
27/05/2020 10:13:50 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:13:50 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:13:50 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:13:50 : ********************** Prix *********************
27/05/2020 10:13:50 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:13:50 : ********************** Warning Prix *********************
27/05/2020 10:13:50 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:13:50 : Utilise le prix de la base : 21,900000.

27/05/2020 10:13:50 : ORDLIN line 1 / 6.
27/05/2020 10:13:50 | getArticle() : Code Article : 3760093543040
27/05/2020 10:13:50 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543040' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:13:50 | getArticle() : Article trouvé!
27/05/2020 10:13:50 | getConditionnementArticle() : Code Article : COOPER_WHITE
27/05/2020 10:13:53 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER_WHITE'
27/05/2020 10:13:53 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:13:53 : tab ===> line.article.Conditionnement
27/05/2020 10:13:53 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:13:53 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:13:53 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:13:53 : ********************** Prix *********************
27/05/2020 10:13:53 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:13:53 : ********************** Warning Prix *********************
27/05/2020 10:13:53 : Prix de l'article COOPER_WHITE(3760093543040) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:13:53 : Utilise le prix de la base : 15,900000.

27/05/2020 10:13:53 : ORDLIN line 1 / 6.
27/05/2020 10:13:53 | getStockId() : Called!
27/05/2020 10:13:55 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:13:55 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:13:56 | getNumLivraison() : Client Numéro => 01LMSTETIENNE
27/05/2020 10:13:58 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMSTETIENNE' and li_principal=1
27/05/2020 10:13:58 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:13:58 | insertOrder() : Récupére tous les tva
27/05/2020 10:13:58 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:13:58 | insertCommande() : Called!
27/05/2020 10:14:01 : insertCommande() | called!
27/05/2020 10:14:01 : insertCommande() | Requette pour Batimex.
27/05/2020 10:14:01 : insertCommande() | ODBC.
27/05/2020 10:14:01 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMSTETIENNE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202707','/56036369',21,2,1,'01LMSTETIENNE',11,0,1,1,0,1088,1,'3025940016800;3779000001461','56036369',20,0,0)
27/05/2020 10:14:01 : insertCommande() | called!
27/05/2020 10:14:01 : insertCommande() | Requette pour Batimex.
27/05/2020 10:14:01 : insertCommande() | ODBC.
27/05/2020 10:14:02 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article COOPER
27/05/2020 10:14:02 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:14:02 | insertOrder() : List des TVA trouvé
27/05/2020 10:14:02 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:14:02 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:14:02 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:14:02 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:14:02 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:14:02 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:14:02 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:14:02 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:14:02 | insertOrder() : Prix TTC créé


27/05/2020 10:14:02 | insertOrder() : DL_MontantHT : 127.2 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 8.00
27/05/2020 10:14:02 | insertOrder() : DL_MontantTTC : 152.85624 = DL_PUTTC : 19.10703 X DL_QteBC : 8.00
27/05/2020 10:14:02 | insertCommandeLine() : Called!
27/05/2020 10:14:02 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMSTETIENNE',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',1,15.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202707',1,0,0,'', NULL,'56036369',10400000.00,10400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202707', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 127.2, 152.85624)
27/05/2020 10:14:03 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:14:03 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:14:03 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:14:03 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:14:03 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
27/05/2020 10:14:03 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:14:03 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:14:03 | insertOrder() : List des TVA trouvé
27/05/2020 10:14:03 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:14:03 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:14:03 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:14:03 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:14:03 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:14:03 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:14:03 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:14:03 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:14:03 | insertOrder() : Prix TTC créé


27/05/2020 10:14:03 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 10:14:03 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 10:14:03 | insertCommandeLine() : Called!
27/05/2020 10:14:03 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMSTETIENNE',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202707',1,0,0,'', NULL,'56036369',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202707', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 10:14:03 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:14:03 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:14:03 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:14:03 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:14:03 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:14:03 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article COOPER_WHITE
27/05/2020 10:14:03 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER_WHITE' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:14:03 | insertOrder() : List des TVA trouvé
27/05/2020 10:14:03 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:14:03 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:14:03 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:14:03 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:14:03 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:14:03 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:14:03 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:14:03 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:14:03 | insertOrder() : Prix TTC créé


27/05/2020 10:14:03 | insertOrder() : DL_MontantHT : 127.2 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 8.00
27/05/2020 10:14:03 | insertOrder() : DL_MontantTTC : 152.85624 = DL_PUTTC : 19.10703 X DL_QteBC : 8.00
27/05/2020 10:14:03 | insertCommandeLine() : Called!
27/05/2020 10:14:03 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER_WHITE','01LMSTETIENNE',7, 'PROJ DET SOLAIRE 1000LM BLC PLS BAT',3,15.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202707',1,0,0,'', NULL,'56036369',10400000.00,10400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202707', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 127.2, 152.85624)
27/05/2020 10:14:03 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:14:03 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:14:03 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:14:03 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:14:03 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER_WHITE' and DE_No = 1
27/05/2020 10:14:03 | insertOrder() : Aucune reponse.

27/05/2020 10:14:03 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56036369
27/05/2020 10:14:03 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 53.7 WHERE DO_PIECE = 'BC202707' 


27/05/2020 10:14:04 : 3/3 ligne(s) enregistrée(s).


27/05/2020 10:14:04 : Le fichier 'E:\EDI\EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101404__56036369__EDI_ORDERS.56036369.774016.BATIMEX.3025940016800.20200527.202005270126.RECU.IN.csv



27/05/2020 10:14:04 : -----> Fichier 9/21 : EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv
27/05/2020 10:14:04 : Scan fichier...
27/05/2020 10:14:04 : Import Commande Manuel.
27/05/2020 10:14:06 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:14:09 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56036597'
27/05/2020 10:15:02 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017100' and CT_Type=0
27/05/2020 10:15:08 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940017100' and CT_Type=0
27/05/2020 10:15:11 | existeFourniseur() : id '3779000001461'
27/05/2020 10:15:14 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:15:14 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:15:14 | get_adresse_livraison() : Called1
27/05/2020 10:15:17 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMPERPIGNAN'
27/05/2020 10:15:17 | getDevise() : Code ISO 'EUR'
27/05/2020 10:15:20 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:15:20 | getDevise() : Devise trouvé!
27/05/2020 10:15:20 : ORDHD1 trouvé.

27/05/2020 10:15:20 : ORDLIN trouvé.
27/05/2020 10:15:20 : ORDLIN line 1 / 5.
27/05/2020 10:15:20 : ORDLIN line 1 / 5.
27/05/2020 10:15:20 : ORDLIN line 1 / 5.
27/05/2020 10:15:20 | getArticle() : Code Article : 3760093543187
27/05/2020 10:15:20 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:15:20 | getArticle() : Article trouvé!
27/05/2020 10:15:20 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
27/05/2020 10:15:23 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
27/05/2020 10:15:23 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:15:23 : tab ===> line.article.Conditionnement
27/05/2020 10:15:23 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:15:23 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:15:23 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:15:23 : ********************** Prix *********************
27/05/2020 10:15:23 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:15:23 : ********************** Warning Prix *********************
27/05/2020 10:15:23 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:15:23 : Utilise le prix de la base : 19,500000.

27/05/2020 10:15:23 : ORDLIN line 1 / 5.
27/05/2020 10:15:23 | getArticle() : Code Article : 3760093543040
27/05/2020 10:15:23 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543040' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:15:23 | getArticle() : Article trouvé!
27/05/2020 10:15:23 | getConditionnementArticle() : Code Article : COOPER_WHITE
27/05/2020 10:15:26 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER_WHITE'
27/05/2020 10:15:26 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:15:26 : tab ===> line.article.Conditionnement
27/05/2020 10:15:26 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:15:26 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:15:26 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:15:26 : ********************** Prix *********************
27/05/2020 10:15:26 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:15:26 : ********************** Warning Prix *********************
27/05/2020 10:15:26 : Prix de l'article COOPER_WHITE(3760093543040) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:15:26 : Utilise le prix de la base : 15,900000.

27/05/2020 10:15:26 : ORDLIN line 1 / 5.
27/05/2020 10:15:26 | getStockId() : Called!
27/05/2020 10:15:29 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:15:29 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:15:29 | getNumLivraison() : Client Numéro => 01LMPERPIGNAN
27/05/2020 10:15:31 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMPERPIGNAN' and li_principal=1
27/05/2020 10:15:31 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:15:32 | insertOrder() : Récupére tous les tva
27/05/2020 10:15:32 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:15:32 | insertCommande() : Called!
27/05/2020 10:15:34 : insertCommande() | called!
27/05/2020 10:15:34 : insertCommande() | Requette pour Batimex.
27/05/2020 10:15:34 : insertCommande() | ODBC.
27/05/2020 10:15:34 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMPERPIGNAN',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202708','/56036597',21,2,1,'01LMPERPIGNAN',11,0,1,1,0,1091,1,'3025940017100;3779000001461','56036597',20,0,0)
27/05/2020 10:15:34 : insertCommande() | called!
27/05/2020 10:15:34 : insertCommande() | Requette pour Batimex.
27/05/2020 10:15:34 : insertCommande() | ODBC.
27/05/2020 10:15:35 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
27/05/2020 10:15:35 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:15:35 | insertOrder() : List des TVA trouvé
27/05/2020 10:15:35 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:15:35 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:15:35 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:15:35 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:15:35 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:15:35 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:15:35 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:15:35 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:15:35 | insertOrder() : Prix TTC créé


27/05/2020 10:15:35 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 10:15:35 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 10:15:35 | insertCommandeLine() : Called!
27/05/2020 10:15:35 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMPERPIGNAN',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202708',1,0,0,'', NULL,'56036597',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202708', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 10:15:35 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:15:35 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:15:35 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:15:35 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:15:35 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
27/05/2020 10:15:35 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article COOPER_WHITE
27/05/2020 10:15:35 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER_WHITE' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:15:35 | insertOrder() : List des TVA trouvé
27/05/2020 10:15:35 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:15:35 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:15:35 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:15:35 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:15:35 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:15:35 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:15:35 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:15:35 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:15:35 | insertOrder() : Prix TTC créé


27/05/2020 10:15:35 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
27/05/2020 10:15:35 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
27/05/2020 10:15:35 | insertCommandeLine() : Called!
27/05/2020 10:15:35 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER_WHITE','01LMPERPIGNAN',7, 'PROJ DET SOLAIRE 1000LM BLC PLS BAT',2,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202708',1,0,0,'', NULL,'56036597',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202708', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
27/05/2020 10:15:35 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:15:35 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:15:35 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:15:35 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:15:35 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER_WHITE' and DE_No = 1
27/05/2020 10:15:35 | insertOrder() : Aucune reponse.

27/05/2020 10:15:35 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56036597
27/05/2020 10:15:35 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 35.4 WHERE DO_PIECE = 'BC202708' 


27/05/2020 10:15:35 : 2/2 ligne(s) enregistrée(s).


27/05/2020 10:15:35 : Le fichier 'E:\EDI\EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101535__56036597__EDI_ORDERS.56036597.773990.BATIMEX.3025940017100.20200527.202005270125.RECU.IN.csv



27/05/2020 10:15:35 : -----> Fichier 10/21 : EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv
27/05/2020 10:15:35 : Scan fichier...
27/05/2020 10:15:35 : Import Commande Manuel.
27/05/2020 10:15:38 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:15:41 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56037802'
27/05/2020 10:16:29 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018100' and CT_Type=0
27/05/2020 10:16:35 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018100' and CT_Type=0
27/05/2020 10:16:39 | existeFourniseur() : id '3779000001461'
27/05/2020 10:16:42 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:16:42 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:16:42 | get_adresse_livraison() : Called1
27/05/2020 10:16:45 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMQUIMPER'
27/05/2020 10:16:45 | getDevise() : Code ISO 'EUR'
27/05/2020 10:16:48 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:16:48 | getDevise() : Devise trouvé!
27/05/2020 10:16:48 : ORDHD1 trouvé.

27/05/2020 10:16:48 : ORDLIN trouvé.
27/05/2020 10:16:48 : ORDLIN line 1 / 4.
27/05/2020 10:16:48 : ORDLIN line 1 / 4.
27/05/2020 10:16:48 : ORDLIN line 1 / 4.
27/05/2020 10:16:48 | getArticle() : Code Article : 3760093542906
27/05/2020 10:16:48 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:16:48 | getArticle() : Article trouvé!
27/05/2020 10:16:48 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:16:51 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:16:51 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:16:51 : tab ===> line.article.Conditionnement
27/05/2020 10:16:51 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:16:51 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:16:51 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:16:51 : ********************** Prix *********************
27/05/2020 10:16:51 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:16:51 : ********************** Warning Prix *********************
27/05/2020 10:16:51 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:16:51 : Utilise le prix de la base : 21,900000.

27/05/2020 10:16:51 : ORDLIN line 1 / 4.
27/05/2020 10:16:51 | getStockId() : Called!
27/05/2020 10:16:54 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:16:54 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:16:54 | getNumLivraison() : Client Numéro => 01LMQUIMPER
27/05/2020 10:16:57 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMQUIMPER' and li_principal=1
27/05/2020 10:16:57 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:16:58 | insertOrder() : Récupére tous les tva
27/05/2020 10:16:58 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:16:58 | insertCommande() : Called!
27/05/2020 10:17:00 : insertCommande() | called!
27/05/2020 10:17:00 : insertCommande() | Requette pour Batimex.
27/05/2020 10:17:00 : insertCommande() | ODBC.
27/05/2020 10:17:00 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMQUIMPER',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202709','/56037802',21,2,1,'01LMQUIMPER',11,0,1,1,0,2868,1,'3025940018100;3779000001461','56037802',20,0,0)
27/05/2020 10:17:00 : insertCommande() | called!
27/05/2020 10:17:00 : insertCommande() | Requette pour Batimex.
27/05/2020 10:17:00 : insertCommande() | ODBC.
27/05/2020 10:17:02 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:17:02 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:17:02 | insertOrder() : List des TVA trouvé
27/05/2020 10:17:02 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:17:02 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:17:02 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:17:02 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:17:02 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:17:02 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:17:02 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:17:02 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:17:02 | insertOrder() : Prix TTC créé


27/05/2020 10:17:02 | insertOrder() : DL_MontantHT : 175.2 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 8.00
27/05/2020 10:17:02 | insertOrder() : DL_MontantTTC : 210.53784 = DL_PUTTC : 26.31723 X DL_QteBC : 8.00
27/05/2020 10:17:02 | insertCommandeLine() : Called!
27/05/2020 10:17:02 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMQUIMPER',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',1,21.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202709',1,0,0,'', NULL,'56037802',14400000.00,14400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202709', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 175.2, 210.53784)
27/05/2020 10:17:02 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:17:02 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:17:02 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:17:02 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:17:02 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:17:02 | insertOrder() : Aucune reponse.

27/05/2020 10:17:02 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56037802
27/05/2020 10:17:02 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 21.9 WHERE DO_PIECE = 'BC202709' 


27/05/2020 10:17:03 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:17:03 : Le fichier 'E:\EDI\EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101703__56037802__EDI_ORDERS.56037802.774007.BATIMEX.3025940018100.20200527.202005270126.RECU.IN.csv



27/05/2020 10:17:03 : -----> Fichier 11/21 : EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv
27/05/2020 10:17:03 : Scan fichier...
27/05/2020 10:17:03 : Import Commande Manuel.
27/05/2020 10:17:05 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:17:08 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56038243'
27/05/2020 10:17:57 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940018500' and CT_Type=0
27/05/2020 10:18:01 | getClient() : Erreur[41] - GLN émetteur  3025940018500 n'existe pas dans la base sage.
27/05/2020 10:18:01 : ********************** Erreur *********************
27/05/2020 10:18:01 : Client trouvé est null, verifier le code client.
27/05/2020 10:18:01 : Import annulée

27/05/2020 10:18:01 : ********************** Fichier *********************
27/05/2020 10:18:01 : Import annulée
27/05/2020 10:18:01 : Le fichier 'E:\EDI\EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Error File\27052020101801__56038243__EDI_ORDERS.56038243.774004.BATIMEX.3025940018500.20200527.202005270125.RECU.IN.csv

27/05/2020 10:18:01 : -----> Fichier 12/21 : EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv
27/05/2020 10:18:01 : Scan fichier...
27/05/2020 10:18:01 : Import Commande Manuel.
27/05/2020 10:18:05 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:18:08 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039047'
27/05/2020 10:18:55 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019200' and CT_Type=0
27/05/2020 10:19:00 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019200' and CT_Type=0
27/05/2020 10:19:03 | existeFourniseur() : id '3779000001461'
27/05/2020 10:19:06 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:19:06 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:19:07 | get_adresse_livraison() : Called1
27/05/2020 10:19:10 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMFREJUS'
27/05/2020 10:19:10 | getDevise() : Code ISO 'EUR'
27/05/2020 10:19:13 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:19:13 | getDevise() : Devise trouvé!
27/05/2020 10:19:13 : ORDHD1 trouvé.

27/05/2020 10:19:13 : ORDLIN trouvé.
27/05/2020 10:19:13 : ORDLIN line 1 / 6.
27/05/2020 10:19:13 : ORDLIN line 1 / 6.
27/05/2020 10:19:13 : ORDLIN line 1 / 6.
27/05/2020 10:19:13 | getArticle() : Code Article : 3760119739013
27/05/2020 10:19:13 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739013' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:19:13 | getArticle() : Article trouvé!
27/05/2020 10:19:13 | getConditionnementArticle() : Code Article : MAFY_LIGHT
27/05/2020 10:19:16 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY_LIGHT'
27/05/2020 10:19:16 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:19:16 : tab ===> line.article.Conditionnement
27/05/2020 10:19:16 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:19:16 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:19:16 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:19:16 : ********************** Prix *********************
27/05/2020 10:19:16 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 25,900000

27/05/2020 10:19:16 : ********************** Warning Prix *********************
27/05/2020 10:19:16 : Prix de l'article MAFY_LIGHT(3760119739013) dans la base est : 25,900000
Il est différent du prix envoyer par le client : 26,07.
27/05/2020 10:19:16 : Utilise le prix de la base : 25,900000.

27/05/2020 10:19:16 : ORDLIN line 1 / 6.
27/05/2020 10:19:16 | getArticle() : Code Article : 3760119739020
27/05/2020 10:19:16 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739020' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:19:16 | getArticle() : Article trouvé!
27/05/2020 10:19:16 | getConditionnementArticle() : Code Article : MAFY
27/05/2020 10:19:19 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY'
27/05/2020 10:19:19 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:19:20 : tab ===> line.article.Conditionnement
27/05/2020 10:19:20 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:19:20 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:19:20 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:19:20 : ********************** Prix *********************
27/05/2020 10:19:20 : Prix trouvé dans le fichier EDI => 14,90 && Prix trouvé dans Sage => 14,900000

27/05/2020 10:19:20 : ORDLIN line 1 / 6.
27/05/2020 10:19:20 | getArticle() : Code Article : 3760093542883
27/05/2020 10:19:20 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:19:20 | getArticle() : Article trouvé!
27/05/2020 10:19:20 | getConditionnementArticle() : Code Article : COOPER
27/05/2020 10:19:22 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
27/05/2020 10:19:22 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:19:23 : tab ===> line.article.Conditionnement
27/05/2020 10:19:23 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:19:23 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:19:23 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:19:23 : ********************** Prix *********************
27/05/2020 10:19:23 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:19:23 : ********************** Warning Prix *********************
27/05/2020 10:19:23 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:19:23 : Utilise le prix de la base : 15,900000.

27/05/2020 10:19:23 : ORDLIN line 1 / 6.
27/05/2020 10:19:23 | getStockId() : Called!
27/05/2020 10:19:26 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:19:26 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:19:26 | getNumLivraison() : Client Numéro => 01LMFREJUS
27/05/2020 10:19:29 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMFREJUS' and li_principal=1
27/05/2020 10:19:29 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:19:29 | insertOrder() : Récupére tous les tva
27/05/2020 10:19:29 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:19:29 | insertCommande() : Called!
27/05/2020 10:19:32 : insertCommande() | called!
27/05/2020 10:19:32 : insertCommande() | Requette pour Batimex.
27/05/2020 10:19:32 : insertCommande() | ODBC.
27/05/2020 10:19:32 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMFREJUS',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202710','/56039047',21,2,1,'01LMFREJUS',11,0,1,1,0,2898,1,'3025940019200;3779000001461','56039047',20,0,0)
27/05/2020 10:19:32 : insertCommande() | called!
27/05/2020 10:19:32 : insertCommande() | Requette pour Batimex.
27/05/2020 10:19:32 : insertCommande() | ODBC.
27/05/2020 10:19:34 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article MAFY_LIGHT
27/05/2020 10:19:34 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:19:34 | insertOrder() : List des TVA trouvé
27/05/2020 10:19:34 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:19:34 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:19:34 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:19:34 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:19:34 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:19:34 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:19:34 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:19:34 | insertOrder() : Prix HT => 25,9 | TVA => 20,17 % | Prix TTC => 31,12403
27/05/2020 10:19:34 | insertOrder() : Prix TTC créé


27/05/2020 10:19:34 | insertOrder() : DL_MontantHT : 103.6 = DL_PrixUnitaire : 25.900000 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertOrder() : DL_MontantTTC : 124.49612 = DL_PUTTC : 31.12403 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertCommandeLine() : Called!
27/05/2020 10:19:34 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY_LIGHT','01LMFREJUS',7, 'GUIRLANDE EXT 6M MAFY LIGHT LUMISKY',1,25.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202710',1,0,0,'', NULL,'56039047',6800000.00,6800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.12403, 'BC202710', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 103.6, 124.49612)
27/05/2020 10:19:34 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:19:34 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:19:34 | insertOrder() : Additionner le total HT (25.900000) et TTC (31.12403)

27/05/2020 10:19:34 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:19:34 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1
27/05/2020 10:19:34 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (288,000000), AS_StockMontant (0,000000).

27/05/2020 10:19:34 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:19:34 | insertOrder() : new_AS_StockReserve: 292 = AS_StockReserve: 288 + Quantite: 4
27/05/2020 10:19:34 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 25,9
27/05/2020 10:19:34 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:19:34 | insertOrder() : update article MAFY LIGHT GUIRLANDE CABLE AVEC AMPOULES (Ref:MAFY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 10:19:34 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 292, AS_MontSto = 0 WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1

Récupérer les TVA des l'article MAFY
27/05/2020 10:19:34 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 :  || DL_CodeTaxe3 : 


27/05/2020 10:19:34 | insertOrder() : List des TVA trouvé
27/05/2020 10:19:34 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:19:34 | insertOrder() : TVA 2 VIDE trouvé, alors TVA mis à 0
27/05/2020 10:19:34 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:19:34 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:19:34 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:19:34 | insertOrder() : TVA 2 => 0.000000
27/05/2020 10:19:34 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:19:34 | insertOrder() : Prix HT => 14,9 | TVA => 20 % | Prix TTC => 17,88
27/05/2020 10:19:34 | insertOrder() : Prix TTC créé


27/05/2020 10:19:34 | insertOrder() : DL_MontantHT : 59.6 = DL_PrixUnitaire : 14.90 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertOrder() : DL_MontantTTC : 71.52 = DL_PUTTC : 17.88 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertCommandeLine() : Called!
27/05/2020 10:19:34 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY','01LMFREJUS',7, 'GUIRLANDE EXT MAFY E27 6M LUMISKY',2,14.90,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202710',1,0,0,'', NULL,'56039047',4960000.00,4960000.00,'V20', 20.000000,0,0, 'C00',0.000000,2,2,17.88, 'BC202710', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 59.6, 71.52)
27/05/2020 10:19:34 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:19:34 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:19:34 | insertOrder() : Additionner le total HT (14.90) et TTC (17.88)

27/05/2020 10:19:34 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:19:34 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY' and DE_No = 1
27/05/2020 10:19:34 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (44,000000), AS_StockMontant (0,000000).

27/05/2020 10:19:34 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:19:34 | insertOrder() : new_AS_StockReserve: 48 = AS_StockReserve: 44 + Quantite: 4
27/05/2020 10:19:34 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 14,9
27/05/2020 10:19:34 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:19:34 | insertOrder() : update article MAFY GUIRLANDE CABLE SANS AMPOULE (Ref:MAFY) stock in F_ARTSTOCK table in the database
27/05/2020 10:19:34 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 48, AS_MontSto = 0 WHERE AR_Ref = 'MAFY' and DE_No = 1

Récupérer les TVA des l'article COOPER
27/05/2020 10:19:34 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:19:34 | insertOrder() : List des TVA trouvé
27/05/2020 10:19:34 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:19:34 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:19:34 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:19:34 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:19:34 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:19:34 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:19:34 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:19:34 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:19:34 | insertOrder() : Prix TTC créé


27/05/2020 10:19:34 | insertOrder() : DL_MontantHT : 63.6 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertOrder() : DL_MontantTTC : 76.42812 = DL_PUTTC : 19.10703 X DL_QteBC : 4.00
27/05/2020 10:19:34 | insertCommandeLine() : Called!
27/05/2020 10:19:34 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMFREJUS',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',3,15.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202710',1,0,0,'', NULL,'56039047',5200000.00,5200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202710', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 63.6, 76.42812)
27/05/2020 10:19:35 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:19:35 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:19:35 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:19:35 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:19:35 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
27/05/2020 10:19:35 | insertOrder() : Aucune reponse.

27/05/2020 10:19:35 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56039047
27/05/2020 10:19:35 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 56.7 WHERE DO_PIECE = 'BC202710' 


27/05/2020 10:19:35 : 3/3 ligne(s) enregistrée(s).


27/05/2020 10:19:35 : Le fichier 'E:\EDI\EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020101935__56039047__EDI_ORDERS.56039047.774000.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv



27/05/2020 10:19:35 : -----> Fichier 13/21 : EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv
27/05/2020 10:19:35 : Scan fichier...
27/05/2020 10:19:35 : Import Commande Manuel.
27/05/2020 10:19:38 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:19:41 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039250'
27/05/2020 10:20:29 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019400' and CT_Type=0
27/05/2020 10:20:35 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019400' and CT_Type=0
27/05/2020 10:20:38 | existeFourniseur() : id '3779000001461'
27/05/2020 10:20:41 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:20:41 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:20:42 | get_adresse_livraison() : Called1
27/05/2020 10:20:45 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMGRENOBLE2'
27/05/2020 10:20:45 | getDevise() : Code ISO 'EUR'
27/05/2020 10:20:48 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:20:48 | getDevise() : Devise trouvé!
27/05/2020 10:20:48 : ORDHD1 trouvé.

27/05/2020 10:20:48 : ORDLIN trouvé.
27/05/2020 10:20:48 : ORDLIN line 1 / 5.
27/05/2020 10:20:48 : ORDLIN line 1 / 5.
27/05/2020 10:20:48 : ORDLIN line 1 / 5.
27/05/2020 10:20:48 | getArticle() : Code Article : 3760093543187
27/05/2020 10:20:48 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:20:48 | getArticle() : Article trouvé!
27/05/2020 10:20:48 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
27/05/2020 10:20:51 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
27/05/2020 10:20:51 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:20:52 : tab ===> line.article.Conditionnement
27/05/2020 10:20:52 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:20:52 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:20:52 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:20:52 : ********************** Prix *********************
27/05/2020 10:20:52 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:20:52 : ********************** Warning Prix *********************
27/05/2020 10:20:52 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:20:52 : Utilise le prix de la base : 19,500000.

27/05/2020 10:20:52 : ORDLIN line 1 / 5.
27/05/2020 10:20:52 | getArticle() : Code Article : 3760093544504
27/05/2020 10:20:52 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093544504' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:20:52 | getArticle() : Article trouvé!
27/05/2020 10:20:52 | getConditionnementArticle() : Code Article : IBIZA_STANDY_MINI
27/05/2020 10:20:55 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='IBIZA_STANDY_MINI'
27/05/2020 10:20:55 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:20:55 : tab ===> line.article.Conditionnement
27/05/2020 10:20:55 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:20:55 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:20:55 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:20:55 : ********************** Prix *********************
27/05/2020 10:20:55 : Prix trouvé dans le fichier EDI => 19,07 && Prix trouvé dans Sage => 18,900000

27/05/2020 10:20:55 : ********************** Warning Prix *********************
27/05/2020 10:20:55 : Prix de l'article IBIZA_STANDY_MINI(3760093544504) dans la base est : 18,900000
Il est différent du prix envoyer par le client : 19,07.
27/05/2020 10:20:55 : Utilise le prix de la base : 18,900000.

27/05/2020 10:20:55 : ORDLIN line 1 / 5.
27/05/2020 10:20:55 | getStockId() : Called!
27/05/2020 10:20:58 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:20:58 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:20:58 | getNumLivraison() : Client Numéro => 01LMGRENOBLE2
27/05/2020 10:21:01 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMGRENOBLE2' and li_principal=1
27/05/2020 10:21:01 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:21:02 | insertOrder() : Récupére tous les tva
27/05/2020 10:21:02 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:21:02 | insertCommande() : Called!
27/05/2020 10:21:05 : insertCommande() | called!
27/05/2020 10:21:05 : insertCommande() | Requette pour Batimex.
27/05/2020 10:21:05 : insertCommande() | ODBC.
27/05/2020 10:21:05 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMGRENOBLE2',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202711','/56039250',21,2,1,'01LMGRENOBLE2',11,0,1,1,0,3023,1,'3025940019400;3779000001461','56039250',20,0,0)
27/05/2020 10:21:05 : insertCommande() | called!
27/05/2020 10:21:05 : insertCommande() | Requette pour Batimex.
27/05/2020 10:21:05 : insertCommande() | ODBC.
27/05/2020 10:21:05 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
27/05/2020 10:21:05 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:21:05 | insertOrder() : List des TVA trouvé
27/05/2020 10:21:05 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:21:05 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:21:05 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:21:05 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:21:05 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:21:05 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:21:05 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:21:05 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:21:05 | insertOrder() : Prix TTC créé


27/05/2020 10:21:05 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 10:21:05 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 10:21:05 | insertCommandeLine() : Called!
27/05/2020 10:21:05 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMGRENOBLE2',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202711',1,0,0,'', NULL,'56039250',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202711', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 10:21:05 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:21:05 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:21:05 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:21:05 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:21:05 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
27/05/2020 10:21:05 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article IBIZA_STANDY_MINI
27/05/2020 10:21:05 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='IBIZA_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:21:05 | insertOrder() : List des TVA trouvé
27/05/2020 10:21:05 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:21:05 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:21:05 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:21:05 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:21:05 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:21:05 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:21:05 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:21:05 | insertOrder() : Prix HT => 18,9 | TVA => 20,17 % | Prix TTC => 22,71213
27/05/2020 10:21:05 | insertOrder() : Prix TTC créé


27/05/2020 10:21:05 | insertOrder() : DL_MontantHT : 75.6 = DL_PrixUnitaire : 18.900000 X DL_QteBC : 4.00
27/05/2020 10:21:05 | insertOrder() : DL_MontantTTC : 90.84852 = DL_PUTTC : 22.71213 X DL_QteBC : 4.00
27/05/2020 10:21:05 | insertCommandeLine() : Called!
27/05/2020 10:21:05 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','IBIZA_STANDY_MINI','01LMGRENOBLE2',7, 'LAMPE EXTERIEURE IBIZA LUMISKY',2,18.900000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202711',1,0,0,'', NULL,'56039250',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,22.71213, 'BC202711', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 75.6, 90.84852)
27/05/2020 10:21:05 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:21:05 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:21:05 | insertOrder() : Additionner le total HT (18.900000) et TTC (22.71213)

27/05/2020 10:21:05 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:21:05 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'IBIZA_STANDY_MINI' and DE_No = 1
27/05/2020 10:21:05 | insertOrder() : Aucune reponse.

27/05/2020 10:21:05 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56039250
27/05/2020 10:21:05 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 38.4 WHERE DO_PIECE = 'BC202711' 


27/05/2020 10:21:06 : 2/2 ligne(s) enregistrée(s).


27/05/2020 10:21:06 : Le fichier 'E:\EDI\EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102106__56039250__EDI_ORDERS.56039250.773985.BATIMEX.3025940019400.20200527.202005270124.RECU.IN.csv



27/05/2020 10:21:06 : -----> Fichier 14/21 : EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv
27/05/2020 10:21:06 : Scan fichier...
27/05/2020 10:21:06 : Import Commande Manuel.
27/05/2020 10:21:09 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:21:12 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56039693'
27/05/2020 10:22:05 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019900' and CT_Type=0
27/05/2020 10:22:11 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019900' and CT_Type=0
27/05/2020 10:22:14 | existeFourniseur() : id '3779000001461'
27/05/2020 10:22:17 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:22:17 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:22:18 | get_adresse_livraison() : Called1
27/05/2020 10:22:21 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMOSTWALD2'
27/05/2020 10:22:21 | getDevise() : Code ISO 'EUR'
27/05/2020 10:22:24 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:22:24 | getDevise() : Devise trouvé!
27/05/2020 10:22:24 : ORDHD1 trouvé.

27/05/2020 10:22:24 : ORDLIN trouvé.
27/05/2020 10:22:24 : ORDLIN line 1 / 5.
27/05/2020 10:22:24 : ORDLIN line 1 / 5.
27/05/2020 10:22:24 : ORDLIN line 1 / 5.
27/05/2020 10:22:24 | getArticle() : Code Article : 3760093543187
27/05/2020 10:22:24 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093543187' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:22:24 | getArticle() : Article trouvé!
27/05/2020 10:22:24 | getConditionnementArticle() : Code Article : BOHEME_STANDY_MINI
27/05/2020 10:22:28 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BOHEME_STANDY_MINI'
27/05/2020 10:22:28 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:22:28 : tab ===> line.article.Conditionnement
27/05/2020 10:22:28 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '8'
27/05/2020 10:22:28 | Calcule_conditionnement() : calcule... Valeur = 0, Reste = 4
27/05/2020 10:22:28 | Calcule_conditionnement() : Reste != 0, alors return Valeur : 0

27/05/2020 10:22:28 : ********************** Prix *********************
27/05/2020 10:22:28 : Prix trouvé dans le fichier EDI => 19,67 && Prix trouvé dans Sage => 19,500000

27/05/2020 10:22:28 : ********************** Warning Prix *********************
27/05/2020 10:22:28 : Prix de l'article BOHEME_STANDY_MINI(3760093543187) dans la base est : 19,500000
Il est différent du prix envoyer par le client : 19,67.
27/05/2020 10:22:28 : Utilise le prix de la base : 19,500000.

27/05/2020 10:22:28 : ORDLIN line 1 / 5.
27/05/2020 10:22:28 | getArticle() : Code Article : 3760093542906
27/05/2020 10:22:28 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:22:28 | getArticle() : Article trouvé!
27/05/2020 10:22:28 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:22:31 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:22:31 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:22:31 : tab ===> line.article.Conditionnement
27/05/2020 10:22:31 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:22:31 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:22:31 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:22:31 : ********************** Prix *********************
27/05/2020 10:22:31 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:22:31 : ********************** Warning Prix *********************
27/05/2020 10:22:31 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:22:31 : Utilise le prix de la base : 21,900000.

27/05/2020 10:22:31 : ORDLIN line 1 / 5.
27/05/2020 10:22:31 | getStockId() : Called!
27/05/2020 10:22:34 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:22:34 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:22:35 | getNumLivraison() : Client Numéro => 01LMOSTWALD2
27/05/2020 10:22:38 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMOSTWALD2' and li_principal=1
27/05/2020 10:22:38 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:22:38 | insertOrder() : Récupére tous les tva
27/05/2020 10:22:38 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:22:39 | insertCommande() : Called!
27/05/2020 10:22:42 : insertCommande() | called!
27/05/2020 10:22:42 : insertCommande() | Requette pour Batimex.
27/05/2020 10:22:42 : insertCommande() | ODBC.
27/05/2020 10:22:42 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMOSTWALD2',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202712','/56039693',21,2,1,'01LMOSTWALD2',11,0,1,1,0,3021,1,'3025940019900;3779000001461','56039693',20,0,0)
27/05/2020 10:22:42 : insertCommande() | called!
27/05/2020 10:22:42 : insertCommande() | Requette pour Batimex.
27/05/2020 10:22:42 : insertCommande() | ODBC.
27/05/2020 10:22:42 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article BOHEME_STANDY_MINI
27/05/2020 10:22:42 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BOHEME_STANDY_MINI' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:22:42 | insertOrder() : List des TVA trouvé
27/05/2020 10:22:42 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:22:42 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:22:42 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:22:42 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:22:42 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:22:42 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:22:42 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:22:42 | insertOrder() : Prix HT => 19,5 | TVA => 20,17 % | Prix TTC => 23,43315
27/05/2020 10:22:42 | insertOrder() : Prix TTC créé


27/05/2020 10:22:42 | insertOrder() : DL_MontantHT : 78 = DL_PrixUnitaire : 19.500000 X DL_QteBC : 4.00
27/05/2020 10:22:42 | insertOrder() : DL_MontantTTC : 93.7326 = DL_PUTTC : 23.43315 X DL_QteBC : 4.00
27/05/2020 10:22:42 | insertCommandeLine() : Called!
27/05/2020 10:22:42 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BOHEME_STANDY_MINI','01LMOSTWALD2',7, 'LAMPE EXTERIEURE BOHEME LUMISKY',1,19.500000,4.00,'Carton de 8',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202712',1,0,0,'', NULL,'56039693',3440000.00,3440000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,23.43315, 'BC202712', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 78, 93.7326)
27/05/2020 10:22:42 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:22:42 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:22:42 | insertOrder() : Additionner le total HT (19.500000) et TTC (23.43315)

27/05/2020 10:22:42 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:22:42 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BOHEME_STANDY_MINI' and DE_No = 1
27/05/2020 10:22:42 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:22:42 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:22:42 | insertOrder() : List des TVA trouvé
27/05/2020 10:22:42 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:22:42 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:22:42 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:22:42 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:22:42 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:22:42 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:22:42 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:22:42 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:22:42 | insertOrder() : Prix TTC créé


27/05/2020 10:22:42 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 10:22:42 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 10:22:42 | insertCommandeLine() : Called!
27/05/2020 10:22:42 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMOSTWALD2',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202712',1,0,0,'', NULL,'56039693',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202712', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 10:22:42 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:22:42 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:22:42 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:22:42 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:22:42 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:22:42 | insertOrder() : Aucune reponse.

27/05/2020 10:22:42 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56039693
27/05/2020 10:22:42 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 41.4 WHERE DO_PIECE = 'BC202712' 


27/05/2020 10:22:42 : 2/2 ligne(s) enregistrée(s).


27/05/2020 10:22:42 : Le fichier 'E:\EDI\EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102242__56039693__EDI_ORDERS.56039693.773982.BATIMEX.3025940019900.20200527.202005270124.RECU.IN.csv



27/05/2020 10:22:42 : -----> Fichier 15/21 : EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv
27/05/2020 10:22:42 : Scan fichier...
27/05/2020 10:22:42 : Import Commande Manuel.
27/05/2020 10:22:46 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:22:49 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='56040285'
27/05/2020 10:23:42 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940029800' and CT_Type=0
27/05/2020 10:23:48 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940029800' and CT_Type=0
27/05/2020 10:23:51 | existeFourniseur() : id '3779000001461'
27/05/2020 10:23:54 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:23:54 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:23:55 | get_adresse_livraison() : Called1
27/05/2020 10:23:58 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMBASTIAFURIANI'
27/05/2020 10:23:58 | getDevise() : Code ISO 'EUR'
27/05/2020 10:24:01 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:24:01 | getDevise() : Devise trouvé!
27/05/2020 10:24:02 : ORDHD1 trouvé.

27/05/2020 10:24:02 : ORDLIN trouvé.
27/05/2020 10:24:02 : ORDLIN line 1 / 5.
27/05/2020 10:24:02 : ORDLIN line 1 / 5.
27/05/2020 10:24:02 : ORDLIN line 1 / 5.
27/05/2020 10:24:02 | getArticle() : Code Article : 3760093542883
27/05/2020 10:24:02 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542883' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:24:02 | getArticle() : Article trouvé!
27/05/2020 10:24:02 | getConditionnementArticle() : Code Article : COOPER
27/05/2020 10:24:05 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='COOPER'
27/05/2020 10:24:05 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:24:05 : tab ===> line.article.Conditionnement
27/05/2020 10:24:05 | Calcule_conditionnement() : Qte '8,00', Qte conditionnement '4'
27/05/2020 10:24:05 | Calcule_conditionnement() : calcule... Valeur = 2, Reste = 0
27/05/2020 10:24:05 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 2

27/05/2020 10:24:05 : ********************** Prix *********************
27/05/2020 10:24:05 : Prix trouvé dans le fichier EDI => 16,07 && Prix trouvé dans Sage => 15,900000

27/05/2020 10:24:05 : ********************** Warning Prix *********************
27/05/2020 10:24:05 : Prix de l'article COOPER(3760093542883) dans la base est : 15,900000
Il est différent du prix envoyer par le client : 16,07.
27/05/2020 10:24:05 : Utilise le prix de la base : 15,900000.

27/05/2020 10:24:05 : ORDLIN line 1 / 5.
27/05/2020 10:24:05 | getArticle() : Code Article : 3760093542906
27/05/2020 10:24:05 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760093542906' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:24:05 | getArticle() : Article trouvé!
27/05/2020 10:24:05 | getConditionnementArticle() : Code Article : BLACKBURN
27/05/2020 10:24:08 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='BLACKBURN'
27/05/2020 10:24:08 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:24:09 : tab ===> line.article.Conditionnement
27/05/2020 10:24:09 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:24:09 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:24:09 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:24:09 : ********************** Prix *********************
27/05/2020 10:24:09 : Prix trouvé dans le fichier EDI => 22,07 && Prix trouvé dans Sage => 21,900000

27/05/2020 10:24:09 : ********************** Warning Prix *********************
27/05/2020 10:24:09 : Prix de l'article BLACKBURN(3760093542906) dans la base est : 21,900000
Il est différent du prix envoyer par le client : 22,07.
27/05/2020 10:24:09 : Utilise le prix de la base : 21,900000.

27/05/2020 10:24:09 : ORDLIN line 1 / 5.
27/05/2020 10:24:09 | getStockId() : Called!
27/05/2020 10:24:12 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:24:12 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:24:12 | getNumLivraison() : Client Numéro => 01LMBASTIAFURIANI
27/05/2020 10:24:16 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMBASTIAFURIANI' and li_principal=1
27/05/2020 10:24:16 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:24:16 | insertOrder() : Récupére tous les tva
27/05/2020 10:24:16 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:24:16 | insertCommande() : Called!
27/05/2020 10:24:19 : insertCommande() | called!
27/05/2020 10:24:19 : insertCommande() | Requette pour Batimex.
27/05/2020 10:24:19 : insertCommande() | ODBC.
27/05/2020 10:24:19 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMBASTIAFURIANI',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-05'},0,0,1,0,1,1,'BC202713','/56040285',21,2,1,'01LMBASTIAFURIANI',11,0,1,1,0,1097,1,'3025940029800;3779000001461','56040285',20,0,0)
27/05/2020 10:24:19 : insertCommande() | called!
27/05/2020 10:24:19 : insertCommande() | Requette pour Batimex.
27/05/2020 10:24:19 : insertCommande() | ODBC.
27/05/2020 10:24:21 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article COOPER
27/05/2020 10:24:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='COOPER' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:24:21 | insertOrder() : List des TVA trouvé
27/05/2020 10:24:21 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:24:21 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:24:21 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:24:21 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:24:21 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:24:21 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:24:21 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:24:21 | insertOrder() : Prix HT => 15,9 | TVA => 20,17 % | Prix TTC => 19,10703
27/05/2020 10:24:21 | insertOrder() : Prix TTC créé


27/05/2020 10:24:21 | insertOrder() : DL_MontantHT : 127.2 = DL_PrixUnitaire : 15.900000 X DL_QteBC : 8.00
27/05/2020 10:24:21 | insertOrder() : DL_MontantTTC : 152.85624 = DL_PUTTC : 19.10703 X DL_QteBC : 8.00
27/05/2020 10:24:21 | insertCommandeLine() : Called!
27/05/2020 10:24:21 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','COOPER','01LMBASTIAFURIANI',7, 'PROJ DET SOLAIRE 1000LM NOIR PLS BA',1,15.900000,8.00,'Carton de 4',2,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202713',1,0,0,'', NULL,'56040285',10400000.00,10400000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,19.10703, 'BC202713', '', 0.000000, 8.00, 8.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 127.2, 152.85624)
27/05/2020 10:24:21 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:24:21 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:24:21 | insertOrder() : Additionner le total HT (15.900000) et TTC (19.10703)

27/05/2020 10:24:21 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:24:21 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'COOPER' and DE_No = 1
27/05/2020 10:24:21 | insertOrder() : Aucune reponse.

Récupérer les TVA des l'article BLACKBURN
27/05/2020 10:24:21 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='BLACKBURN' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:24:21 | insertOrder() : List des TVA trouvé
27/05/2020 10:24:21 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:24:21 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:24:21 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:24:21 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:24:21 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:24:21 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:24:21 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:24:21 | insertOrder() : Prix HT => 21,9 | TVA => 20,17 % | Prix TTC => 26,31723
27/05/2020 10:24:21 | insertOrder() : Prix TTC créé


27/05/2020 10:24:21 | insertOrder() : DL_MontantHT : 87.6 = DL_PrixUnitaire : 21.900000 X DL_QteBC : 4.00
27/05/2020 10:24:21 | insertOrder() : DL_MontantTTC : 105.26892 = DL_PUTTC : 26.31723 X DL_QteBC : 4.00
27/05/2020 10:24:21 | insertCommandeLine() : Called!
27/05/2020 10:24:21 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','BLACKBURN','01LMBASTIAFURIANI',7, 'PROJ DET SOLAIRE TRY 1500LM PLS BAT',2,21.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-05'},0,'BC202713',1,0,0,'', NULL,'56040285',7200000.00,7200000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,26.31723, 'BC202713', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 87.6, 105.26892)
27/05/2020 10:24:22 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:24:22 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:24:22 | insertOrder() : Additionner le total HT (21.900000) et TTC (26.31723)

27/05/2020 10:24:22 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:24:22 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'BLACKBURN' and DE_No = 1
27/05/2020 10:24:22 | insertOrder() : Aucune reponse.

27/05/2020 10:24:22 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 56040285
27/05/2020 10:24:22 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 37.8 WHERE DO_PIECE = 'BC202713' 


27/05/2020 10:24:22 : 2/2 ligne(s) enregistrée(s).


27/05/2020 10:24:22 : Le fichier 'E:\EDI\EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102422__56040285__EDI_ORDERS.56040285.774006.BATIMEX.3025940029800.20200527.202005270125.RECU.IN.csv



27/05/2020 10:24:22 : -----> Fichier 16/21 : EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv
27/05/2020 10:24:22 : Scan fichier...
27/05/2020 10:24:22 : Import Commande Manuel.
27/05/2020 10:24:25 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:24:29 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='80026619'
27/05/2020 10:25:16 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019200' and CT_Type=0
27/05/2020 10:25:22 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019200' and CT_Type=0
27/05/2020 10:25:25 | existeFourniseur() : id '3779000001461'
27/05/2020 10:25:28 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:25:28 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:25:29 | get_adresse_livraison() : Called1
27/05/2020 10:25:32 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMFREJUS'
27/05/2020 10:25:32 | getDevise() : Code ISO 'EUR'
27/05/2020 10:25:35 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:25:36 | getDevise() : Devise trouvé!
27/05/2020 10:25:36 : ORDHD1 trouvé.

27/05/2020 10:25:36 : ORDLIN trouvé.
27/05/2020 10:25:36 : ORDLIN line 1 / 4.
27/05/2020 10:25:36 : ORDLIN line 1 / 4.
27/05/2020 10:25:36 : ORDLIN line 1 / 4.
27/05/2020 10:25:36 | getArticle() : Code Article : 3760119730690
27/05/2020 10:25:36 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:25:36 | getArticle() : Article trouvé!
27/05/2020 10:25:36 | getConditionnementArticle() : Code Article : VINTY_LIGHT
27/05/2020 10:25:39 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
27/05/2020 10:25:39 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:25:40 : tab ===> line.article.Conditionnement
27/05/2020 10:25:40 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:25:40 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:25:40 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:25:40 : ********************** Prix *********************
27/05/2020 10:25:40 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

27/05/2020 10:25:40 : ********************** Warning Prix *********************
27/05/2020 10:25:40 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
27/05/2020 10:25:40 : Utilise le prix de la base : 36,900000.

27/05/2020 10:25:40 : ORDLIN line 1 / 4.
27/05/2020 10:25:40 | getStockId() : Called!
27/05/2020 10:25:43 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:25:43 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:25:43 | getNumLivraison() : Client Numéro => 01LMFREJUS
27/05/2020 10:25:47 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMFREJUS' and li_principal=1
27/05/2020 10:25:47 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:25:47 | insertOrder() : Récupére tous les tva
27/05/2020 10:25:47 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:25:47 | insertCommande() : Called!
27/05/2020 10:25:50 : insertCommande() | called!
27/05/2020 10:25:50 : insertCommande() | Requette pour Batimex.
27/05/2020 10:25:50 : insertCommande() | ODBC.
27/05/2020 10:25:50 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMFREJUS',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202714','/80026619',21,2,1,'01LMFREJUS',11,0,1,1,0,2898,1,'3025940019200;3779000001461','80026619',20,0,0)
27/05/2020 10:25:50 : insertCommande() | called!
27/05/2020 10:25:50 : insertCommande() | Requette pour Batimex.
27/05/2020 10:25:50 : insertCommande() | ODBC.
27/05/2020 10:25:51 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
27/05/2020 10:25:51 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:25:51 | insertOrder() : List des TVA trouvé
27/05/2020 10:25:51 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:25:51 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:25:51 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:25:51 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:25:51 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:25:51 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:25:51 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:25:51 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
27/05/2020 10:25:51 | insertOrder() : Prix TTC créé


27/05/2020 10:25:51 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
27/05/2020 10:25:51 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
27/05/2020 10:25:51 | insertCommandeLine() : Called!
27/05/2020 10:25:51 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMFREJUS',7, 'LIGHT LUMISKY',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202714',1,0,0,'', NULL,'80026619',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202714', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
27/05/2020 10:25:51 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:25:51 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:25:51 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

27/05/2020 10:25:51 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:25:51 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
27/05/2020 10:25:51 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (564,000000), AS_StockMontant (0,000000).

27/05/2020 10:25:51 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:25:51 | insertOrder() : new_AS_StockReserve: 568 = AS_StockReserve: 564 + Quantite: 4
27/05/2020 10:25:51 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
27/05/2020 10:25:51 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:25:51 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 10:25:51 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 568, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

27/05/2020 10:25:51 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 80026619
27/05/2020 10:25:51 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202714' 


27/05/2020 10:25:51 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:25:51 : Le fichier 'E:\EDI\EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102551__80026619__EDI_ORDERS.80026619.773997.BATIMEX.3025940019200.20200527.202005270125.RECU.IN.csv



27/05/2020 10:25:51 : -----> Fichier 17/21 : EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv
27/05/2020 10:25:51 : Scan fichier...
27/05/2020 10:25:51 : Import Commande Manuel.
27/05/2020 10:25:55 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:25:58 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='81877187'
27/05/2020 10:26:47 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
27/05/2020 10:26:53 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
27/05/2020 10:26:57 | existeFourniseur() : id '3779000001461'
27/05/2020 10:27:00 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:27:00 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:27:01 | get_adresse_livraison() : Called1
27/05/2020 10:27:04 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMSTJEAN'
27/05/2020 10:27:05 | getDevise() : Code ISO 'EUR'
27/05/2020 10:27:08 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:27:08 | getDevise() : Devise trouvé!
27/05/2020 10:27:08 : ORDHD1 trouvé.

27/05/2020 10:27:08 : ORDLIN trouvé.
27/05/2020 10:27:08 : ORDLIN line 1 / 4.
27/05/2020 10:27:08 : ORDLIN line 1 / 4.
27/05/2020 10:27:08 : ORDLIN line 1 / 4.
27/05/2020 10:27:08 | getArticle() : Code Article : 3760119739013
27/05/2020 10:27:08 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119739013' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:27:08 | getArticle() : Article trouvé!
27/05/2020 10:27:08 | getConditionnementArticle() : Code Article : MAFY_LIGHT
27/05/2020 10:27:12 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='MAFY_LIGHT'
27/05/2020 10:27:12 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:27:12 : tab ===> line.article.Conditionnement
27/05/2020 10:27:12 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:27:12 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:27:12 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:27:12 : ********************** Prix *********************
27/05/2020 10:27:12 : Prix trouvé dans le fichier EDI => 26,07 && Prix trouvé dans Sage => 25,900000

27/05/2020 10:27:12 : ********************** Warning Prix *********************
27/05/2020 10:27:12 : Prix de l'article MAFY_LIGHT(3760119739013) dans la base est : 25,900000
Il est différent du prix envoyer par le client : 26,07.
27/05/2020 10:27:12 : Utilise le prix de la base : 25,900000.

27/05/2020 10:27:12 : ORDLIN line 1 / 4.
27/05/2020 10:27:12 | getStockId() : Called!
27/05/2020 10:27:15 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:27:15 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:27:16 | getNumLivraison() : Client Numéro => 01LMSTJEAN
27/05/2020 10:27:19 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMSTJEAN' and li_principal=1
27/05/2020 10:27:19 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:27:20 | insertOrder() : Récupére tous les tva
27/05/2020 10:27:20 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:27:20 | insertCommande() : Called!
27/05/2020 10:27:23 : insertCommande() | called!
27/05/2020 10:27:23 : insertCommande() | Requette pour Batimex.
27/05/2020 10:27:23 : insertCommande() | ODBC.
27/05/2020 10:27:23 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMSTJEAN',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-08'},0,0,1,0,1,1,'BC202715','/81877187',21,2,1,'01LMSTJEAN',11,0,1,1,0,87,1,'3025940001500;3779000001461','81877187',20,0,0)
27/05/2020 10:27:23 : insertCommande() | called!
27/05/2020 10:27:23 : insertCommande() | Requette pour Batimex.
27/05/2020 10:27:23 : insertCommande() | ODBC.
27/05/2020 10:27:24 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article MAFY_LIGHT
27/05/2020 10:27:24 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='MAFY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:27:24 | insertOrder() : List des TVA trouvé
27/05/2020 10:27:24 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:27:24 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:27:24 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:27:24 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:27:24 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:27:24 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:27:24 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:27:24 | insertOrder() : Prix HT => 25,9 | TVA => 20,17 % | Prix TTC => 31,12403
27/05/2020 10:27:24 | insertOrder() : Prix TTC créé


27/05/2020 10:27:24 | insertOrder() : DL_MontantHT : 103.6 = DL_PrixUnitaire : 25.900000 X DL_QteBC : 4.00
27/05/2020 10:27:24 | insertOrder() : DL_MontantTTC : 124.49612 = DL_PUTTC : 31.12403 X DL_QteBC : 4.00
27/05/2020 10:27:24 | insertCommandeLine() : Called!
27/05/2020 10:27:24 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','MAFY_LIGHT','01LMSTJEAN',7, 'GUIRLANDE EXT 6M MAFY LIGHT LUMISKY',1,25.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-08'},0,'BC202715',1,0,0,'', NULL,'81877187',6800000.00,6800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,31.12403, 'BC202715', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 103.6, 124.49612)
27/05/2020 10:27:24 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:27:24 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:27:24 | insertOrder() : Additionner le total HT (25.900000) et TTC (31.12403)

27/05/2020 10:27:24 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:27:24 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1
27/05/2020 10:27:24 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (292,000000), AS_StockMontant (0,000000).

27/05/2020 10:27:24 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:27:24 | insertOrder() : new_AS_StockReserve: 296 = AS_StockReserve: 292 + Quantite: 4
27/05/2020 10:27:24 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 25,9
27/05/2020 10:27:24 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:27:24 | insertOrder() : update article MAFY LIGHT GUIRLANDE CABLE AVEC AMPOULES (Ref:MAFY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 10:27:24 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 296, AS_MontSto = 0 WHERE AR_Ref = 'MAFY_LIGHT' and DE_No = 1

27/05/2020 10:27:24 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 81877187
27/05/2020 10:27:24 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 25.9 WHERE DO_PIECE = 'BC202715' 


27/05/2020 10:27:24 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:27:24 : Le fichier 'E:\EDI\EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102724__81877187__EDI_ORDERS.81877187.774002.BATIMEX.3025940001500.20200527.202005270125.RECU.IN.csv



27/05/2020 10:27:24 : -----> Fichier 18/21 : EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv
27/05/2020 10:27:24 : Scan fichier...
27/05/2020 10:27:24 : Import Commande Manuel.
27/05/2020 10:27:27 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:27:31 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='81877191'
27/05/2020 10:28:34 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
27/05/2020 10:28:40 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940001500' and CT_Type=0
27/05/2020 10:28:43 | existeFourniseur() : id '3779000001461'
27/05/2020 10:28:47 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:28:47 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:28:48 | get_adresse_livraison() : Called1
27/05/2020 10:28:51 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMSTJEAN'
27/05/2020 10:28:52 | getDevise() : Code ISO 'EUR'
27/05/2020 10:28:55 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:28:55 | getDevise() : Devise trouvé!
27/05/2020 10:28:56 : ORDHD1 trouvé.

27/05/2020 10:28:56 : ORDLIN trouvé.
27/05/2020 10:28:56 : ORDLIN line 1 / 4.
27/05/2020 10:28:56 : ORDLIN line 1 / 4.
27/05/2020 10:28:56 : ORDLIN line 1 / 4.
27/05/2020 10:28:56 | getArticle() : Code Article : 3760119730485
27/05/2020 10:28:56 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730485' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:28:56 | getArticle() : Article trouvé!
27/05/2020 10:28:56 | getConditionnementArticle() : Code Article : G22/10
27/05/2020 10:28:59 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='G22/10'
27/05/2020 10:28:59 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:28:59 : tab ===> line.article.Conditionnement
27/05/2020 10:28:59 | Calcule_conditionnement() : Qte '2,00', Qte conditionnement '2'
27/05/2020 10:28:59 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:28:59 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:28:59 : ********************** Prix *********************
27/05/2020 10:28:59 : Prix trouvé dans le fichier EDI => 60,28 && Prix trouvé dans Sage => 59,900000

27/05/2020 10:28:59 : ********************** Warning Prix *********************
27/05/2020 10:28:59 : Prix de l'article G22/10(3760119730485) dans la base est : 59,900000
Il est différent du prix envoyer par le client : 60,28.
27/05/2020 10:28:59 : Utilise le prix de la base : 59,900000.

27/05/2020 10:28:59 : ORDLIN line 1 / 4.
27/05/2020 10:28:59 | getStockId() : Called!
27/05/2020 10:29:03 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:29:03 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:29:03 | getNumLivraison() : Client Numéro => 01LMSTJEAN
27/05/2020 10:29:07 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMSTJEAN' and li_principal=1
27/05/2020 10:29:07 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:29:07 | insertOrder() : Récupére tous les tva
27/05/2020 10:29:07 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:29:07 | insertCommande() : Called!
27/05/2020 10:29:11 : insertCommande() | called!
27/05/2020 10:29:11 : insertCommande() | Requette pour Batimex.
27/05/2020 10:29:11 : insertCommande() | ODBC.
27/05/2020 10:29:11 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMSTJEAN',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-19'},0,0,1,0,1,1,'BC202716','/81877191',21,2,1,'01LMSTJEAN',11,0,1,1,0,87,1,'3025940001500;3779000001461','81877191',20,0,0)
27/05/2020 10:29:11 : insertCommande() | called!
27/05/2020 10:29:11 : insertCommande() | Requette pour Batimex.
27/05/2020 10:29:11 : insertCommande() | ODBC.
27/05/2020 10:29:12 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article G22/10
27/05/2020 10:29:12 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='G22/10' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO38 || DL_CodeTaxe3 : 


27/05/2020 10:29:12 | insertOrder() : List des TVA trouvé
27/05/2020 10:29:12 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:29:12 | insertOrder() : TVA 2 ECO38 trouvé "0,380000"
27/05/2020 10:29:12 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:29:12 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:29:12 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:29:12 | insertOrder() : TVA 2 => 0.380000
27/05/2020 10:29:12 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:29:12 | insertOrder() : Prix HT => 59,9 | TVA => 20,38 % | Prix TTC => 72,10762
27/05/2020 10:29:12 | insertOrder() : Prix TTC créé


27/05/2020 10:29:12 | insertOrder() : DL_MontantHT : 119.8 = DL_PrixUnitaire : 59.900000 X DL_QteBC : 2.00
27/05/2020 10:29:12 | insertOrder() : DL_MontantTTC : 144.21524 = DL_PUTTC : 72.10762 X DL_QteBC : 2.00
27/05/2020 10:29:13 | insertCommandeLine() : Called!
27/05/2020 10:29:13 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','G22/10','01LMSTJEAN',7, 'GUIRLANDE EXT 10M CHERRY LIGHT LUMI',1,59.900000,2.00,'Carton de 2',1,1, {d '2020-05-27'}, {d '2020-06-19'},0,'BC202716',1,0,0,'', NULL,'81877191',8800000.00,8800000.00,'V20', 20.000000,0,0, 'ECO38',0.380000,2,2,72.10762, 'BC202716', '', 0.000000, 2.00, 2.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 119.8, 144.21524)
27/05/2020 10:29:13 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:29:13 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:29:13 | insertOrder() : Additionner le total HT (59.900000) et TTC (72.10762)

27/05/2020 10:29:13 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:29:13 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'G22/10' and DE_No = 1
27/05/2020 10:29:13 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (2,000000), AS_StockMontant (0,000000).

27/05/2020 10:29:13 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:29:13 | insertOrder() : new_AS_StockReserve: 4 = AS_StockReserve: 2 + Quantite: 2
27/05/2020 10:29:13 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 59,9
27/05/2020 10:29:13 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:29:13 | insertOrder() : update article CHERRY W10 GUIRLANDE BLANCHE SECTEUR 10 M (Ref:G22/10) stock in F_ARTSTOCK table in the database
27/05/2020 10:29:13 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 4, AS_MontSto = 0 WHERE AR_Ref = 'G22/10' and DE_No = 1

27/05/2020 10:29:13 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 81877191
27/05/2020 10:29:13 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 59.9 WHERE DO_PIECE = 'BC202716' 


27/05/2020 10:29:14 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:29:14 : Le fichier 'E:\EDI\EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020102914__81877191__EDI_ORDERS.81877191.773984.BATIMEX.3025940001500.20200527.202005270124.RECU.IN.csv



27/05/2020 10:29:14 : -----> Fichier 19/21 : EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv
27/05/2020 10:29:14 : Scan fichier...
27/05/2020 10:29:14 : Import Commande Manuel.
27/05/2020 10:29:17 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:29:21 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='83953968'
27/05/2020 10:30:15 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019500' and CT_Type=0
27/05/2020 10:30:21 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940019500' and CT_Type=0
27/05/2020 10:30:25 | existeFourniseur() : id '3779000001461'
27/05/2020 10:30:28 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:30:28 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:30:29 | get_adresse_livraison() : Called1
27/05/2020 10:30:32 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMVEDENE'
27/05/2020 10:30:33 | getDevise() : Code ISO 'EUR'
27/05/2020 10:30:37 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:30:37 | getDevise() : Devise trouvé!
27/05/2020 10:30:37 : ORDHD1 trouvé.

27/05/2020 10:30:37 : ORDLIN trouvé.
27/05/2020 10:30:37 : ORDLIN line 1 / 4.
27/05/2020 10:30:37 : ORDLIN line 1 / 4.
27/05/2020 10:30:37 : ORDLIN line 1 / 4.
27/05/2020 10:30:37 | getArticle() : Code Article : 3760119730690
27/05/2020 10:30:37 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:30:37 | getArticle() : Article trouvé!
27/05/2020 10:30:37 | getConditionnementArticle() : Code Article : VINTY_LIGHT
27/05/2020 10:30:41 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
27/05/2020 10:30:41 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:30:41 : tab ===> line.article.Conditionnement
27/05/2020 10:30:41 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:30:41 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:30:41 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:30:41 : ********************** Prix *********************
27/05/2020 10:30:41 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

27/05/2020 10:30:41 : ********************** Warning Prix *********************
27/05/2020 10:30:41 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
27/05/2020 10:30:41 : Utilise le prix de la base : 36,900000.

27/05/2020 10:30:41 : ORDLIN line 1 / 4.
27/05/2020 10:30:41 | getStockId() : Called!
27/05/2020 10:30:45 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:30:45 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:30:45 | getNumLivraison() : Client Numéro => 01LMVEDENE
27/05/2020 10:30:49 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMVEDENE' and li_principal=1
27/05/2020 10:30:49 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:30:49 | insertOrder() : Récupére tous les tva
27/05/2020 10:30:49 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:30:49 | insertCommande() : Called!
27/05/2020 10:30:53 : insertCommande() | called!
27/05/2020 10:30:53 : insertCommande() | Requette pour Batimex.
27/05/2020 10:30:53 : insertCommande() | ODBC.
27/05/2020 10:30:53 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMVEDENE',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-09'},0,0,1,0,1,1,'BC202717','/83953968',21,2,1,'01LMVEDENE',11,0,1,1,0,1006,1,'3025940019500;3779000001461','83953968',20,0,0)
27/05/2020 10:30:53 : insertCommande() | called!
27/05/2020 10:30:53 : insertCommande() | Requette pour Batimex.
27/05/2020 10:30:53 : insertCommande() | ODBC.
27/05/2020 10:30:55 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
27/05/2020 10:30:55 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:30:55 | insertOrder() : List des TVA trouvé
27/05/2020 10:30:55 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:30:55 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:30:55 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:30:55 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:30:55 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:30:55 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:30:55 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:30:55 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
27/05/2020 10:30:55 | insertOrder() : Prix TTC créé


27/05/2020 10:30:55 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
27/05/2020 10:30:55 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
27/05/2020 10:30:55 | insertCommandeLine() : Called!
27/05/2020 10:30:55 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMVEDENE',7, 'LIGHT LUMISKY',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-09'},0,'BC202717',1,0,0,'', NULL,'83953968',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202717', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
27/05/2020 10:30:55 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:30:55 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:30:55 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

27/05/2020 10:30:55 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:30:55 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
27/05/2020 10:30:55 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (568,000000), AS_StockMontant (0,000000).

27/05/2020 10:30:55 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:30:55 | insertOrder() : new_AS_StockReserve: 572 = AS_StockReserve: 568 + Quantite: 4
27/05/2020 10:30:55 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
27/05/2020 10:30:55 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:30:55 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 10:30:55 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 572, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

27/05/2020 10:30:55 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 83953968
27/05/2020 10:30:55 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202717' 


27/05/2020 10:30:56 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:30:56 : Le fichier 'E:\EDI\EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020103056__83953968__EDI_ORDERS.83953968.773988.BATIMEX.3025940019500.20200527.202005270124.RECU.IN.csv



27/05/2020 10:30:56 : -----> Fichier 20/21 : EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv
27/05/2020 10:30:56 : Scan fichier...
27/05/2020 10:30:56 : Import Commande Manuel.
27/05/2020 10:30:59 | get_next_num_piece_commande() : SQL - SELECT DC_PIECE FROM F_DOCCURRENTPIECE WHERE DC_IDCOL=1 and DC_SOUCHE=0
27/05/2020 10:31:03 | existeCommande() : SQL ===> SELECT DO_PIECE FROM F_DOCENTETE WHERE DO_COORD01='86923464'
27/05/2020 10:31:53 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006400' and CT_Type=0
27/05/2020 10:32:00 | getClient() : SQL => SELECT CT_Num, CG_NumPrinc, CT_NumPayeur, N_Condition, N_Devise,  N_Expedition, CT_Langue, CT_Facture, N_Period, N_CatTarif, CT_Taux02, N_CatCompta, CT_NumCentrale, CT_Intitule FROM F_COMPTET where CT_EdiCode='3025940006400' and CT_Type=0
27/05/2020 10:32:03 | existeFourniseur() : id '3779000001461'
27/05/2020 10:32:07 | existeFourniseur() : SQL ===> SELECT CT_Num FROM F_COMPTET where CT_EdiCode='3779000001461' and CT_Type=1
27/05/2020 10:32:07 | existeFourniseur() : Fournisseur trouvé!
27/05/2020 10:32:08 | get_adresse_livraison() : Called1
27/05/2020 10:32:11 | get_adresse_livraison() : SQL ===> Select li_no,li_contact,Li_adresse,li_codepostal,li_ville,li_pays from f_livraison where li_pays='' and li_codepostal='' and li_ville='' and Li_adresse='' and li_contact='' and CT_NUM='01LMROUENTOURVILL'
27/05/2020 10:32:12 | getDevise() : Code ISO 'EUR'
27/05/2020 10:32:16 | getDevise() : SQL ===> select CBINDICE from P_DEVISE where D_CODEISO='EUR'
27/05/2020 10:32:16 | getDevise() : Devise trouvé!
27/05/2020 10:32:16 : ORDHD1 trouvé.

27/05/2020 10:32:16 : ORDLIN trouvé.
27/05/2020 10:32:16 : ORDLIN line 1 / 4.
27/05/2020 10:32:16 : ORDLIN line 1 / 4.
27/05/2020 10:32:16 : ORDLIN line 1 / 4.
27/05/2020 10:32:16 | getArticle() : Code Article : 3760119730690
27/05/2020 10:32:16 | getArticle() : SQL ===>  SELECT ar.AR_REF, ar.AR_CodeBarre, ar.AR_SuiviStock, ar.AR_Gamme1, ar.AR_Gamme2, ar.AR_Nomencl, ar.RP_CODEDEFAUT, arc.AC_PrixVen, ar.AR_POIDSBRUT, ar.AR_POIDSNET, ar.AR_UnitePoids, ar.AR_DESIGN, ar.AR_PrixAch from BATIMEX.dbo.F_ARTICLE as ar, BATIMEX.dbo.F_ARTCLIENT as arc, BATIMEX.dbo.f_comptetg as CG where ar.AR_Ref = arc.AR_Ref and arc.CT_Num = CG.CT_Num and ar.AR_CODEBARRE='3760119730690' and CG.CT_Num = '01LMFRANCESA'
27/05/2020 10:32:16 | getArticle() : Article trouvé!
27/05/2020 10:32:16 | getConditionnementArticle() : Code Article : VINTY_LIGHT
27/05/2020 10:32:20 | getConditionnementArticle() : SQL ===> select EC_ENUMERE,EC_QUANTITE FROM F_CONDITION where CO_Principal = 1 and AR_REF='VINTY_LIGHT'
27/05/2020 10:32:20 | getConditionnementArticle() : Conditionnement trouvé! 
27/05/2020 10:32:21 : tab ===> line.article.Conditionnement
27/05/2020 10:32:21 | Calcule_conditionnement() : Qte '4,00', Qte conditionnement '4'
27/05/2020 10:32:21 | Calcule_conditionnement() : calcule... Valeur = 1, Reste = 0
27/05/2020 10:32:21 | Calcule_conditionnement() : Reste == 0, alors return Valeur : 1

27/05/2020 10:32:21 : ********************** Prix *********************
27/05/2020 10:32:21 : Prix trouvé dans le fichier EDI => 37,07 && Prix trouvé dans Sage => 36,900000

27/05/2020 10:32:21 : ********************** Warning Prix *********************
27/05/2020 10:32:21 : Prix de l'article VINTY_LIGHT(3760119730690) dans la base est : 36,900000
Il est différent du prix envoyer par le client : 37,07.
27/05/2020 10:32:21 : Utilise le prix de la base : 36,900000.

27/05/2020 10:32:21 : ORDLIN line 1 / 4.
27/05/2020 10:32:21 | getStockId() : Called!
27/05/2020 10:32:25 | getStockId() : SQL ===> select DE_NO FROM F_Depot where DE_Principal = 1
27/05/2020 10:32:25 | getStockId() : Stock trouvé,  ID => 7
27/05/2020 10:32:25 | getNumLivraison() : Client Numéro => 01LMROUENTOURVILL
27/05/2020 10:32:29 | getNumLivraison() : SQL ===> select LI_NO FROM F_LIVRAISON where CT_NUM = '01LMROUENTOURVILL' and li_principal=1
27/05/2020 10:32:29 | getNumLivraison() : Numero de livraison existe pour le client!

27/05/2020 10:32:29 | insertOrder() : Récupére tous les tva
27/05/2020 10:32:29 | insertOrder() : SQL ===> SELECT TA_Intitule, TA_Taux, CG_Num, TA_Code, cbMarq FROM BATIMEX.dbo.F_TAXE 
27/05/2020 10:32:29 | insertCommande() : Called!
27/05/2020 10:32:33 : insertCommande() | called!
27/05/2020 10:32:33 : insertCommande() | Requette pour Batimex.
27/05/2020 10:32:33 : insertCommande() | ODBC.
27/05/2020 10:32:33 | insertCommande() : SQL ===> Insert into F_DOCENTETE(CG_NUM,CT_NUMPAYEUR,DE_NO,DO_ATTENTE,DO_BLFACT,DO_CLOTURE,DO_COLISAGE,DO_CONDITION,DO_DATE,DO_DATELIVR,DO_DEVISE,DO_DOMAINE,DO_EXPEDIT,DO_LANGUE,DO_NBFACTURE,DO_PERIOD,DO_PIECE,DO_REF,DO_REGIME,DO_STATUT,DO_TARIF,DO_TIERS,DO_TRANSACTION,DO_TXESCOMPTE,DO_TYPE,DO_TYPECOLIS,DO_VENTILE,LI_NO,N_CATCOMPTA,DO_MOTIF,DO_COORD01,DO_TAXE1,DO_TypeTaux1,DO_TypeTaxe1) values('41100000','01LMROUENTOURVILL',7,0,0,0,1,1, {d '2020-05-27'}, {d '2020-06-09'},0,0,1,0,1,1,'BC202718','/86923464',21,2,1,'01LMROUENTOURVILL',11,0,1,1,0,3033,1,'3025940006400;3779000001461','86923464',20,0,0)
27/05/2020 10:32:33 : insertCommande() | called!
27/05/2020 10:32:33 : insertCommande() | Requette pour Batimex.
27/05/2020 10:32:33 : insertCommande() | ODBC.
27/05/2020 10:32:35 | insertCommande() : Commande enregisté!!!

Récupérer les TVA des l'article VINTY_LIGHT
27/05/2020 10:32:35 | insertOrder() : SQL ===> SELECT ACP_ComptaCPT_Taxe1, ACP_ComptaCPT_Taxe2, ACP_ComptaCPT_Taxe3 from BATIMEX.dbo.F_ARTCOMPTA where AR_Ref='VINTY_LIGHT' and ACP_ComptaCPT_CompteG = '70702000'
DL_CodeTaxe1 : V20 || DL_CodeTaxe2 : ECO17 || DL_CodeTaxe3 : 


27/05/2020 10:32:35 | insertOrder() : List des TVA trouvé
27/05/2020 10:32:35 | insertOrder() : TVA 1 V20 trouvé "20,000000"
27/05/2020 10:32:35 | insertOrder() : TVA 2 ECO17 trouvé "0,170000"
27/05/2020 10:32:35 | insertOrder() : TVA 3 VIDE trouvé, alors TVA mis à 0

27/05/2020 10:32:35 | insertOrder() : ******************** Calcule TVA ******************** 
27/05/2020 10:32:35 | insertOrder() : TVA 1 => 20.000000
27/05/2020 10:32:35 | insertOrder() : TVA 2 => 0.170000
27/05/2020 10:32:35 | insertOrder() : TVA 3 => 0.000000
27/05/2020 10:32:35 | insertOrder() : Prix HT => 36,9 | TVA => 20,17 % | Prix TTC => 44,34273
27/05/2020 10:32:35 | insertOrder() : Prix TTC créé


27/05/2020 10:32:35 | insertOrder() : DL_MontantHT : 147.6 = DL_PrixUnitaire : 36.900000 X DL_QteBC : 4.00
27/05/2020 10:32:35 | insertOrder() : DL_MontantTTC : 177.37092 = DL_PUTTC : 44.34273 X DL_QteBC : 4.00
27/05/2020 10:32:35 | insertCommandeLine() : Called!
27/05/2020 10:32:35 | insertCommandeLine() : SQL ===> Insert Into BATIMEX.dbo.F_DOCLIGNE(PF_Num, AC_REFCLIENT,AF_REFFOURNISS,AR_REF,CT_NUM,DE_NO,DL_DESIGN,DL_LIGNE,DL_PRIXUNITAIRE,DL_QTE,EU_Enumere,EU_QTE,DL_VALORISE,DO_DATE,DO_DATELIVR,DO_DOMAINE,DO_PIECE,DO_TYPE,AG_No1,AG_No2,AR_RefCompose,RP_Code,do_ref,DL_PoidsNet,DL_PoidsBrut,DL_CodeTaxe1,DL_Taxe1,DL_TypeTaux1,DL_TypeTaxe1, DL_CodeTaxe2,DL_Taxe2,DL_TypeTaux2,DL_TypeTaxe2, DL_PUTTC,DL_PieceBC, DL_PieceBL, DL_QteBL, DL_QteDE, DL_QtePL, DL_DateBC, DL_DateDE, DL_DatePL, DL_TNomencl, DL_TRemPied, DL_TRemExep, DL_Remise01REM_Type, DL_Remise01REM_Valeur, DL_Remise02REM_Type, DL_Remise02REM_Valeur, DL_Remise03REM_Type, DL_Remise03REM_Valeur, DL_PUBC, DL_PrixRU, DL_MvtStock, DL_TTC, DL_NoRef, DL_PUDevise, DL_TypePL, DL_Frais, DL_NonLivre, DL_FactPoids, DL_Escompte, DL_PiecePL, DL_NoColis, DL_NoLink, CO_No, DT_No, DL_QteRessource, DL_PieceOFProd, DL_PieceDE, DL_Operation, DL_NoSousTotal, CA_No, DO_DocType, DL_MontantHT, DL_MontantTTC) values ('', '','','VINTY_LIGHT','01LMROUENTOURVILL',7, 'GUIRLANDE EXT 6M VINTY LIGHT LUMISK',1,36.900000,4.00,'Carton de 4',1,1, {d '2020-05-27'}, {d '2020-06-09'},0,'BC202718',1,0,0,'', NULL,'86923464',12800000.00,12800000.00,'V20', 20.000000,0,0, 'ECO17',0.170000,2,2,44.34273, 'BC202718', '', 0.000000, 4.00, 4.00, {d '2020-05-27'}, {d '2020-05-27'}, {d '1753-01-01'}, 0, 0, 0, 0.000000, 0, 0.000000, 0.000000, 0.000000, 0, 0, 1, 0.000000, 0, 0.000000, 0, 0, 0, '', '', 0, '', '', '', 0, 0, 0, 0, '', '', 0, 0, 1, 147.6, 177.37092)
27/05/2020 10:32:35 | insertCommandeLine() : Ligne enregistré!!! 

27/05/2020 10:32:35 | insertOrder() : Le Code TVA (V20) et la valuer du TVA (20.000000)
27/05/2020 10:32:35 | insertOrder() : Additionner le total HT (36.900000) et TTC (44.34273)

27/05/2020 10:32:35 | insertOrder() : get current stock in F_ARTSTOCK table in the database
27/05/2020 10:32:35 | insertOrder() : requette sql ===> SELECT AS_QteSto, AS_QteRes, AS_MontSto, AS_QteCom FROM BATIMEX.dbo.F_ARTSTOCK WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1
27/05/2020 10:32:35 | insertOrder() : Stock trouvé : AS_StockReel (0,000000), AS_StockReserve (572,000000), AS_StockMontant (0,000000).

27/05/2020 10:32:35 | insertOrder() : new_AS_StockReel: 0
27/05/2020 10:32:35 | insertOrder() : new_AS_StockReserve: 576 = AS_StockReserve: 572 + Quantite: 4
27/05/2020 10:32:35 | insertOrder() : new_AS_StockMontant: 0 = new_AS_StockReel: 0 * productPrixUnite: 36,9
27/05/2020 10:32:35 | insertOrder() : new_AS_CMUP: NaN = new_AS_StockMontant: 0 / new_AS_StockReel: 0

27/05/2020 10:32:35 | insertOrder() : update article VINTY LIGHT GUIRLANDE VINTAGE AVEC AMPOULES (Ref:VINTY_LIGHT) stock in F_ARTSTOCK table in the database
27/05/2020 10:32:35 | insertOrder() : requette sql ===> UPDATE BATIMEX.dbo.F_ARTSTOCK SET AS_QteSto = 0, AS_QteRes = 576, AS_MontSto = 0 WHERE AR_Ref = 'VINTY_LIGHT' and DE_No = 1

27/05/2020 10:32:35 | insertOrder() : Ajouter : le code TVA, la valeur du tva, le montant HT et TTC dans le document 86923464
27/05/2020 10:32:35 | insertOrder() : SQL ===> UPDATE BATIMEX.dbo.F_DOCENTETE SET DO_CodeTaxe1 = 'V20', DO_Taxe1 = 20.000000, DO_TotalHT = 36.9 WHERE DO_PIECE = 'BC202718' 


27/05/2020 10:32:36 : 1/1 ligne(s) enregistrée(s).


27/05/2020 10:32:36 : Le fichier 'E:\EDI\EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv' est déplacé dans ===> C:\Connecteur_BDC\Connecteur Sage Batimex\Success File\27052020103236__86923464__EDI_ORDERS.86923464.773994.BATIMEX.3025940006400.20200527.202005270125.RECU.IN.csv



